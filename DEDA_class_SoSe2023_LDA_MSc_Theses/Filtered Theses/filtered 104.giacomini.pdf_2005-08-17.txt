risk management copula master thesis submit prof dr wolfgang ardle institute statistic econometrics case center apply statistic economics universit zu enzo giacomini partial fulfillment requirement degree master science statistic august declaration authorship hereby confirm author master thesis independently without use others indicate source passage literally general matter take publication source marked th august enzo giacomini content introduction copula definition property gaussian copula student copula archimedean copula example gumbel copula multivariate archimedean copula distribution construct copula monte carlo simulation copula estimation maximum likelihood estimation ifm inference margin cml canonical maximum likelihood gaussian copula estimation student copula estimation value risk copula value risk var estimation copula content time vary copula backtesting empirical result dimensional exchange rate portfolio dimensional exchange rate portfolio conclusion list fr echet hoeffding upper bound left product cop ula middle fr echet right density gaussian copula cga density copula ct pdf contour plot clock wise gaussian clayton frank gumbel copula monte carlo sample realization pseudo random anddependencestruc ture give clayton copula monte carlo sample realization pseudo random ture give clayton copula realization ofpseudo random variable uniform marginal distribution dependence structure give copula scatterplot residual kernel density estimator residual red mal density black dem usd left gbp usd right quartic kernel residual fit copula gaussian clay ton gumbel list dependenceparameter gaussian black clayton red gumbel blue copula move window vdar yellow black exceedance red sample generate clayton copula vdar green black exceedance red sample generate gumbel copula vdar black estimate gum bel copula green clayton copula blue gaussian copula red scatterplots garch residulas upper triangular residual mapped unit square cdf low trian gular vdar black estimate clayton copula yellow green red blue list garch parameter dimensional portfolio parameter marginal distribution dependence parameter different static copula vdar different portfolio value static copu lae portfolio estimate gaussian first clay ton second gumbel copula third row clayton copula exceedance ratio different port folio gumbel copula exceedance ratio different port folio gaussian copula exceedance ratio different port folio garch parameter dimensional portfolio parameter marginal distribution clayton copula exceedance ratio different portfolio introduction capital requirement financial institution determine base amount risk carry portfolio risk associate portfolio may originate fluctuation value financial asset compose portfolio market risk fluctuation credibility debtor credit risk uncertainty connect technical personal natural factor may influence portfolio value operational risk order investigate risk portfolio asset subject risk risk factor identify change portfolio value cause risk factor evaluate specially relevant risk management purpose negative change portfolio loss value risk var measure quantifies riskness port folio measure accuracy crucial importance deter mining capital requirement financial institution one reason increase attention paid var compute method loss probability associate distribution loss necessary describe degree portfolio riskness riskier theportfolio amount formulate another way riskier portfolio large alsocalledlevel thatisexactly var definition var quantile distribution portfolio loss represent minimal loss certain level look carefully distribution loss one verifies large loss influence simultaneous loss risk factor hence distribution loss depends joint distribution risk factor introduction understand joint distribution risk factor fundamental inves tigating compute value risk conventional procedure model joint distribution financial return approximate multivariate normal distribution implies however dependence structure return duced fix type even autocorrelation structure neglect predeterminig multivariate normal distribution mean follow assumption hold symmetric distribution return tail distribution heavy linear dependence empirical evidence assumption barely verify alterna tive model need flexible dependence structure arbitrary marginal distribution exactly charactesitics copula copula useful model estimate multivariate distribu tions flexibilty copula follow basically sklar theorem tell joint distribution decompose marginal dis tributions copula responsible dependence structure two important fact practical application rely theorem construction multivariate distribution may do two inde pendent step specification marginal distribution neces sarily identical specification dependence structure cop ulae couple together marginal distribution multivariate distribution desire dependence structure joint distribution separately estimate sample obser vations marginal distribution estimate first dependence structure later copula approach free model usual normality assump tions marginal distribution asymmetric heavy tail typical finan cial return combine together different dependence structure introduction result multivariate distribution far different multivariate normal well describe empirical characteristic financial return distribution moreover copula allow dynamical model adaption portfo lios different copula distinct property associate different portfolio accord specific dependence structure furthermore copula may change time evolves reflect evolution depen dence financial asset summarize value risk estimation copula efficient flexible method base normality assumption copula section present basic copula definition theorem important copula together standard construction simula tion method also discuss proof deeper mathematical treatment refer joe nelsen definition property definition copula dimensional copula function satisfy follow ing property every every give ii dc di uniform distribution first third property state copula ground function dimensional box vertex non negative volume together guarantee copula distribution copula function marginal disributions note consider random variable univariate distribution functionsf duni xi formdistributedin joint distribution marginal distribution every copula satisfies min max call fr echet hoeffding upper bound fr echet hoeffding low bound copula copula besides fr echet hoeffding bound product copula also fundamental importance product copula give ilustrates fr echet hoeffding bound product copula every distribution function decompose marginal dis tribution least one copula unique copula obtain couple together every continu ous multivariate distribution function marginal distribution theorem sklar theorem letf bead tion marginals exists copula copula fig fr echet hoeffding upper bound left product copula middle fr echet hoeffding low bound right sfefrechet xpl every continuous unique hand copula distribution function function define joint distribution function marginals hence joint distribution continuous marginals unique copula obtain definition copula random variable let random vector distribution continuous marginals copula distribution function xj xj copula independent random variable copula product copula define xj note product copula marginal distribution determines dependence structure univariate variable abitrary marginals next theorem show copula invariant monotone increas ing transformation subsequent section theorem invariance monotone increase transformation let random vector continuous marginals copulac andt ranx lety almost everywhere dimensional random variable determines copula joint marginal distribution moreover monotone increase transformation random variable affect copula main idea use obtain gaussian copula random variable multivariate normal distribution copula monotone increasingly tranformed standardise variable copula random variable absolute continuous copula exists copula densitiy copula den sities essential estimation procedure see chapter definition copula density absolutely continuous copula copula density define dc copula give random variable absolute continuous dis tributionfunctionf andcopulac thedensityc qd xj joint density density density xj copula determine joint density inverse marginal distribution gaussian copula gaussian copula represent dependence structure multivari thatmeans normal gaussian copula form multivariate normal distribution thecombinationofnon normal gaussian distribution example plot upper left part obtain gaussian copula let sklar theorem jj exists copula distribution function distribution function xi let transformation correlation matrix associate moreover exists copula cga call gaussian copula cga copula distribution function distribution function explicit expression gaussian copula obtain rewrite cga dr dr increase follow theorem cga thus multivariate normal distribution construct mar ginal distribution gaussian copula cga desire correlation matrix remark gaussian copula becomes product copula iga pd dr dr dr dr density gaussian copula obtain differentiate exp cga exp rearrange term define cga exp copula fig density gaussian copula cga sfegausscop xpl student copula copula contain dependence structure form multivariate distribution may obtain similar way let correlation matrix associate unique copula isthestudent copula ct moreover ct student copula give ct quantile function univariate distribution distribution function density copula give ct qd copula fig density copula ct sfetcop xpl density copula express ct dqd archimedean copula definition let continuous strictly decrease function pseudo inverse function theorem let convex strictly decrease con tinuous function function copula copula copula form call archimedean copula function generator addition call strict generator example gumbel copula function lnt convex strictly decrease continuous thus strict generator function lnu lnu gumbel copula obtain product copula obtain fr echet hoeffding upper bound min multivariate archimedean copula next theorem generalizes concept archimedean copula dimensional case detailed treatment proof found nelsen definition function completely monotonic interval satisfies dk dtk theorem let strict generator function cd cd copula completely monotonic dimensional archimedean copula present generator copula family respective property see joe copula frank copula uj ln gumbel copula exp lnu ali mikhail haq copula clayton copula density clayton copula give distribution construct copula joint distribution different dependence marginal distrib utions easily construct copula example standard copula normal marginal distribution couple distinct copula build joint distribtuion give density function density function standard normal distribution distribution degree freedom contour plot show respective copula choice monte carlo simulation simulation pseudo random variable joint distribution de fin copula marginal distribution may follow different technique standard method archimedean copula conditional distribution method shortly described sequence detail different method see bouy devroye embrechts definingthecopulaen forn derivative respect first argument cn probability write lim un cn thus conditional probability function ratio deriva copula yy yy fig pdf contour plot clockwise gaussian clayton frank gumbel copula sfeplotcop xpl copula fig montecarlosampleof uniform marginals dependence structure give clayton copula sfeclaytonmc xpl tives cn cn generation pseudo random number give marginal distrib utions dependence structure give copula follow step generate pseudorandom numbersv independent uniformly distribute generate pseudo random number pseudo random number uniform marginal distri butions dependence structure give copula set pseudo random number distrib uted desire marginal distribution dependence structure gaussian copula simulation follow copula generate pseudo random number distribute set pseudo random number uniform marginal distribution depen dence structure give cga set pseudo random number distrib uted desire marginal distribution dependence structure marginal distribution normal pseudo random number multivariate normal distribute otherwise distribution call meta gaussian distribution copula simulation follow generate pseudo random number distribute set univariate distribu tion degree freedom pseudo random number uniform marginal distribution depen dence structure give ct set pseudo random number distrib uted desire marginal distribution dependence structure marginal distribution pseudo random number multi variate distribute otherwise distribution call meta distribu tion repeat one procedure time yield monte carlo sample random variable distribute desire copula yy fig montecarlosampleof standard normal marginals dependence structure give clayton copula sfeclaytonmc xpl yy yy fig realization ofpseudorandom variable uniform marginal dis tributions dependence structure give copula sfetmc xpl copula estimation let dimensional random variable parametric univariate mar ginal distribution let copula belong xj parametric family sklar theorem distribution express density dc sample observation vector parameter rk likelihood function give log likelihood function xx lnc lnf vector parameter contains parameter marginals copula parameter parameter estimate one step practical application however two step esti mation procedure efficient copula estimation maximum likelihood estimation maximum likelihood estimation method also call full maximum likelihood vector parameter estimate one single step argmax fml estimate solve fml ifm inference margin ifm inference margin method parameter marginal distribution estimate first step use estimate dependece parameter second step log likelihood function marginal distribution lnf estimate parameter argmax pseudo log likelihood function lnc maximize get dependence parameter estimate estimate solve ifm copula estimation cml canonical maximum likelihood inthecml canonical maximum likelihood method distribution estimate empirical distribution function pseudo log likelihood function lnc copula parameter estimator give cml argmax cml notice first step imf cml method estimate mar ginal distribution marginals estimate pseudo sample observation transform unit cube obtain use copula estimation gaussian copula estimation pseudo sample density gaussian copula give cga exp pseudo log likelihood function ln maximum likelihood estimator copula estimation argmax set low triangular matrix one diago nal maximization feasible slow high dimension see embrechts approximate solution obtain use ml estimator covariance matrix argmax estimator define diag ii obtain student copula estimation one possible estimation method student copula base estimation kendall tau method moment embrechts pseudo sample kendall tau coefficient pair observation give sign element correlation matrix estimate sin parameter estimate maximum likelihood esti mat matrix held fix case pseudo log likelihood function give ln ct copula estimation ct define equation estimator number degree freedom argmax value risk copula section introduces main assumption step necessary esti staticandtime vary described sequence value risk let rd portfolio position asset non negative random vector represent price asset time index value portfolio give random variable also call profit loss function express change port folio value period define log return period lns lns consider equation write exj distribution function drop time index give value risk copula value risk level portfolio define quantile var follow equation depends dimensional distribution log return general loss distribution depends random process represent risk factor influence portfolio present case log return suitable risk factor choice thus model distribution essential obtain quantiles log return process model standardise innovation available information time conditional mean give conditional variance give innovation joint distribution continuous marginal distribution var estimation copula innovation distribution function described copula belonging parametric family obtain value risk set dependence parameter dis tribution function residual estimate sample log return use generate monte carlo sample quantiles differ ent level estimator value risk whole procedure summarize portfolio asset sample log return thevalue riskatlevel step value risk copula estimation residual specification estimation marginal distribution specification parametric copula family estimation depen dence parameter generation monte carlo sample innovation loss estimation var empirical quantile time vary copula backtesting application static procedure described different subset sample delivers sequence fit dependence parameter copula family hence denomination time vary copula use subset size scroll sample move window size procedure generates time series var value risk dependence parameter estimate backtesting estimate value var compare true realization function exceedance occur small var ratio number exceedance number observation give exceedance ratio var empirical result estimation method described preceeding section use two exchange rate portfolio first compose position second position different copula use static dynamic set var performance compare base backtesting dimensional exchange rate portfolio section value risk portfolio exchange rate dem usd gbp usd compute use different copula assume log return follow garch process fit garch model sample log return give estimate empirical residual scatterplot epirical residual depict tab garch parameter dimensional portfolio empirical result tab parameter marginal distribution copula gaussian clayton gumbel tab dependence parameter different static copula marginal distribution specify normal parameter estimate data static copula dependence parameter estimate different copula family gaussian clayton gumbel variuos portfolio use generate sample estimate value risk time vary copula dynamic approach empirical residual sample move window fix size time series estimate dependence parameter copula family portfolio composition static case use generate sample series estimate value risk function select portfolio plot backtesting result copula portfolio quantiles level ofr empirical result dsu pbg slaudiser residual dem usd fig scatterplot residual sferesgarch xpl fig kernel density estimator residual red normal density black dem usd left gbp usd right quartic kernel sferesdens xpl empirical result portfolio tab var different portfolio value static copula portfolio estimate gaussian first clayton second gumbel copula third row empirical result fig residual fit copula gaussian clayton gumbel sfestaticcop xpl portfolio avg std dev tab clayton copula exceedance ratio different portfolio empirical result yyy fig dependence parameter estimate use ifm method gaussian black clayton red gumbel blue copula move window sfedyncop xpl empirical result var clayton copula pl time fig var yellow black exceedance red sample generate clayton copula sfeclaytonsim ptv xpl var gumbel copula time fig var green black exceedance red sample generate gumbel copula sfegumbelsim ptv xpl empirical result var gumbel clayton gaussian time fig var black estimate gumbel copula green clayton copula blue gaussian copula red sfeclaygumbgauss xpl portfolio avg std dev tab gumbel copula exceedance ratio different portfolio empirical result portfolio avg std dev tab gaussian copula exceedance ratio different portfolio dimensional exchange rate portfolio section value risk exchange rate portfolio compose position usd value gbp frf chf dem aud compute use time vary clayton copula fit garch model sample log return give estimate empirical residual upper right part marginal distribution specify normal estimate parameter estimate value risk level together function plot backtesting result portfolio empirical result tab garch parameter dimensional portfolio tab parameter marginal distribution portfolio avg std dev tab clayton copula exceedance ratio different portfolio empirical result yyyy yyyy yyyy yyyy yyyy fig scatterplots garch residulas upper triangular residu al mapped unit square cdf low triangular sfe dim xpl empirical result var clayton copula time fig var black estimate clayton copula yellow green red blue sfe dim xpl conclusion three different copula gumbel clayton gaussian use estimate value risk dimensional portfolio dem usd gbp usd time series estimate dependence parameter verify dependence structure represent similar form copula family use backtest result compare performance var estimation remark average clayton gaussian copula overestimate var term capital requirement financial institution compute var copula would request keep capital aside necessary guarantee desire confidence level estimation gumbel copula another side produce result close desire level gumbel copula seem represent specific data depen dence structure like low tail dependency relevant explain simultane ous loss well gaussian clayton copula well know gaussian copula present tail dependency hence choice best copula var estimation base backtesting empirical result performance depends dependence structure data set use investigate case case theory copula model selection test developed chen static set may first step develop dynamic model selection test test window best copula value risk estimate choosen copula family chen fan estimation model selection semipara metric copula base multivariate dynamic model copula misspec ification work paper chen fan estimation copula base semiparamet ric time series model work paper chen fan tsyrennikov efficient estimation semi parametric multivariate copula model work paper devroye non uniform random variate generation springer verlag new york bouy durrleman nikeghbali riboulet roncalli copula finance reading guide application groupe de recherche op erationnelle cr edit lyonnais durrleman nikeghbali roncalli copula right one groupe de recherche op erationnelle cr edit lyonnais embrechts frey mcneil quantitative risk manage ment concept technique tool princeton press prince ton embrechts mcneil straumann correlation dependence risk management property pitfall correlation risk management value risk beyond cambridge press cam bridge franke ardle hafner statistic financial mar kets springer verlag heidelberg giacomini ardle nonparametric risk management adaptive copula discussion paper sfb ardle herwartz spokoiny time inhomogeneous multiple volatility model journal financial econometrics ardle kleinow stahl apply quantitative fi nance springer verlag heidelberg joe multivariate model dependence concept chapman hall london nelsen introduction copula springer verlag new york
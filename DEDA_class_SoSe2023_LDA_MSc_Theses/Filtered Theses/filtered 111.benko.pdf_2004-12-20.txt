functional principal component analysis implementation application abschlussarbeit zur erlangung de akademischen grade master science sc im masterstudiengang statistik der fakult universit zu von mgr michal benko sc stat geboren bansk bystrica gutachter prof dr wolfgang ardle prof dr bernd onz eingereicht december functional principal component analysis implementation application master thesis present michal benko prof dr wolfgang ardle case center apply statistic economics partial fulfillment requirement degree master science december declaration authorship hereby confirm author master thesis independently without use others indicate resource passage literally gen eral matter take publication resource marked michal benko december acknowledgment would like thank professor dr wolfgang ardle professor dr bernd onz give opportunity motivation write thesis grateful jan also indebted family without support would impossible finish work master thesis discus select topic functional data analysis fda fda deal random variable process realization smooth func tional space first part thesis introduces basic assumption notation idea fda mainly focus functional basis approach second chapter deal one popular fda technique functional principal component analysis fpca fpca functional analogue well know dimension reduction technique multivariate statistical analysis search pairwise orthogonal linear transformation random vector maximal variance second part thesis discus sample problem framework thefpca multivariate statistical analysis xplore focus statistical macro quantlets graphical plot tool functional data analysis keywords regularization statistical software content introduction functional basis expansion fourier basis polynomial basis spline basis data set basis approximation coefficient estimation xplore fda implementation temperature example functional principal component implementation discretization basis expansion data set basis smooth principal component analysis implementation use basis expansion xplore implementation temperature example choice smooth parameter content common principle component multivariate common principal component model fg algorithm functional common principal component model xplore implementation summary outlook xplore quantlet list basic statistic functional principal component graphical tool plot tool summary outlook bibliography list station list mean variance function temperature covariance function temperature plot surface linear interpolation grid step correlation function temperature plot surface linear interpolation grid step weight function temperature data set principal score temperature data set weight function temperature data set use weight function temperature data set use weight function first simulated sample weight function second simulated sample weight function common estimate simulated sample notation set real number rt dimensional real vector space set natural number dual space vector space differential operator newton leibnitz operator correspond functional space linear differential operator linear combination dp ker kernel space operator scalar product define hilbert vector space norm define banach vector space left close right open interval similarly close open interval space interval lebesque square integrable function interval factorize respect lebesque measure probability space define set algebra probability measure span span space set possible linear combination element set may set vector function cond identificator function logical variable cond cond otherwise tr trace square matrix det determinant square matrix diag diagonal square matrix inverse nonsingular matrix exp exponential function introduction traditional multivariate framework random object model dimensional random vector formally random vector measurable function rt bt map probability space rt bt wherebt aretheborelsetsonrt observe realization analyze random vector use data set def functional data framework object usually model realization stochastic process bound interval thus set function def represent data set formally random function functional borel field functional hilbert space mainly work functional hilbert space standard scalar product define hf gid dt thecorrespondingl hf fi moreover assume existence mean variance covariance function denote ex var cov corr respectively introduction def ex ex var ex def cov ex ex cov corr var var note corr define assumption var var var cov corr straightforward way vdar cdov orr cdovx vdarx vdarx dauxois pousse romain show cov cdov probability one thesis organize follow chapter introduces popular imple mentation functional principal component functional basis expansion followingchapter ical tool fda statistical software environment xplore chapter present basic theory functional principal component smooth functional principal component implementation xplore practical application temperature data set chapter discus common estimation functional principal component last chapter one find complete list xplore quantlets functional basis expansion function aswewillsee concept often introduce functional data analysis easily however practice interested implementation technique fast computer algorithm whereacertainfinite need apopularwayoffda precisely let denote functional basis interval assume function approximate first basis function il first equal sign il formally adequate practice approximate however order keep notation simple neglect difference real approximation practice analysis functional object implement coefficient matrix il themean variance vdar cov cdov cov cdov orr vdar vdar functional basis expansion cov il scalar product two function corresponds hx dt wc wd dt three prominent example functional base fourier polynomial spline basis fourier basis isthefourierbasis define sin co wherethefrequency fourier basis define easily transform orthonormal basis hencethescalar productmatrixin thepopularity basis base partially possibility fast coefficient calculation fast fourier transformation fft algorithm xplore environment one use quantlet fourierevalgd general case quantlet fft performs fft algorithm equidistant design polynomial basis polynomial basis appropriate non periodic function define shift parameter polynomial monomial function easy calculate example simple recursion however high order polynomial become fluctuate especially boundary xplore one use quantlet polyevalgd functional basis expansion spline basis basis fornon periodic data spline basis basis define sequence knot interval roughly speak basis piecewise polynomial function order smoothly connect knot formally basis function whereb isl thb splineoforderk forthenon define follow recursion scheme otherwise number basis function uniquely define spline order number knot advantage spline basis flexibility relatively easy evaluation basis function derivative xplore one use quantlet bsplineevalgd detailed discussion implementation spline basis expansion xplore found ulbricht data set basis let briefly discus interest special case use function basis directlyimplies thatthe identity matrix information data set store matrix despite pathological first sight image approximation coefficient estimation practice observe function value def iti functional basis expansion discrete grid number design iti point th observation case may approximate function function sumofsquares basis need approximate integral dt numerical integration technique slightly different setup occurs assume data set contaminate additive noise standard statistical approach assume data set def consist realization random variable zero mean variance function face regression problem estimate coefficient matrix obtain minimize appropriate loss function method regularization roughness penalty apply define roughness penalty norm operator hilbert space rd klk minimize xti kl parameter control degree penalization clearly yield least square regression popular example roughness penalty penalize nonlinearity estimate function general appoach assumes linear differential operator dp proper choice operator background additional information underlie function assume example try find operator ker penalize coefficient yield function clearly write hence implementation need able calculate function note standard fda setup one assumes function observe againinorder keep notation simple neglect difference estimate real coefficient assume additional noise small order compare variation function however statistical point view keep difference mind one important question practitioner many function use basis expansion although state ramsay silverman even functional basis expansion statistical point view automate data driven selection need simplest case fourier basis without use additional regularization need set do easily use cross validation generalize cross validation similar criterion described ardle among others much complicate case spline practice need choose knot sequence addition number function special application choice knot point naturally give underlie problem one practical rule thumb good start point set least knot neighborhood interest pointofthefunction pointoranother change function alternative approach may apply case additional information function interest transform roughness penalty klk algorithm follow use nest model data set use number observation use basis directly would lead highly volatile estimator small zero bias transform additional information function kernel appropriate linear differential operator smooth coefficientsvector cubic spline basis first step corresponds set knot design point set fact penalize nonlinear function obtain special case popular nonparametric technique smooth spline validation cv generalize cross validation gcv detail see hastie method fully data driven give operator xplore fda implementation thefda xplore implementation joint work jan ulbricht clearly separate task byulbricht understand text case quantlets createfdbasis data fd evalfd programmed mr ulbricht aim part implement basic statistical descriptive graphical tool fda extend exist system quantlets xplore implement xplore general functional basis list object basisfd follow element fbname string name functional basis support fourier polynomial bspline mention range vector two element range interval param determine functional basis fbname optional parameter scalar product matrix penmat optional parameter penalty matrix functional object fd similarly list contain basisfd object type functional basis coef array coefficient two object create follow two quantlets xplore fda implementation fdbasis createfdbasis fbname range param ontheinterval range range use parameter param fd data fd argvals basisfd lfd lambda convert array function value penalize regression lfd lambda observe array argvals argument value functional data object order obtain estimator mean function use fdamean fdamean fdobject creates functional object mean function functional object fdobject output quantlet fdamean functional object functional object plot use evalmat evalfd evalarg fd lfd evaluates functional data object fd operate linear differential operator lfd argument value array evalarg gfd grfd fd evalarg lfd col art thick creates graphical object functional object fd operate lfd thelinemaskcol art thickfollow xplore standard setmaskl plotfd fd evalarg lfd col art thick plot functional object fd operate lfd use plot grid evalarg line mask col art thick follow xplore standard setmaskl xplore fda implementation variance covariance correlation function face different sit uation use functional basis expansion need evaluate quadratic bilinear form directly support exist xplore functional data object follow variance function one dimensional fdvar evalfdavar evalarg fdobject evaluates variance function functional data object fd argu ment value array evalarg gdfvar grfdavar fd evalarg col art thick creates graphical object variance function functional object fd line mask col art thick follow xplore standard setmaskl plotfdavar fd evalarg col art thick thelinemaskcol art thick follow xplore standard setmaskl covariance correlation function two dimensional function surface fdcov evalfdacov evalarg fdobject evaluates cov function fdobject vector evalarg evalarg fdcov evalfdacorr evalarg fdobject evaluates corr function fdobject vector evalarg evalarg xplore fda implementation grfdacov fdobject evalarg col creates graphical object cov surface use plot grid evalarg evalarg color col grfdacorr fdobject evalarg col evalarg color col plotfdacov fdobject evalarg col plot plot cov surface fdobject use plot grid evalarg evalarg color col plot plot use plotfdacorr fdobject evalarg col plot plot corr surface fdobject use plot grid evalarg evalarg color col plot plot use input parameter fd fdobject list xplore functional object evalarg vector grid evaluation lfd list linear differential operator ldo scalar vector inthecaseofanldo constant coefficient lfd must matrix first column contains coefficient second order derivative apply ldo variable coefficient lfd must ldo object col vector integer color parameter setmaskl default art vector integer art type parameter setmaskl default thick vector integer thickness type parameter setmaskl default plot string string plot quantlet use function cov corr evaluate point evalarg usage quantlets illustrate simple example next section xplore fda implementation temperature example list arvida bagottvi calgary charlott churchil dawson edmonton frederic halifax inuvik iqaluit kamloops london montreal ottawa princeal princege princeru quebec regina resolute scheffer sherbroo stjohns sydney thepas thunderb toronto uraniumc vancouvr victoria whitehor winnipeg yarmouth yellowkn name canadian weather station found online database md base choose example guinea pig data set illustrates define concept use implement quantlets give possibility comparison due cyclical behavior temperature year usual comparable study assume temperature function periodic thus may employ fourier basis function show estimate temperature function use fourier function xplore fda implementation temperature function example functional data temperature measure canadian weather station list fdamsctempf xpl xplore fda implementation temperature data set obtain follow function correspond basic static multivariate framework mean function variance function mean variance function temperature fdamscmeanvar xpl bump summer surprising temperature high summer winter another fact may however expect winter observe high variance summer fact possibly explain high impact geographical difference winter temperature summer temperature look correlation function plot see autumn temperature seem high correlate spring temperature winter summer temperature xplore fda implementation covariance surface covariancefunction temperature polation grid step fdamsccov xpl xplore fda implementation corr surface correlation function temperature plot surface linear terpolation grid step fdamsccorr xpl functional principal component principal component analysis pca yield dimension reduction multivariate framework idea find normalize weight vector rt linear transformation dimensional random vector ex exi maximal variance subject problem solve mean jordan spectral decomposition covariance matrix ardle simar fpca achieve via route find orthonormal weight function variance linear transformation maximal weight function satisfy dt dt linear combination exi ex dt desire weight function solve argmax varh xi mi equivalently argmax cov dsdt mi functional principal component solution obtain solve fredholm functional eigenequation cov dt eigenfunctions sort respect correspond eigenvalue solve fpca problem follow link eigenvalue eigenfunctions hold var var ex dt cov dsdt sample problem unknown covariance function cov need place sample covariance function cdov dauxois pousse romain show eigenfunctions eigenvalue consistent estimator derive asymptotic result estimator implementation section present three possibility implementation functional pca start simple discretization technique second step focus implementation basis expansion include application temperature data set discretization pca dense grid obtain eigenvectors bj estimate coefficient eigenvectors implementa tion simple since routine multivariate pca matrix spectral analysis need however next section present implementation method corresponds functional nature underlie problem secondly estimate eigenfunctions necessarily orthonormal func tionalsense vector scalar product discretized function number discretization pointst coefficient respect matrix use gramm schmidt procedure functional principal component basis expansion suppose weight function expansion use notation rewrite left hand side eigenequation cov dt cov bdt cov wb cov wb functional scalar product corresponds wb truncate basis framework sense two function orthogonal corre sponding coefficient vector satisfy wb matrix symmetric definition thus definingu problem cov compute inverse transformation orthonormal func tional basis also fourier basis problem fpca reduce multivariate pca perform matrix algorithm calculate use cholesky decomposition calculate cov calculate notice estimate coefficient eigenfunctions orthonormal respect scalar product wb however due numerical error small deviance functional principal component temperature example temperature example obtain weight function eigenfunctions dis played use setup previous section fourier function follow variance proportion eigenvalue pc weight function alpha weight function temperature data set fdamsctemppca xpl functional principal component first eigenfunction black curve explain weight level tem perature year high weight winter temperature eigen functionexplains ofvariation bluecurve hasdifferent sign winter summer explains variation third eigenfunction green curve change sign similar way autumn spring explains variation fourth function cyan curve could explain change season explains variation however eigenfunctions rough non smooth roughness cause sample variance observation noise flexibility use functional basis inthesection get stable well interpretable result another possibility interpret result plot estimate principal score sample analogue bim bm mw estimate principal score plot abbreviation name list use compare arv bag cal cha chu daw edm fre hal inu iqa kam lon mon ott pri prig pru que reg re sch stj syd thu tor ura van vict whit win yar yel abbreviation name canadian weather station simple observation re kind outlier high load second component re stand resolute use similar argument ramsay silverman resolute know cold winter relative pc weather station small difference summer winter temperature pc corresponds interpretation first two eigen function functional principal component pc score temperature re pru iqa stj vict van yar syd chu sch prigchahal cal inu whit etdhmu shefre ltoonr kam que bag arv omtton yel ura thepri reg daw win principal score temperature data set fdamsctemppca xpl data set basis announce previous section use data set basis need estimate matrix rather coefficient matrix show use concept functional principal component analysis estimation procedure base karhunen lo evy decomposition use eigen functional principal component function factor function model follow type npn recall sample mean number nonzero eigenvalue empirical covariance operator hx letsusdenotethe eigenvalue eigenvectors cn cn cn cn principal score ic rn rcn basedonthe knownfact tions empirical covariance operator order correspond eigenvalue construct best empirical basis integrate square error sense residual integrate square error kx lbysetting cn estimation procedure follow idea kneip utikal introduce case density function instead estimate eigenfunction cn discretization functional basis expansion focus spectral analysis matrix hx lk procedure motivate follow two fact firstly nonzero eigenvalue empirical covariance operator eigenvalue matrix denote related follow cn secondly eigenvectors denote principal score cn hold jr cn mp jr jr cn xn xn ir rcn ir irx cn ir functional principal component estimation procedure follow two step first estimate ir principal score eigenfunctions ic rn rcn several aspect technique need mention first need mention virtually separate spectral analysis move fea ture space scalar product use appropriate robust estimator may achieve robust estimator eigenfunctions another hand general case thedeeper discussion special case density function found men found benko kneip smooth principal component analysis asweseeinthefigure smooth ing could result stable well interpretable result apply popular approach know roughness penalty downside technique loose orthogonality sense assume underlie eigenfunctions continuous square integrable second derivative recall differential operator define roughness penalty moreover suppose square integrable derivative degree four second third derivative satisfy one follow condition zero end interval periodicity boundary condition rewrite roughness penalty follow way zero condition mention functional principal component give principal component function norm penalize sample variance principal component divide cdov dsdt pcapv dt wherei pcapv isaneigenfunction eigenvalue generalize eigenequation cdov dt inthel sense component function need rescale satisfy weight function type hf gi hd gi extend theoretical discussion found silverman implementation use basis expansion define matrix whose element hd generalize eigenequation transform wcov wu find matrix hold define rewrite swcov algorithm calculate use cholesky decomposition calculate inverse use symmetrical matrix eigenvalue eigenvector routine obtain eigenvalue eigenvectors swcov functional principal component calculate renormalize respect matrix wb look first eigenfunctions best empirical basis wemayalsore withrespect matrix use gramm schmidt procedure chapter present case roughness penalty similarly could consider general case rougness penalty kl xplore implementation follow syntax fpcaresult value varprop score fdaspca fdobject lambda lfd npc norm performs smooth functional pca input parameter fdobject list functional object replication lambda scalar smooth parameter default npc scalar number generalize eigenfunctions default norm string normalization type norm orthonorm fpcaresult coef thonormalized respect basis penalty matrix norm norm coefficient renormalize norm default normalization outputvariable fpcaresult list functional object value npc vector generalize eigenvalue varprop npc vector proportion variance explain eigenfunc tions functional principal component score npc matrix principal component score plot estimate principal score obtain easily output quantlet fdaspca use command setmask library plot library fda read dailtemp dat tvec fdb createfdbasis fourier fdtempf data fd tvec fdb fdapc fdaspca fdtempf tempdisc createdisplay grtempf grfd fdapc fpcaresult grid sc fdapc score label arv bag cal cha chu daw edm fre hal inu iqa kam lon mon ott pri prig pru que reg re sch stj syd thu tor ura van vict whit win yar yel setmaskt sc label setmaskp sc show tempdisc sc setgopt tempdisc title pc score temperature border temperature example perform idea smooth functional pca spca temperature data set obtain setup previous section fourier function weight function plot observe high frequency variance smooth interpretation eigenfunctions obvious illustrate one practical problem complementarity follow example obtain smoother eigenfunctions decrease number fourierfunctionsand fourier series plot clearly two set eigenfunctions order avoid difficulty propose similar procedure section functional principal component pc weight function alpha weight function temperature data set use fdamsdtempspca xpl use set regression without penalization undersmooth even interpolate observe data set set appropriate smooth directly eigenfunctions choice appropriate one use technique described section procedure statistically clean computationally intensive functional principal component pc weight function alpha weight function temperature data set use fdamsctemppca xpl choice smooth parameter validation thisapproach base fact eigenfunctions see optimal empirical basis discuss section order keep notation simple npnx sample mean function use functional basis subtract sample functional principal component first eigenfunctions function define part orthogonal subspace span basis xx xi recall spca eigenfunctions longer orthonormal thus performance measure empirical basis may use calculate value cross validation criterion cv cv isthepartofx estimate data set exclude th observation next step choose opt opt argmincv inpractice giventhedata set contain function able estimate first eigenfunctions may also expect eigenfunctions high order estimate large error algorithm algorithm partially take ramsay silverman center data subtract sample mean give calculate smooth eigenfunctions without use th observation calculate cv truncate minimize cv respect cv dg wbj wc functional principal component thus estimate eigenfunctions denote clearly diag however itisknownfrom practice cross validation lead unstable result another disadvantage method high computational cost common principle component follow chapter discus possibility implementation common principalcomponents cpc inthesection introduce cpc multivariate model multivariate common principal component model common principal component model cpc multivariate set motivate model similarity covariance matrix sample problem random vector rt cpc model write cov diag tor across sample eigenvalue variance principal component score differ use normality assumption sample covariance matrix wishart distribute cpc model estimate use ml estimation likelihood function cy exp tr det nj show flury factor depend parameter andn function equivalent yk det diag nj det common principle component maximization criterion perform call fg algorithm flury gautschi tion thefg complete estimation common pca model perform use quantlet cpc betaerror lambda lambdaerror psi cpc cpc computes common eigenmatrix eigenvalue correspond ing standard error estimate population covariance matrix sample covariance group use maximum likelihood input parameter array covariance vector weight usually number observation group output variable matrix common orthogonal transformation matrix betaerror matrix standard error lambda matrix eigenvalue group lambdaerror standard error eigenvalue group psi array estimate population covariance matrix fg algorithm rotation algorithm algorithm essential next section thus let describe briefly mention fg algorithm focus minimalization let consider general case use also section focus common principle component positive definite symmetric matrix define individual measure non diagonality det diagf detf heuristic measure clear compare diagonal diagonal nondi agonal term matrix also easy see equality occurs already diagonal theorem flury hadamard equation follow positive definite overall measure matrix use analogue yk nj det diag det weight product individual measure non diagonality give orthog onal matrix define gf min min minimum take respect group orthogonal matrix suitable dimension define best reachable simultaneous min diagonalization flury defines measure simultaneous diagonal izability thecpc hypothesiswillyield min matrix arg min min minimum take group orthogonal matrix suitable dimension show detail see flury chapter min hold im ija im dimension il fg algorithm solves equation iteratively consists two separate gorithms algortithm initialization iteration need first approximation general may set set common principle component perform algorithm initialize algorithm proper matrix compute qg qg set td ip compute rotation matrix qg co sin sin co qg qg stop else go denotes matrix norm small constant set jd qg put gf gfj gf gf stop else go algorithm see part algorithm consist sequential rotation analog matrix currently change part proof convergence fg algorithm found flury existence give fact group orthogonal matrix min dimension compact analogy jacobi algorithm obvious fg algorithm implement xplore quantlet cpcfgalg phi cpcfgalg cpcfgalg implement fg algorithm find common thogonal transformation matrix order simultaneously diagonalize several positive definite symmetric matrix common principle component input parameter array positive definite symmetric matrix vector weight usually number observation group output variable matrix common orthogonal transformation matrix phi scalar measure deviation diagonality phi corresponds complete diagonalibility matrix phi increase monotically deviation diagonality functional common principal component model asshowninsection thefpca weight covariance matrix coefficient view minimization property fg algorithm diagonalization procedure optimize criterion employ however thegeneralization sample problem straightforward assume two functional population stochastic process denote hold notation previous chapter denote eigen respectively need perform spectral analysis matrix swcws swcov swcws swcov assume eigenfunctions may use simultaneous diagonalization technique fg algorithm mul tivariate common principal component analysis order obtain common eigen function common principle component xplore implementation procedure implement xplore via quantlet fdacpcak fpcaresult value varprop fdacpcak covc basisfd lambda lfd npc norm performs common smooth functional pca use simulta neous diagnalization input parameter covc array covariance coefficient vector weight usually number observation group basisfd list object type basisfd lambda scalar smooth parameter default npc scalar number generalize eigenfunctions default norm string normalization type norm orthonorm fpcaresult coef thonormalized respect basis penalty matrix norm norm coefficient renormalize norm default normalization output variable fcpcaresult list functional object value matrix npc generalize eigenvalue varprop npc matrix proportionof variance explainedby eigenfunc tions see input output parameter fdacpcak quantlet fdaspca differ instead give functional object input parameter case fdaspca use directly array covc covariance matrix coefficient group basisfd identification functional basis solution yield quantlet universal number group explain common principle component use quantlet distinction quantlet fdaspca comment small simulated example library fda nbasis matrix grid beta normal matrix lambda sqrt beta normal matrix lambda sqrt lambda beta sin pi sqrt lambda beta co pi sqrt normal fdb createfdbasis fourier nbasis tvec grid fd data fd tvec fdb matrix grid beta normal matrix lambda sqrt beta normal matrix lambda sqrt lambda beta sin pi sqrt lambda beta co pi sqrt normal fdb createfdbasis fourier nbasis fd data fd tvec fdb infdwehave observation simulated function sin co fd observation sin co thus two data set eigenfunctions sin co different eigenvalue function approximate common principle component fourier function equidistant grid point choice yield clearly undersmoothed function correct choice would clearly fourier function due fact simulated function simply linear combination sine cosine function simulate observation error denote neglect error theoretical part fpca contaminate data set additional error use order obtain visible difference eigenfunctions group clearly example slightly artificial main aim explain usage quantlet fdacpcak first sample weight function first simulated sample fdamsccpc xpl common principle component fpc fdaspca fd fpc fdaspca fd tempdi createdisplay tempdi createdisplay grpf grfd fpc fpcaresult grid show tempdi grpf grpf grfd fpc fpcaresult grid show tempdi grpf eigenfunctions input functional object directly afterwards plot eigenfunctions separate display plot displayed second sample weight function second simulated sample fdamsccpc xpl common principle component covfd cov fd coef covfd cov fd coef cov stack covfd covfd cpc fdacpcak cov fdb part quantlet create first covariance matrix co efficients group covfd covfd create dimensional array cov contain covfd covfd input fdacpcak quantlet tempdic createdisplay grpfc grfd cpc fcpcakresult grid show tempdic grpfc displayedinthe please note common estimator smoother estimator group cause fact common estimation us observation group summary outlook tion approach firstly use combination functional basis approach fg algorithm assume matrix diagonalize interpretation seem reasonable use number function pre specify basis group similarly use spca use smooth parameter group another important difference multivariate functional pca multivariate case rt num ber eigenvalue less functional framework would correspond hand maximum number estimate eigenvalue sample covariance operator use functional basis approach get discuss previous section full cpc hypothesis may see restrictive reason already discuss number eigenfunctions obtain use functional basis technique functional data analysis less equal dimension use functional basis high order function real application driven sample error explain structure practical point view may assume dimension functional sample formally assume existence alternatively may common principle component common estimation weight function common estimate simulated sample fdamsccpc xpl assume equality first eigenfunctions corresponds partial common principal hypothesis refer flury framework first common eigenfunctions remain eigenfunctions specific group model modify estimation xplore via quantlet cpcp quantlet fdaspcak easily change model another generalization may motivate fact principal component often use factor regression model see fengler ardle villa among others common principal component hypothesis yield factor function different sample reduces dimensionality problemrapidly however equality eigenfunctions rather equality eigenspaces common principle component space span first eigenfunctions lk span chapter show procedure estimation common eigenfunction hypothesis however hypothesis common eigenfunctions need statistically test still open question research po sible approach give asymptotical result eigenvalue eigenfunctions give dauxois pousse romain another interest question two sample analogously sample problem hypothesis equality eingenvalue test hypothesis base fact var var principal component score first second group respectively takeda sugiyama propose permutation test equality variance test procedure hypothesis common eigenvalue xplore quantlet list chapter present list quantlets create new quantlets create mr ulbricht present thesis original quantlets fda xplore write fdapca fouriertrans fouriereval completely rewrite however due backward compati bility keep quantlets xplore system comparison implemen tation refer package matlab create ramsay present quantlets short form without help template basic statistic fdamean proc fdamean fdamean fdobject error name fdobject coef basisfd fdamean input valid fdobject coef mean fdobject coef basisfd fdobject basisfd fdamean list coef basisfd endp evalfdavar proc fdvar evalfdavar evalarg fdobject error name fdobject coef basisfd evalfdavar input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range evalfdavar elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef xplore quantlet list fdvar nan fdvar fdvar evalmat trans evalmat endo fdvar fdvar endp evalfdacov proc fdcov evalfdacov evalarg fdobject error name fdobject coef basisfd evalfdacov input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range evalfdacov elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix ti evalarg ti evalarg ti evalmat ti trans evalmat ti endo fdcov ti ti endp evalfdacorr proc fdcorr evalfdacorr evalarg fdobject error name fdobject coef basisfd evalfdacorr input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range evalfdacorr elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix xplore quantlet list ti evalarg ti evalarg ti evalmat ti trans evalmat ti sqrt evalmat ti trans evalmat ti evalmat ti trans evalmat ti endo fdcorr ti ti endp functional principal component fdaspca proc fpcaresult value varprop score fdaspca fdobject lambda lfd npc orthonorm error exist fdobject fdaspca fdobject fdaspca list exist lambda lambda default lambda endif error lambda fdaspca negative lambda possible exist norm norm endif exist lfd lfd default lfd endif exist npc npc default number pc endif row fdobject coef number basis col fdobject coef number observ centre neccesery cov use fdobject coef trans fdobject coef mean fdobject coef vmat cov fdobject coef covariance matrix coefficient jmat inprod fdobject basisfd fdobject basisfd identiy matrix penalty matrix lambda ordinary fpca jmat jmat jmat cholesky factor lmatch chold jmat di diag xdiag lmatch bi lmatch di eye lmat bi sqrt di lmatinv inv lmat vmat lmat vmat lmat xplore quantlet list vmat vmat vmat eigenanalysis result eigsm vmat eigenvalue problem rest result value trans result vector sort eigval rest sort rest result value rest result vector orthonormal trans rest col rest vector lmatinv result vector value result value rest else regularize smooth fpca kmat inprod fdobject basisfd fdobject basisfd lfd lfd llmat jmat lambda kmat llmat llmat llmat lmat chold llmat cholesky decomposition cholesky factor correct lmatch chold llmat di diag xdiag lmatch bi lmatch di eye lmat bi sqrt di lmatinv inv lmat vmat lmatinv jmat vmat jmat lmatinv vmat vmat vmat symmetrize eigenanalysis result eigsm vmat eigenvalue problem rest result value trans result vector rest sort rest result value rest result vector orthonormal trans rest col rest value result value eigenvalue vector lmatinv result vector endif coef vector npc coefficient eigenfunctions norm orthonorm orthonormalization resp jmat npc coef coef sqrt coef jmat coef coef coef coef jmat coef coef xplore quantlet list endo endo endif norm norm rescale npc coef coef sqrt coef jmat coef endo endif varprop value sum value proportion variance value value npc select eigenvalue varprop varprop npc select proportion score fdobject coef jmat coef pc score fpcaresult list coef fdobject basisfd endp fdacpcak dim covc covariance pxp dim covc number group input parameter check cpc part error dim covc fdacpcak covariance matrix quadratic error sum sum sum ab covc covc fdapcak covariance matrix symmetric error row fdacpcak number matrix compatible number weight error sum fdacpcak weight zero negative input parameter check fda part default error exist basisfd fdacpcak basisfd basisfd list error basisfd nbasis fdacpcak row covc basisfd nbasis number cofs covc number cofs basisfd exist lambda lambda default lambda endif error lambda fdacpcak negative lambda possible exist norm norm endif exist lfd lfd default lfd endif xplore quantlet list exist npc npc default number pc endif row covc number basis function dim covc jmat inprod basisfd basisfd identiy matrix penalty matrix lambda ordinary fpca jmat jmat jmat cholesky factor lmatch chold jmat di diag xdiag lmatch bi lmatch di eye lmat bi sqrt di lmatinv inv lmat create final array cpcfgalg covc lmat covc lmat endo covc covc covc cpcfgalg covc calculate eigenvalue lambda lam reshape xdiag matrix covc matrix sort eigenvectors accord size correspond eigenvalue lam sort lam coef lmatinv else regularize smooth fpca kmat inprod basisfd basisfd lfd lfd llmat jmat lambda kmat llmat llmat llmat lmat chold llmat cholesky decomposition cholesky factor correct lmatch chold llmat di diag xdiag lmatch bi lmatch di eye lmat bi sqrt di lmatinv inv lmat create final array cpcfgalg xplore quantlet list covc lmatinv jmat covc jmat lmatinv endo covc covc covc cpcfgalg cpcfgalg covc calculate eigenvalue lambda lam reshape xdiag matrix covc matrix sort eigenvectors accord size correspond eigenvalue lam sort lam coef lmatinv coefficient eigenvectors endif coef coef npc coefficient eigenfunctions norm orthonorm orthonormalization resp jmat npc coef coef sqrt coef jmat coef coef coef coef jmat coef coef endo endo endif norm norm rescale npc coef coef sqrt coef jmat coef endo endif fcpcakresult list coef basisfd value lam varprop value sum value proportion variance value value npc xplore quantlet list varprop varprop npc select proportion endp graphical tool grfd proc gfd grfd fd evalarg lfd col art thick exist evalarg evalarg grid fd basisfd range fd basisfd range fd basisfd range endif exist col col endif exist art art endif exist thick thick endif exist lfd lfd endif error col evalarg col evalarg col fd coef grfd argument gridt must column equal fd coef equal one error exist fd coef grfd argument fd fd object error col lfd grfd lfd exceed two dimension row dim fd coef dim coef dim fd coef else dim coef endif col lfd rowslfd else rowslfd row lfd endif evalmat evalfd evalarg fd lfd analogue grpcp xplore quantlet list row evalmat col evalmat gfd evalarg evalmat else gfd gfd evalarg evalmat endif endo lt trans grid setmaskp gfd setmaskl gfd lt col art thick endp quantlet grfd creates graphical object function want plot first function simply extract correspond coefficient show follow example read dailtemp dat tvec fdb createfdbasis fourier fdtempf data fd tvec fdb fdtempf coef fdtempf coef tempdi createdisplay grtempf grfd fdtempf show tempdi grtempf grfdavar proc gdfvar grfdavar fd evalarg col art thick exist evalarg evalarg grid fd basisfd range fd basisfd range fd basisfd range endif exist col col endif exist art art endif exist thick thick endif xplore quantlet list error col evalarg col evalarg col fd coef grfdavar argument gridt must column equal fd coef equal one error exist fd coef grfdavar argument fd fd object fdavarf evalfdavar evalarg fd gdfvar evalarg fdavarf setmaskl gdfvar row evalarg col art thick setmaskp gdfvar endp grfdacov proc grfdacov fdobject evalarg col exist col col endif error name fdobject coef basisfd grfdacov input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range grfdacov elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix ti evalarg ti evalarg ti evalmat ti trans evalmat ti endo fdcov ti ti grsurface fdcov col endp grfdacorr proc grfdacorr fdobject evalarg col exist col col endif error name fdobject coef basisfd grfdacorr input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range grfdacorr elemets evalarg xplore quantlet list basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix ti evalarg ti evalarg ti evalmat ti trans evalmat ti sqrt evalmat ti trans evalmat ti evalmat ti trans evalmat ti endo fdcorr ti ti grsurface fdcorr col endp plot tool plotfd proc plotfd fd evalarg lfd col art thick exist evalarg evalarg grid fd basisfd range fd basisfd range fd basisfd range endif exist col col endif exist art art endif exist thick thick endif exist lfd lfd endif xplore quantlet list error col evalarg col evalarg col fd coef plotfd argument gridt must column equal fd coef equal one error exist fd coef plotfd argument fd fd object error col lfd plotfd lfd exceed two dimension row dim fd coef dim coef dim fd coef else dim coef endif col lfd rowslfd else rowslfd row lfd endif plotfddi createdisplay grfdt grfd fd evalarg lfd col art thick show plotfddi grfdt endp plotfdavar proc plotfdavar fd evalarg col art thick exist evalarg evalarg grid fd basisfd range fd basisfd range fd basisfd range endif exist col col endif exist art art endif exist thick thick endif error col evalarg col evalarg col fd coef plotfdavar argument gridt must column equal fd coef equal one error exist fd coef plotfdavar argument fd fd object fdavarf evalfdavar evalarg fd gdfvar evalarg fdavarf setmaskl gdfvar row evalarg col art thick setmaskp gdfvar xplore quantlet list plotfddi createdisplay show plotfddi gdfvar endp plotfdacov proc plotfdacov fdobject evalarg col plot exist col col endif exist plot plot endif error name fdobject coef basisfd plotfdacov input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range plotfdacov elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix ti evalarg ti evalarg ti evalmat ti trans evalmat ti endo fdcov ti ti grsurface fdcov col plot plot else plotdisplay createdisplay show plotdisplay endif endp plotfdacorr proc plotfdacorr fdobject evalarg col plot exist col col endif exist plot xplore quantlet list plot endif error name fdobject coef basisfd plotfdacorr input valid fdobject error min evalarg fdobject basisfd range max evalarg fdobject basisfd range plotfdacorr elemets evalarg basisfd range row evalarg evalmat getbasismatrix evalarg fdobject basisfd cov fdobject coef nresol row evalarg ti grid nresol nresol row ti ti ti nan matrix ti evalarg ti evalarg ti evalmat ti trans evalmat ti sqrt evalmat ti trans evalmat ti evalmat ti trans evalmat ti endo fdcorr ti ti grsurface fdcorr col plot plot else plotdisplay createdisplay show plotdisplay endif endp summary outlook morethanas first step project usage library different user surely yield statistical method fda functional linear model functional anova exist xplore fda environment challenge improvement technical part library planning implement refinement estimation coefficient matrix support dimensional functional object surface bibliography benko andkneip isi forthcomming dauxois pousse romain asymptotic theory principal component analysis vector random function application statistical inference journal multivariate analysis flury common principal component related model wiley new york fengler ardle schmidt common factor govern vdax folio management nm fengler ardle villa dynamic imply volatility common principle component approach review derivative research fengler ardle andmammen case discussion paper http www case hu de hastie tibshirani andfriedman ing springer ardle apply nonparametric regression cambridge press ardle mu ller klinke xplore learn guide springer hafner wallmeier dynamic dax imply volatility international quarterly journal finance nm ardle simar apply multivariate statistical analysis springer verlag heidelberg bibliography ulbricht represent smooth function master arbeit statistic hum boldt universit zu kneip andutikal journal american statistical association ramsay matlab plus function functional data analysis mcgill ftp ego psych mcgill ca pub fdafuns ramsay silverman functional data analysis springer new york rice silverman estimate mean covariance structure nonparametrically data curve journal royal statistical society ser silverman norm annals statistic xplore inner group xplore auto pilot support system md tech takeda sugiyama test functional principal component analysis unpublished manuscript chuo
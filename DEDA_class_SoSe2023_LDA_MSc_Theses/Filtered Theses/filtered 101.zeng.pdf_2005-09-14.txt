application smooth technique imply volatility master thesis present zeng jin prof dr wolfgang ardle case center apply statistic economics partial fulfillment requirement degree master art september declaration authorship hereby confirm author master thesis independently without use others indicate resource passage literally gen eral matter take publication resource marked zeng jin september acknowledgment would like thank professor dr wolfgang ardle give opportunity motivation write thesis especially indebted michal benko excellent guidance time furthermore also grateful parent husband without support would impossible finish work imply volatility important element risk management option pricing black however market show volatility constant change strike time maturity inthispaper technique estimate imply volatility function standard non semi free insert estimation result black scholes model calculate state price density spd black scholes model lognormal distribution constant volatility parameter practice volatility change distribution deviate log normality estimate volatility spds use eurex option data dax index use different smooth technique estimation carry strike direction moneyness direction briefly introduce local polynomial one method important smooth technique apply paper spline usage roughness penalty allows flexible choice degree smoothness promising future research work arbitrage free constraint imply volatility keywords imply volatility state price density spline roughness penalty linear differential operator content introduction imply volatility spd statistical property imply volatility calculation imply volatility state price density spd estimation base iv smile quantlet spdcal spdcalm arbitrage free constraint nadaraya watson local polynomial estimator smooth iv functional data approach basic setup basis function approach spline base estimation coefficient choice smooth parameter quantlet bfacv bfagcv implemention penalize spline financial market data construction model content volatility smile function strike multiple observation volatility smile function moneyness volatility smile function moneyness ii conclusion summary outlook xplore quantlet list statistical tool implemention example proof convexity call price function arbitrage bound iv smile list daxoptionon maturity dax option th feb top panel iv strike bottom iv moneyness iv smile strike dax call option per panel bandwidth low panel bandwidth nadaraya watson estimator use iv smile moneyness dax call option per panel bandwidth low panel bandwidth nadaraya watson estimator use dax call option upper panel iv smile strike right panel spd bandwidth second order local polynomial use dax call option upper panel iv smile strike right panel spd bandwidth second order local polynomial use iv strike dax call option tau top iv smile bottom spd red horizon line represent left th order spline right th order spline dax call option blue dash horizontal line represent dax call option blue dash horizontal line represent list dax call option blue dash horizontal line represent dax call option blue dash horizontal line represent dax call option blue dash horizontal line represent dax call option blue dash horizontal line represent gcv score respect smooth parameter left panel right panel dax call option upper left panel iv smilewithstrike upperrightpanel spd blackthickline log normal distribution blue thin line red horizon line represent bottom left panel first derivative volatility respect strike bottom right panel first derivative black line arbitrage bound red dash line dax call option upper left panel iv smilewithstrike upperrightpanel spd blackthickline log normal distribution blue thin line red horizon line represent bottom left panel second derivative bottom right panel first derivative black line arbitrage bound red dash line cv score respect smooth parameter left panel right panel dax call option upper left panel iv smile upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel first derivative volatility bottom right panel first derivative black line arbitrage bound red dash line dax call option upper left panel iv smile upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel second derivative bottomrightpanel thefirstderivative blackline anditsnoarbitrage bound red dash line list dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel first derivative bottom right panel first derivative black line arbitrage bound red dash line dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel second derivative bottom right panel first deriva tive black line arbitrage bound red dash line dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel first derivative bottom right panel first derivative black line arbitrage bound red dash line dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel second derivative bottom right panel first deriva tive black line arbitrage bound red dash line list dax option th feb iv dax option example differential operator base correspond parametric family gcv score comparison parameter closing day data parameter parameter introduction derivative derivative security contingent claim financial instrument whose value depends value others basic underlie variable see franke ardleandhafner derivative base underlie varibales always focal topic research black scholes set milestone topic well know contribution black scholes option pricing model give framework pricing european style financial derivative base set assumption formula price financial derivative determine six parameter current underlie asset price strike price time maturity riskless interest rate dividend yield constant volatility cbs ln st cumulative standard normal density function upper integral limit first five parameter observe financial market di rectly volatility recover formula give five parameter option price straightforward method suggest estimate volatility financial market data insert empirical volatility calculate option price however study different financial market sp ftse dax others yield almost result volatility constant display functional structure respect strike time maturity show contradiction constant volatility assumption black scholes formula volatility rather implicit function dependent strike maturity imply volatility define parameter insert formula actually yield observe price particular option make formula fit market price option plot introduction imply volatility respect strike time maturity exhibit surface like smile across strike time maturity surface call imply volatility surface financial market essential argument smile consistent option pricing serf necessary tool risk management incorporate market model portfolio hedge volatility trading common practice trading floor thesametime basic theory much wider range many aspect cause microstructure financial market need use smooth tech niques construct iv smile quite research make model iv smile model classify two large group different method parametric method non semi parametric method shimko tomp kin german among first group non semi parametric method thought superior candidate parametric method since allow high functional flexibility parsimonious model attempt hafnerandwallmeier function sahalia luo rosenberg cont fonseca durrle man fengler employ nadaraya watson estimator iv high order local polynomial smooth iv use rookey fengler introduce least square kernel estimator smooth iv space option price aim paper estimate iv smile technique know functional data analysis technique apply estimation call penalize spline method employ linear differential operator roughness penalty operator allows flexibility smooth function explain method detail later chapter estimation assume iv function arbitrage free smooth iv smile insert model compute state price density spd also compare spline smooth technique nadaraya watson high order local polynomial estimator inchapter chapter first give statistical property iv next introduce method calculate iv financial market data explain concept spd estimate iv smile last section chapter discus arbitrage free constraint iv smile estimation nadaraya watson high order local polynomial estimator present apply iv spd estimation chapter introduction iv surface dax option imply volatility respect strike maturity iv xpl chapter splinestechnique data first section next definition spline interpret introduction roughness penalty approach introduce last section chapter chapter apply different smooth technique data finan cial market implement penalize spline data set first penalty operator smooth parameter change see impact estimation overcome problem multiple observation data preprocessed next section chapter concludes summary comparison different smooth technique chapter summarizes give outlook ongoing work contains xplore quantlets proof imply volatility spd statistical property imply volatility quite empirical research work imply volatility mainly smilepatters profileacross maturity term structure time series behavior imply volatility study sp ftse dax others give statistical property seem common market strike feature iv give date iv surface non flat shape exhibit strike term structure thfebruary strike maturity sample data asset price strike interest rate maturity option price option type dax option th feb def convenience employ time maturity call future moneyness forward price stock time call option money atm option option close atm usually trade high frequency atm option liquid imply volatility spd therefore available empirical research fengler market smile pronounce short time maturity becomes shallow longer time maturity smile function achieves minimum neighborhood atm near otm call option otm put region display high level iv otm call region time maturity calculation imply volatility scholesmodel practice scholesformula give market price option light black scholes european call option formula get cbs already observe evidently curvature shape iv across strike evidently across maturity described function time strike price expiry day fix data give function iv call imply volatility surface def usingmoneyness thefunctionofiv european put underlie strike maturity deduce put call parity ke imply volatility spd imply black scholes volatility determine uniquely trade option price monotonicity black scholes formula volatility para meter newton raphson algorithm provide numerical way invert black scholes formula order recover market price option xplore provide quantlet calculation ardle kleinow stahl usage xplore see ardle klinke mu ller implvola ivmethod calculates imply volatility use either method bisection orthedefaultnewton raphsonmethod raphson method thfebruary asset price strike interst rate maturity option price option type iv iv dax option ivsmile xpl state price density state price density spd fundamental concept arbitrage pricing theory imply volatility spd volatility smile ytilitalov deilpmiytilitalov strike price volatility smile deilpmi moneyness dax option th feb top panel iv strike bottom iv moneyness ivsmile xpl assetprice discount expect value future payoff give risk free interest rate recall black scholes european call option formula cbs imply volatility spd price underlie asset time expect dividend paid option life option strike price time maturity risk free interest rate ln st price european call present value discount expect value future payoff give pdf underlie asset price described definition spd pdf underlie asset price spd define deduce spd discount second derivative call option price respect strike price er probability stock arrive level date give stock level compute dk formula second derivative call option price respect strike price yield specific transition density log normal pdf prove log normal pdf write lns lns constant proof see fengler imply volatility spd spd estimation base iv smile derivative call oprion price respect strike price two different method introduce one estimate iv function strike calculate moneyness strike price er strike explicit function volatility approach calculate spd discuss drescher derive first need prove follow relationship always hold right hand side present alternative way exp exp exp exp exp exponential part right hand side give lnst ln ln imply volatility spd substitute equation exponent get exp ln er base equation black scholes formula european call option rewrite assumption volatility function first derivative call option price respect strike differentiate equation respecct strike er kd followng relationship use exp substitute lns lnk lns lnk imply volatility spd reorder combine term together achieve result spd calculate equation get spd equation measure monyness always insert spd compute accompany quantlet spdcal spdcalm introduce next subsection imply volatility spd quantlet spdcal spdcalm fstar spdcal sig sig sig tau calculate empirical state price density quantlet spdcal us function compute spd analytic formula us estimate volatility smile first second derivative calculate state price density method apply european option due assumption quantlet spdcal follow input parameter vector strike price sig vector point estimate volatility sig withrespect strike price sig vector point second derivative volatility smile respect strike price vector underlie spot price correct dividend vector risk free interest rate tau vector time maturity output parameter fstar vector state price density fstar spdcalm sig sig sig tau calculate empirical state price density moneyness measure quantlet us function compute spd analytic formula us estimate volatility smile respect moneyness first two derivative calculate spd method apply european option due assumption quantlet spdcal follow input parameter vector moneyness imply volatility spd sig vector point estimate volatility sig withrespect strike price sig vector point second derivative volatility smile respect strike price vector underlie spot price correct dividend vector risk free interest rate tau vector time maturity output parameter fstar vector state price density arbitrage free constraint lot recent research contribute estimation arbitrage spd practical way estimate spd might roughly classify group one direct approach base observation option price fit observation second derivative option price respect strike ardle hl avka use non parametric method estimate spd dax option price data thisdirectapproach first discuss section first introduce shimko matter method employ difficulty estimation impo sition arbitrage free constraint call price function accord ardle hl avka follow arbitrage constraint positive decrease convex second derivative exists density nonnegative integrates one constraint obvious constraint derive general property ofdensityfunction constraint deducedfrom arbitrage free conditionrequire ments see imply volatility spd translate volatility smile translation process easy explain theory bitter practice list general shape constraint volatility smile strike direction restrict arbitrage constraint estimate volatility positive respect strike express use express term moneyness measure right hand side nonnegative integrates one obtain dk limit interval kh dk kl constraint prove see constraint translate constraint call price function nadaraya watson local polynomial estimator several study fit parametric volatility function observe imply volatility shimko tompkins german german among group usually employ quadratic specification model iv function along strike profile parametric approach able capture prominent feature iv pattern hence estimate maybe bias others focus non semiparametric smooth approach estimate iv sahalia luo rosenberg cont fengler apply nadaraya watson estimator iv high order local polynomial smooth iv use rookey give short introduction non parametric method simplicity consider univariate model andtheresponse variable take value joint pdf independent error property take yield ofy givenx canbewritten yf dy denotes marginal pdf representation show regression function estimate via kernel density estimate joint marginal density nadaraya watson local polynomial estimator book ardle mu ller sperlich werwatz nadaraya watson estimator introduce pn pn rewrite formula pn local average response variable weight pn denotes univariate kernel function quartic kernel gaussian kernel widely use kernel quartic biweight kernel gaussian kernel exp nadaraya watson estimator see special case large family local smooth estimator one generalization local min denotes coefficient vector compute use weight least square estimator weight study extensively fan gijbels introduce follow matrix notation nadaraya watson local polynomial estimator weight matrix write solution usual lse formulation wx wy reduces get nadaraya watson estimator order usually take one local linear three local cubic regression nadaraya watson regression corresponds local constant least square fit plot iv smile use nadaraya watson regression second order local polynomial regression nadaraya watson case bandwidthissmall ifweenlarge thebandwidth tfittothedata especiallyin least superiority nadaraya watson estimator first local whenweusenadaraya watsonapproach curve near boundary problem improve since local polynomial imposes easy estimate derivative function advantage useful estimate iv base state price density since estimation spd require estimation iv first two derivative also plot estimate spd nadaraya watson local polynomial estimator iv smile strike ytilitalov deilpmiytilitalov strike price iv smile strike deilpmi strike price ivsmilewithstrike daxcalloption upperpanel bandwidth lowerpanel bandwidth nadaraya watsonestima tor use spdcalnw xpl nadaraya watson local polynomial estimator iv smile moneyness ytilitalov deilpmiytilitalov moneyness iv smile moneyness deilpmi moneyness iv smile moneyness dax call option upper panel bandwidth low panel bandwidth nadaraya watson estimator use spdcalnwm xpl nadaraya watson local polynomial estimator iv smile strike tau ytilitalov deilpmi ytisned strike price spd tau stock price daxcalloption upperpanel ivsmilewithstrike right panel spd bandwidth second order local polynomial use spdcallp xpl nadaraya watson local polynomial estimator iv smile moneyness tau ytilitalov deilpmi ytisned moneyness spd tau stock price daxcalloption upperpanel ivsmilewithstrike right panel spd bandwidth second order local polynomial use spdcallpm xpl smooth iv functional data approach basic setup every work day option trade frequently financial market transaction calculate one imply volatility collect data time time day day recover imply volatility function strike maturity due attribute may understand iv functional data observation real function underlie variable find example functional data many field human growth function time age weather data another example since dependence providesusmore flexible smooth technique estimation discretely observe data formally sample multivariate data described matrix contain observation dimensional row vector one dimensional random variable measurable mapping rp probability space set elementary event sigma algebra subset probability measure define rp dimensional vector space sigma algebra rp case functional data consists random function denote ith observation argument measurable mapping space function denote th observation argument assume function observe finite interval denotes low upper bound respectively ramsay dalzell introduce name functional data analysis fda give follow definition functional data smooth iv functional data approach sample call functional data th observation realfunctionx andhence eachx space single functional observation mean single observe function call replication functional data turn random sample replication paper wewilluseone daydata smooth technique functional data analysis case one replication advanced method functional data found ramsay silverman basis function approach want present functional data smooth function continuous parame ters generally idea advance curve look like complex certain characteristic may typically assume degree smoothness reason flexibility key issue demand estimation solve problem need mathematical machinery core idea replace vector input additional variable transformation use linear model new space derive input feature see hastie tibshirani jerome simplicity consider follow univariate model approach minimize penalize residual sum square min pen hk hilbert space real function smooth parameter pen penalty operator discus penalize regression detail section accord wahba solution even general class penalize regression problem form finite dimensional linear combination real value function follow hastie refer toasbasisfunction smooth iv functional data approach variable basis function function define fit classical linear model approach estimation call basis function approach spline base wide range basis function apply approach popular fourier base polynomial base spline base spline introduce since flexibility represent exists space piecewise polynomial spline basis certain subspace space separate polynomial interval piecewise polynomial function follow definition de boor piecewise polynomial described definition piecewise polynomial divide interval subin point call breakpoints let positive integer correspond ing piecewise polynomial function order define tji restrict piecewise function time high order derivative continuous breakpoint obtain polynomial spline de boor also define polynomial spline definition polynomial spline let integer indicate order piecewise polynomial give breakpoint sequence ii vector count number continuity condition interior breakpoint piecewise polynomial function call polynomial spline order spline define divide difference truncate power basis formally define definition spline whereb isl thb splineoforderk forthenon smooth iv functional data approach define follow recursion scheme otherwise number basis function uniquely define spline order thenumberofknots whilenbasis nknots norder spline basis also relatively easy evaluate basis function derivative xplore quantlet bsplineevalgd use approach estimation coefficient consider basis function approach estimate observe data generalize least square gls estimation coefficient use leave degree smothness order spline merely interpolate data without exploit structure noise might present data may use additional information function add roughness penalty penalize non smoothness due insight ramsay smoothness process generate functional data differentiates type data classical multivariate observation curve increase get total curvature measure roughness penalty pen smooth iv functional data approach use basis expansion penalty term write pen rc hd tion penalize residual sum square function argmin pensse pensse rc parameter control weight give stabilizer minimization higherthe chosen cross validation method linear differential operator ldo use generalize roughness penalty lf df dm dmf generalize penalize residual sum square function pensse lf lf rc dm dm hdm dm practice since many model base scientifical phisical model general idea order coefficient ldo sometimes may able operator base correspond parameter family heckman ramsay provide example differential operator base correspond parametric family choice smooth parameter technically discuss green silverman first approach choose smooth parameter subjectively different different feature data arise different scale explore one parameter value look best might chosen second approach choose automatically smooth iv functional data approach operator parametric family kernel exp co sin exp co sin exp du exp dv du metric family base data set self one popular method cross validation many case two approach combine automatic choice use start point subsequent subjective adjustment cross ing parameter main idea method split data set two part learn sampleandthe validation sample first use learn sample ass fit validation sample finally choose value minimize error criterion split data leave one rule method leave th observation function predict function data set follow ramsay silverman let denote smooth sample mean calculate smooth parameter observation except measure global discrepancy compute integrate square error ise ise dt see well predicts cross validation score cv com put sum square error observation cv dt small value cv well performance measure cross validation score hence minimize respect give optimal smooth parameter smooth iv functional data approach since cross validation time consume lead smooth data often generalize cross validation criterion introduce eubank value chosen minimize nsse gcv df df sse sse df weight matrix df effective number parameter degree freedom us estimate heckman ramsay define df tr number estimate parameter wheres usually thenumera torofgcvissmall whenthedenominator small df close thus minimize gcv mean fitting data well parameter see heckman ramsay xplore quantlet bfacv bfagcv introduce section quantlets use calculate cv gcv different smooth parameter quantlet bfacv bfagcv cvl bfagcv argval fdbasis lfd lambda lambda quantlet us compute gcv score syntax quantlet cvl bfagcv argval fdbasis lfd lambda input parameter avectorof observe argvals vector matrix argument value basisfd fdbasis object lfd identifies penalty term scalar contain order derivative penalize ldo object ldo variable coefficient apply ldo constant coefficient lfd matrix first smooth iv functional data approach column contains coefficient second one order derivative default value lfd weight matrix default value identity matrix lambda parameter roughness penalty smooth lambda specify estimate data lambda give calculate tr trr lambda also return output parameter gcv bfagcv argval fdbasis lfd lambda lambda quantlet us compute gcv score syntax quantlet gcv bfagcv argval fdbasis lfd lambda input parameter array observe functional value use compute functional data object number observe value per replication number replication number variable argvals matrix argument value respectively argument apply replication variable otherwise must hold replication apply certain vector argument basisfd fdbasis object lfd identifies penalty term scalar contain order derivative penalize ldo object ldo variable coefficient apply ldo constant coefficient lfd matrix first column contains coefficient second one order derivative default value lfd weight matrix default value identity matrix lambda parameter roughness penalty smooth lambda specify estimate data replication separately smooth iv functional data approach fd seeulbricht fd fd object gcv score respect smooth parameter lambda lambda also return output parameter lambda give calculate use input parameter argvals necessary lambda thenthismust note number observation single replication lambda estimate formula case even correspond input parameter set equal zero otherwise could use outer product basis matrix singular case value estimate lambda output matrixorthree dimensionalarray respectively miss value problem process method data fd observation argument miss insert nan also case number observation vary replication algorithm filter nan input parameter argvals contain nan otherwise getbasismatrix quantlet need readjust order handle nan functional value miss certain argument give arbitrary value theargument ittakesmore computation time nan include functional data input compiler need calculate coefficient replication separately see ulbricht use minimization method brent method golden section search choose optimal implementation penalize spline financial market data construction model inthischapter parameter validation algorithm smooth iv strike function include follow step define sequence non decrease knot deal strike use distinct strike price break point use moneyness argument set non decrease knot every point sort moneyness generate basis matrix vector knot define penalty operator choose smooth parameter obtain smooth function use get spd algorithm present follow generate grid range strike price use grid point generate last step argument value insert iv smile function calculate estimate volatility first deriva tives well second derivative use median stock price insert estimate volatility first deriva tives second derivative calculate spd implemention penalize spline financial market data volatility smile function strike inthissection wewilluseb withthisfunction get estimate iv first second derivative respect strike insert data spd calculation function use quantlet spdcal finally get spd curve data set maturity day use sample contains observation strike price set every euro observation concentrate several distinct strike value range firstly place knot strike price sequence non decrease knot different order spline compare th order th order spline use penalty operator smooth paramter set default value calculate select observation different strike price range strike observe spd estimate th order spline look smoother reasonable sense cubic spline function first second derivative breakpoints claimed low order spline discontinuity breakpoints visible human eye needthe splinestopermit continuity breakpoints high order derivative th order spline demand relatively observation use th order spline get well look spd curve enough observation number observation small use th order spline since impose enough penalty roghness estimation close interpolate data observe becausetheiv lead large difference estimate first second derivative next step vary smooth parameter put different weight curve smooth different iv strike curve spd curve plot accordingly use classical roughness penalty bias behavior explainable trade bias variance penalty second derivative function tends force curve straight line iv smile straight line base argument suggest use substitution next experiment rd order ldo data set use extremely large value implemention penalize spline financial market data iv smile th order spline iv smile th order spline ytilitalov ytilitalov deilpmi ytisned deilpmi ytisned strike price strike price spd th order spline spd th order spline stock price stock price iv strike daxcalloptionon tau top ivsmile bot tom spd red horizon line represent left th order spline right th order spline test xpl smooth curve large smoother spd implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price daxcalloption thebluedashed horizontal line represent spd xpl implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price daxcalloption thebluedashed horizontal line represent spd xpl implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price daxcalloption thebluedashed horizontal line represent spd xpl implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price dax call option blue dash horizontal line represent spd xpl implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price dax call option blue dash horizontal line represent spd xpl implemention penalize spline financial market data iv smile lambda ytilitalov deilpmi ytisned strike price spd lambda stock price dax call option blue dash horizontal line represent spd xpl implemention penalize spline financial market data subjective method choose choose base data set method introduce cross validation time consume since sample contains observation use gcv make choice gcv score different smooth parameter compute selection make base criterion provide gcv score accord respect different linear differential operator gcv gcv gcv score comparison testgcv xpl gcv score gcv score vcg vcg smooth parameter smooth parameter gcv score respect smooth parameter left panel right panel testgcv xpl also speculate minimize gcv function locate use bracket xplorequantlet nmbrent nmgoldencan apply minimization result return use nmbrent content lmin xmin implemention penalize spline financial market data content lmin fmin gcv minil xpl set get upper left iv strike curve upper right estimate spd well level also display log normal distribution simultaneously comparison mean variance log normal distribution equal function volatility stock price calculate mean bottom left first derivative volatility respecttostrike arbitrage bound refer also calculate integral spd since explicit function estimate spd curve integral carry directly approximate manner substitutional method divide strike price line several small equal interval denote width interval max min interval denote start point interval estimate density value approximate integral calculate analytically max dx min number interval precisely approximation result spd curve stock price range divide interval bin width calculate approximate integral quantlet spdgcv result iv smile get bias usage tends force curve straight line also choose best smooth parameter minimize gcv score gcv score integralis asin thebottomleftpanel inbottomrightpanel arbitrage bound show use iv smile match data well use especially initial part sparse observation first derivative iv lie within arbitrage free bound implemention penalize spline financial market data iv smile strike tau spd tau ytilitalov ytisned deilpmi strike price stock price first derivative first derivative arbitrage bound strike price strike price dax call option upper left panel iv smile strike upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel first derivative volatility respect strike bottom right panel first derivative black line arbitrage bound red dash line spdgcv xpl implemention penalize spline financial market data iv smile strike tau spd tau ytilitalov ytisned deilpmi strike price stock price second derivative first derivative arbitrage bound strike price strike price dax call option upper left panel iv smile strike upper right panel spd black thick line log normal distribution blue thin line red horizon line represent bottom left panel second derivative bottom right panel first derivative black line arbitrage bound red dash line spdgcv xpl implemention penalize spline financial market data multiple observation duetothe ourdatasetare consist multiple observation volatility finite vector strike price range problem solve use moneyness measure modify set incorporate characteristic one possible solution multiple observation use closing price strike mean strike select option trade late moment day convincible since closing price contains information thus reliable procedure largely decrease sample size may cause estimation less accurate complete th column data set contains trade time second midnight modification sample contains observation strike use distinct knot since observation use th order spline smooth parameter chosen cross validation time plot cv score respect different smooth parameter gcv score gcv score vcg vcg smooth parameter smooth parameter cv score respect smooth parameter left panel right panel testcv xpl plot penalty operator respec tively chosenbycross iv function employ iv smile fit observation quite well employ implemention penalize spline financial market data cv integral parameter closing day data minilcd xpl iv smile strike tau spd tau ytilitalov ytisned deilpmi strike price stock price first derivative first derivative arbitrage bound strike price strike price dax call option upper left panel iv smile upper right panel spd blackthickline log normaldistribution bluethinline red horizon line represent bottom left panel first derivative volatility bottom right panel first derivative black line arbitrage bound red dash line spdcd xpl implemention penalize spline financial market data iv smile strike tau spd tau ytilitalov ytisned deilpmi strike price stock price second derivative first derivative arbitrage bound strike price strike price dax call option upper left panel iv smile upper right panel spd blackthickline log normaldistribution bluethinline red horizon line represent bottom left panel second derivative bottom right panel first derivative black line arbitrage bound red dash line spdcd xpl implemention penalize spline financial market data volatility smile function moneyness section use iv smile moneyness estimate spd usage weuse thorderb spline place knot every grid fo moneyness find another advantage use moneyness argument need impose huge weight roughness penalty balance bias variance smooth parameter chosen gcv big difference two penalty operator shape spd work well smooth iv function dense observation iv smile curve bias initial part sparse observation superiority match data area sparse observation offer smooth parameter chosen gcv gcv score gcv parameter minilm xpl implemention penalize spline financial market data iv smile moneyness tau spd tau ytilitalov ytisnedy deilpmiy moneyness stock price first derivative first derivative arbitrage bound moneyness moneyness dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normaldistribution bluethinline bottom leftpanel firstderivative bottomrightpanel firstderivative blackline arbitrage bound red dash line spdm xpl implemention penalize spline financial market data iv smile moneyness tau spd tau ytilitalov ytisnedy deilpmi moneyness stock price second derivative first derivative arbitrage bound moneyness moneyness dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normaldistribution bluethinline bottom left panel second derivative bottom right panel first derivative black line arbitrage bound red dash line spdm xpl implemention penalize spline financial market data volatility smile function moneyness ii last section make estimation original data financial market multiple observation one problem use strike measure moneyness could beagoodsubstitution area several value see iv smile plot right tail part crowd dense observation also want take strike transaction time consideration even use moneyness measure denotethei correspond moneyness denotes transaction time second midnight practice volatility moneynesses repeat vector volatility moneyness respectively correspond vector strike price follow structure np pn denote indicator function vector one length construct model follow way divide sample data group different strike setevery minute second asainterval ineachgroup dividethedata time interval calculate median moneyness volatility sub group technique new data set run procedure xplore get fugure use th order gridsfomoneyness gcv offer smooth parameter chosen gcv gcv score implemention penalize spline financial market data gcv parameter minilmo xpl iv smile moneyness tau spd tau ytilitalov ytisnedy deilpmiy moneyness stock price first derivative first derivative arbitrage bound moneyness moneyness dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normaldistribution bluethinline bottom leftpanel firstderivative bottomrightpanel firstderivative blackline arbitrage bound red dash line spdmmo xpl implemention penalize spline financial market data iv smile moneyness tau spd tau ytilitalov ytisnedy deilpmi moneyness stock price second derivative first derivative arbitrage bound moneyness moneyness dax call option upper left panel iv smile moneyness upper right panel spd black thick line log normaldistribution bluethinline bottom left panel second derivative bottom right panel first derivative black line arbitrage bound red dash line spdmmo xpl implemention penalize spline financial market data conclusion chapter use penalize spline smooth iv function compare estimation use two parameterizations penalty operator smooth parameter estimation carry two line strike moneyness first strike use argument major problem repeat observation discrete strike value avoid repeat observation problem estimate model use closing price approach also flaw due small sample size application moneyness iv function argument solve problem multiple observation meanwhile need impose huge weight roughness penalty force curve smooth enough last estimation method combine strike moneyness together transaction time data grouped strike transaction time group median form new data set finally use reconstruct model smooth iv smile calculate spd use roughness penalty iv smile function bias wing due unequal distribution iv becomes obvious extremely large smooth parameter use penalty operator use cross validation gcv choose smooth parameter second derivative function penalize smooth parameter chosen cv gcv tends yield visible bias wing smile function yield good visual effect iv smile heavy penalty third derivative force first derivative function straight line make iv smile resemble quadratic parabola effect deviate empirical observation smooth effect remains discuss model successful produce non negative smooth spd first derivative iv smile function exactly locate within arbitrage bound summary outlook thenadaraya nadaraya mating derivative directly high order local polynomial avoid problem adaptive goal splinestoivsmile smoothingtechniques control smooth parameter adjust balance smoothness curve fitness curve data two instrument make method flexible fruitful fitting iv smile function degree smoothness use roughness penalty operator well performance wing iv smile function observation sparse like high order local polynomial estimate derivative spline directly advantage notable calculate spd imply volatility smile certain constraint introduce penalize spline extend fulfill constraint application special design ldo may yield interest result iv smooth calculation spd might another aspect extension xplore quantlet list statistical tool bfacv proc cvl bfacv argvals basisfd lfd lambda library fda see also data fd createfdbasis evalfd getbasismatrix bfagcv macro bfacv description calculate cv score library fda exist lfd lfd endif exist lambda lambda boollambda else boollambda endif exist diag matrix row endif dim diag matrix row endif error sum argvals inf argvals contain nan infs error row dim lambda row lambda lambda must scalar error row dim must vector error lambda lambda must non negative boollambda lambda inprodmat unit basisfd nbasis else inprodmat inprod basisfd basisfd lfd lfd basisfd nbasis row add small multiple identity inprodmat inprodmat inprodmat max inprodmat unit row inprodmat endif endif xx row basismat getbasismatrix argvals basisfd se matrix xx cvl matrix xx mi matrix xx row argvals xx begin boollambda boollambda boollambda lambda row basisfd nbasis lambda spur basismat basismat spur inprodmat fdo data fd argvals basisfd lfd lambda set equal default value lambda data fd else fdo data fd argvals basisfd lfd lambda endif eva evalfd argvals fdo mi cumsum eva eva se mi cvl cumsum se endo lambda endp bfagcv proc gcv bfagcv argvals basisfd lfd lambda library fda see also data fd createfdbasis evalfd getbasismatrix bfacv macro bfagcv description calculate gcv score library fda row dim xx dim else xx endif exist lfd lfd endif exist lambda lambda boollambda else boollambda endif exist diag matrix row endif dim diag matrix row endif error dim dim must quadratic dimension equal row error sum argvals inf argvals contain nan infs error row dim lambda row lambda lambda must scalar error lambda lambda must non negative boollambda lambda inprodmat unit basisfd nbasis else inprodmat inprod basisfd basisfd lfd lfd basisfd nbasis row add small multiple identity inprodmat inprodmat inprodmat max inprodmat unit row inprodmat endif endif basismat getbasismatrix argvals basisfd sse matrix col xx df matrix col xx gcv matrix col xx row argvals sum inf case functional data vector matrix miss value col xx begin boollambda boollambda boollambda lambda row basisfd nbasis lambda spur basismat basismat spur inprodmat fdo data fd argvals basisfd lfd lambda set equal default value lambda data fd else fdo data fd argvals basisfd lfd lambda endif coef fdo coef fdo basisfd nbasis sse basismat coef basismat coef smoothmat basismat inv basismat basismat lambda inprodmat basismat df spur smoothmat gcv sse df endo endo else case functional data vector matrix include miss value xx col kk row kk paf kk kk inf yy kk reformulate lambda boollambda boollambda lambda row yy basisfd nbasis lambda spur basismat kk basismat kk spur inprodmat fdo data fd argvals basisfd lfd lambda set equal default value lambda data fd else fdo data fd argvals basisfd lfd lambda endif coef fdo coef fdo basisfd nbasis sse yy basismat kk coef kk kk yy basismat kk coef smoothmat basismat kk inv basismat kk kk kk basismat kk lambda inprodmat basismat kk kk kk df spur smoothmat gcv sse df endo endo endif lambda endp spdcal proc fstar spdcal sig sig sig tau library finance see also spdcalm macro spdcal description calculate spd strike imply volatility error sum sum sig spdcal watch volatility negative rk row st sqrt tau ert exp tau rt tau log tau sig sig st sig st fstar pdfn ert sig st sig sig pdfn ert st sig sig st sig fstar fstar ert endp spdcalm proc fstar spdcalm sig sig sig tau library finance see also spdcal macro spdcalm description calculate spd moneyness imply volatility error sum sum sig spdcal watch volatility negative st sqrt tau ert exp tau rt tau ft ert log ft tau sig sig st sig st fstar pdfn sig ft st sig sig ft pdfn ft st sig ft sig ft st sig ft endp implemention example write lot quantlet compare different result different parameter mainly implement similiar way list list example illustrate procedure method sample data dax european opion th february list testgcv calculate gcv score smooth parameter plot gcv score respect different smooth parameter library finance library fda proc gcv fdagcvv argvals bspl lfd lam error row dim lam lam must vector row lam gcv matrix row lam gcv bfagcv argvals bspl lfd lam endo endp read rawdata dat read data paf paf tau implvola calculate implvola smile smile sort smile smile smile row smile delete outlier tvec generate non decrease sequence knot number knot decide dense strike parice bspl createfdbasis bspline tvec grid cgcv fdagcvv smile smile bspl cgcv cgcv cgcv setmask cgcv line setsize pic createdisplay show pic cgcv setgopt pic yvalue xlim xorigin title gcv score xlabel smooth parameter ylabel gcv border grid cgcv fdagcvv smile smile bspl cgcv cgcv cgcv setmask cgcv line setsize pic createdisplay show pic cgcv setgopt pic yvalue xlim xorigin title gcv score xlabel smooth parameter ylabel gcv border tempminicd find smooth parameter cross validation library finance library fda library nummath proc ct count count number different group divide different strike generate new vector element group number error col must vector ct matrix row row ct ct else ct ct endif endo endp proc subm submax divide different group different value first colum find maximum th colum group select accord observation constitute new matrix ct max count number different value first column subm matrix ct col matrix submax max xx paf mm max xx subm paf xx xx mm endo endp proc cvl minil lam read rawdata dat read data paf paf tau implvola row delete outlier count new matrix first column group number smile submax rd column time smile smile smile smile sort smile bspl createfdbasis bspline min smile max smile row smile smile cvl bfacv smile smile bspl lam endp lmin nmbrent minil lmin spdmmo preprocessthedata asisintrodunced plot iv smile first derivative estimate volatility respect strike together arbitrage bound spd curve chosen gcv library fda library finance read rawdata dat read data paf paf tau exp tau moneyness implvola row delete outlier int round create index time interval every minute int proc ct count count number different group divide different strike time index ct matrix row row ct ct else ct ct endif endo endp count proc subm submedian claculate submedian respect first column ct max count number different value first column subm matrix ct matrix submedian max xx paf subm median xx subm median xx endo endp smile submedian smile sort smile ix grid ix ix row smile index smile ix bspl createfdbasis bspline min max fdo data fd smile smile bspl grfd fdo eva evalfd smile fdo eva evalfd smile fdo first derivative volatility eva evalfd smile fdo second derivative volatility lpspd spdcalm smile eva eva eva median median median tau spd smile median lpspd li grid row spd li spd li li setmask li line red dash der smile eva st sqrt mean tau ert exp mean mean tau rt mean mean tau log smile ert mean tau mean eva eva st eva st lb cdfn st smile pdfn low bound first derivative ub cdfn st smile pdfn upper bound first derivative lb smile lb ub smile ub log normal mu mean log mean mean mean tau mean mean tau logn spd exp log spd mu sqrt pi spd logn setmask logn line blue thin setsize pic createdisplay setmaskp smile setmask line show pic smile setgopt pic xvalue yvalue title iv smile moneyness tau xlabel moneyness ylabel imply volatility re setmask spd line thick show pic re li logn title spd tau xlabel stock price ylabel density setgopt pic title title xlabel xlabel ylabel ylabel setgopt pic xvalue der setmask der line lb setmask lb line red dash ub setmask ub line red dash show pic der lb ub show pic der setgopt pic xvalue title first derivative arbitrage bound xlabel moneyness setgopt pic xvalue title first derivative xlabel moneyness setgopt pic border setgopt pic border setgopt pic border setgopt pic border proof convexity call price function proof see franke call option let construct follow portfolio time long position call exercise price long position call exercise price short position call exercise price value time position sum thus conclude hence difference portfolio value non negative imply arbitrage bound iv smile proof see fengler expiray date improve cbs cbs implies cbs cbs differentiate pb respect yield low bound pb pb pb finally insert analytica expression option derivative put price make use relationship obtain bibliography sahalia luo nonparametric estimation state price density implicit financial asset price journal finance andgerman anactivity base volatility estimator journal risk black scholes pricing option corporate liability journal political economy cont fonseca anddurrleman surface quantitative finance de boor practical guide spline springer new york drescher die dynamik implizierter risikoneutraler dichtefunktionen diplomarbeit universit zu eubank spline smooth nonparametric regression marcel dekker new york fan andgijbels local polynomial model application chap man hall london fengler semiparametric model imply volatility ph thesis universi zu franke ardle hafner introduction statistic financial market springer green andsilverman model roughness penalty approach chapmann hall london hafner wallmeier dynamic dax imply volatility inter national quarterly journal finance ardle andhl avka sfb discussion paper bibliography ardle kleinow andstahl springer ardle klinke andmu ller xplorelearningguide springer verlag heidelberg new york ardle mu ller sperlich werwatz nonparametric semiparametric model springer hastie tibshirani andjerome springer heckman ramsay penalize regression model base penal tie canadian journal statistic ramsay functional data analysis read bank ed en cyclopedia statistical science wiley new york ramsay dalzell tool functional data analysis journal royal statistical society ramsay silverman functional data analysis springer new york ramsay silverman apply functional data analysis method case study springer new york rookey dayoptionquotes application option pricing risk management technical report depart ment finance arizona rosenberg imply volatility function reprise journal derivative shimko bound probability risk tompkins imply volatility surface uncover regularity option financial future work paper vienna technology ulbricht represent functional data smooth function master thesis universi zu wahba spline model observational data society industrial apply mathematics philadelphia
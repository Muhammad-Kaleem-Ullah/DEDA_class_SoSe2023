uniform confidence band pricing kernel master thesis present weining wang prof dr wolfgang rdle prof dr ostap okhrin case center apply statistic economics partial fulfillment requirement degree master statistic jan content introduction empirical pricing kernel estimation epk option pricing confidence interval confidence band sheet maturity dimension confidence band base smooth imply volatility bootstrap confidence band monte carlo study well model cover well band reality illustration dax data data estimation dax epk uniform confidence band link economic condition epk dynamic conclusion proof lemma proof lemma proof theorem expression semiparametric estimator spd list list bibliography pricing kernel implicit option price play key role assess risk aversion equity return deal nonparametric estimation pricing kernel empirical pricing kernel give ratio risk neutral density estimator subjective density estimator former density represent second derivative european call option price function estimate nonparametric regression subjective density estimate nonparametrically framework develop asymptotic distribution theory epk sense particularly evaluate overall variation pricing kernel develop uniform confidence band epk furthermore alternative asymptotic approach propose bootstrap confidence band developed theory helpful test parametric specification pricing kernel direct extension estimate risk aversion pattern establish result assess compare monte carlo study real application test risk aversion time induced epk keywords empirical pricing kernel confidence band bootstrap kernel smooth ing nonparametric fitting introduction challenge task financial econometrics understand investor attitude towards market risk evolution time study naturally involves epk seecochrane riskpreferencesand exhibit estimate data call epk paradox several study include sahalia lo brown jackwerth rosenberg engle show although study epk paradox non monotonicity become evident test functional form pricing kernel devise yet uniform confidence band drawn around epk simple tool shape inspection confidence band base asymptotic theory bootstrap subject paper addition relate critical value test change market condition give exogenous time series market thus directly observe path return profound martingale base pricing theory provide one approach attack problem probabilistic perspective important concept involve state price density spd arrow debreu price reflect fair price one unit gain loss whole market arbitrage assumption exists least one spd market complete unique spd assume market complete pricing do risk neutral measure related pdf historical measure multiply stochastic discount factor see section detailed illustration economic perspective price formulate accord utility maximization theory admits risk preference consumer connect shape utility function specifically concave convex linear utility function describes risk averse risk seek risk neutral behavior importantly stochastic discount factor express via utility function marginal rate substitution link shape pricing kernel pk risk pattern investor see kahneman tversky jackwerth rosenberg engle others example inter temporal pricing kernel function moneyness fix maturity day year respectively jan blue apr red may magenta june black see grith rdle park mention theory allows relate price process asset trade market risk preference investor amount fit flexible model make inference dynamic epks time different market well know restrictive approach assume underlie follow geometric brownian motion set risk neutral density historical density log normal distribution different drift pricing kernel form derivative power utility thus decrease return implies overall risk averse behavior however across different market one observes quite often non decrease pattern epks phenomenon call epk paradox see chabi yo garcia renault two plot pricing kernel show depicts inter temporal pricing kernel fix maturity depicts pricing kernel two different maturity confidence band show return scale curve present bump middle switch convexity concavity case especially show unlikely band contain monotone decrease curve example inter temporal pricing kernel various maturity year day red day black jan confidence band order study epk paradox time vary coverage probability uniform confidence band give reliable information fix point time help test alternative pk thus yield insight time vary risk pattern test monotonicity pk propose golubev rdle timofeev extract time vary parameter realize either low dimensional model pk give coverage probability may thus economically analyze connection exogenous macroeconomic business cycle indicator creditspread yieldcurve etc seealsogrith rdleandpark several econometric study concerned estimate pks estimate risk neutral density historical density separately see section detail stress sahalia lo nonparametric inference pricing kernel give unbiased insight property asset market stochastic however asymptotic distribution maximum deviation uniform confidence band link useful model check sity estimator bickel rosenblatt extension regression smooth found liero rdle recently result carry derivative smooth claeskens van keilegom theoretical path follow largely result result apply ratio estimator instead local polynomial estimator additionally extend result dimension include maturity also realistic data situation relates coverage economic indicator addition perform smooth imply volatility space brings interest modification result paper paper organize follow section describe theoretical con nection utility function pricing kernel section present nonparametric framework estimation historical risk neu tral density derive asymptotic distribution maximum deviation section simulate asymptotic behavior uniform confidence band compare bootstrap method moreover also compare result parametric estimation section conclude discus result empirical pricing kernel estimation consider arbitrary risky financial security price process assume nonnegative semi martingale continuous marginals net present value future payoff interest rate process deterministic assume market complete exists one positive er risk neutral valuation principle nonnegative payoff hold factorization obtain imply dx st pdf price last expression justifies notion st pricing kernel use follow ait sahalia lo consider distribution rx dz density function st st st commonly call risk neutral distribution state price density spd follow observe dx st qst implies pdf future payoff spd pst require compute epk several approach available determine epk explicitly first impose strict parametric restriction dy namics asset price distribution future payoff example mixture normal distribution jackwerth case complex stochastic process usually explicit solution available possible technique though use brownian motion setup prior model subsequently spd estimate minimize distance prior spd subject constraint characterize underlie security see rubinstein jackwerth rubinstein second epk determine utility function agent let aim investor solve problem max wt denotes utility function wealth subjective discount factor show stochastic discount factor proportional epk give st st implies fix utility investor determine epk practice however usually opposite procedure apply epk sta tistically estimate use determine utility function risk aversion coefficient investor epk option pricing andthepdfp separately st st drop index write simply latter easily estimate either parametrically nonparametrically time series payoff contrary spd depends risk preference therefore past observe stock time series contain information option price reflect preference therefore use estimate spd let denote european call option price function strike price price maturity interest rate er st black scholes framework underlie asset price follow geometric brownian motion european option price via xer know function implies lognormal distribution log exp replace beside model bias implicit model also possible reflect implicit volatility smile surface function via latter may derive stochastic volatility model heston bates type even complex parametrizations order study unbiased risk pattern need guarantee model pricing kernel rich enough reflect local risk aversion time space lead naturally smooth approach consider call option maturity maturity intraday call option ob serve denotes observe option price strike price assume cross section var say perceive error due neglect heterogeneity factor rather mispricings exploit arbitrage strategy see renault depicts call option price data use calculate spd observation distribute different variance discrete grid point strike price sim plot call option price strike price plicity notation write assume continuously differentiable order locally approximate see cleveland fan fan ruppert wand detail assume local gaussian quasi likelihood model arrive nq nq hnq gaussian kernel function bandwidth sequence hnq nq vector solution obtain via optimization problem nq certain compact set equivalent solve nq def nq hq concerned show breeden litzenberger proportional practice assume gaussian quasi likelihood function equivalent local least square smooth ad ditionally note assume parameter orthogonal thus estimate separately single parameter case let denote jth component vector equation component nq nq corresponds th derivative option price evaluate follow lemma state result existence solution consistency lemma condition exists sequence solution equation nq sup logn nq nq nq price underlie asset nonparametric kernel estimator np give st np hnp bandwidth kernel necessarily coincides np kernel assumption know sup logn np np estimator epk give ratio estimate spd risk neutral density next lemma provide lin earization ratio important statement uniform confidence band epk lemma condition hold sup sup max logn logn np np nq nq nq lemma implies stochastic deviation kb linearize stochastic part contain estimator spd deterministic part con taining uniform convergence prove deal separately two part convergence deterministic part show impose mild smoothness condition convergence stochastic part prove fol low approach claeskens van keilegom theorem formalizes uniform convergence epk theorem condition hold sup max logn logn np np nq nq nq proof give confidence interval confidence band confidence interval characterize local precision epk give fix value payoff allows test epks particular return allow conclusion global shape confidence band however char acterize whole epk curve offer therefore possibility test shape characteristic particular way check persistence bump observe give certain shape rejection one may verify restriction impose power utility obtain insight risk aversion agent addition confidence band use measure global variability epk also proportion fitting cover nonparametric band use measure global risk aversion confidence interval epk fix value require asymptotic dis tribution hereafter use denote convergence law du np nq tn equal product density strike price local fisher information matrix matrix give ui jk du ui jk du implies asymptotic normality estimate epk fix payoff precisely let time point time maturity fix respective epk denote variance give var tn let standardize process var nq rely linearization lemma derive confidence band theorem assumption follow logh sup exp exp nq nt logh logh log nt nq nq confidence band pricing kernel thus sup vdar log log nq nt mn tn ui du hnq ui du hnq implementation real data need consistent estimator var fix rely delta method use empirical sandwich estimator see carroll ruppert welsh latter method provide variance estimator parameter obtain estimate equation give data point vdar xnq xt hnq nq nq xnq xt hnq nq nq diag estimator nq nq consistent setup motivate carroll sheet maturity dimension note asymptotic behavior correctly standardize depend estimate variance function time extend confidence band sheet dimension let set maturity interest joint confidence sheet payoff maturity give sup var example sheet pricing kernel setup actually provide explicit link epks different maturity fix maturity interest rate obtain normal form exp implies exp exp fix log difference pks proportional difference maturity fact give insight evolution sheet maturity precisely know characteristic band fix confidence band give vdar vdar confidence band base smooth imply volatility construction epk estimator stabilize two step procedure rookley fengler first step estimate imply volatility iv function local polynomial regression second step plug smooth iv formula obtain semiparametric estimator option price since model homogeneous respect asset price strike price smooth iv use local polynomial regression moneyness absence dividend define time heteroscedastic model iv give error zero mean unit variance volatility function define rescale call option price obtain formula log combine result breeden litzenberger expression lead spd er er dc dm dm show derivative last expression de termined explicitly function estimate latter quantity nonparametric local poly nomial regression iv respective estimator denote plug result obtain estimator spd smooth iv space assume iv process fulfills assumption conclude theorem claeskens van keilegom hold also note convergence rate low rely fact state asymptotic behavior next theorem theorem let satisfy assumption log er log theorem allows construct confidence band spd estimate semi parametrically use confidence band iv variance estimator obtain delta method follow way var var sufficient consider variance second derivative var first derivative neglect variance estimate use sandwich estimator similarly bootstrap confidence band hall show density estimator supremum converges slow rate logn gumbel extreme value distribution therefore confidence band may exhibit poor performance finite sample alternative approach use bootstrap method claeskens van keilegom use smooth bootstrap numerical approximation critical value consider bootstrap technique lead term lemma sup resample data smooth bivariate distribution density estimator nq nq nq nq nq motivation use smooth bootstrap procedure rosenblatt transformation require resampled data continuously distribute sample data set calculate bootstrap analogue sup one may argue resampling technique correctly reflect bias arise estimate rdle marron use therefore resampling proce dure base large bandwidth refine bias correct bootstrap method require case since bandwidth condition ensure negligible bias asymptotically correspondingly define one step estimator stochastic deviation nq nq nq variance estimate bootstrap sample var kb lemma assume condition bootstrap confidence band epk sup kb vdar kb bound satisfies nq nq monte carlo study practical performance theoretical consideration investigate via two monto carlo study first simulation aim evaluate performance hypothesis second simulation setup realistically calibrate surface confidence band apply dax index option first study confidence band null model naturally without volatility smile estimator nonparametric estimator expect cover band presence volatility smile expect test reject hypothesis case well model cover first set calibrate model day interest rate set equal short rate strike price interval refer sahalia duarte source noise use identical simulation set noise uniformly distribute interval fig scatter plot generate observation data cluster discrete value strike price show nonparametric estimator spd parametric estima tor two estimator roughly coincide except small wiggle thus band drawn around nonparametric curve also fully cover parametric one ac curacy evaluate calculate coverage probability average area within band see coverage probability determine via simulation whenever hypothesize curve calculate grid coverage probability approach nominal level sample size band get narrower increase sample size however coverage probability never reach nominal level may well attribute mention poor convergence gaussian maximum gumbel distribution area within band reflect stability estimation procedure generate noisy call option price strike price coverage probability area uniform confidence band annualized volatility spd historical density estimate simulated stock price follow geometric brownian motion therefore epk estimator could test use procedure due boundary effect concentrate moneyness display nonparametric epk confi dence band epk cover band observe epk strictly monotonically decrease summary statistic give due additional source randomness introduce esti estimation spd red band black spd blue nq coverage probability area uniform confidence band annualized volatility spd mation coverage probability less precise correspond coverage probability spd nevertheless probability get closer nominal value band get narrower sample size increase coverage probability area uniform confidence band epk volatility annualized estimation epk red band black epk blue nq coverage probability area uniform confidence band epk volatility annualized well band reality section whilethissection design investigate performance band null hypothesis violate realistic volatility smile observe market feature imply volatility smile refer fengler keep parameter identical setup first study generate data smooth volatility function base maturity report estimator spd epk band cover bsestimator correspondingly andtable rapidly decrease sample size increase however area within band change significantly compare result section conclude confidence band useful detect deviation model coverage probability area uniform confidence band epk coverage probability area uniform confidence band epk plot confidence band black estimate value red blue spd simulated volatility smile nq np plot confidence band black estimate value red blue epk simulated volatility smile nq np illustration dax data data contrast previous study mainly base data focus eurex data available rdc sfb http sfb wiwi hu de extract observation analysis cover period show dax index semiparametric spd estimate rookley apply estimate epk fix maturity concentrate moneyness dimension find trade option maturity day consider option maturity day trading day across several year specifically extract time series option every month jan dec add day weuseseveral cleaning criterion sample eliminate observation iv also skip option quote violate general arbitrage condition max ke due put call parity money call option money put use compute smooth volatility surface median use compute risk neutral density use window return nonparametric kernel density estimator hd describes relative position hd spd specific day different moneyness state plot dax index plot estimate state price density rookley method nq black historical density blue np estimation dax epk uniform confidence band epk black rookley epk red uniform confidence band blue consider two specification pricing kernel first specification pricing kernel marginal rate substitution power utility function scale factor determines slope pricing kernel thus calibration realize linearly regress order log epk log moneyness second specification construct nonparametric confidence band described section sequence epks correspond band showninfigure inmostofthecases band amount deviation hypothesize specification though provide valuable information risk hungry investor besides area band varies time give insight variability prevail risk pattern sum band provide simple test hypothesizes epks also help study dynamic risk pattern time coverage probability dax index rescale first difference coverage probability dax index return standardize link economic condition epk dynamic use two different indicator deviation simple model approximation coverage probability calculate proportion grid point band cover epk second measure introduce average width confidence band moneyness interval proxy area confidence band provide measure variability see also theorem first risk pattern time series give display dax index scale together coverage probability discover coverage probability becomes less volatile dax index level high show differenced time series simple correlation analysis argue change coverage probability dax return lag highly negatively correlate correlation dax index go contrary period dax go one observes large positive correlation mean economically implies period worsen economic condition positive part monthly dax return induces great hunger risk delay horizon month positive return opposite effect boost bullish market positive correlation indicates month horizon decrease risk aversion far average width band concerned may conclude fig ure period clearly bullish bearish momentum volatility width confidence band high may cause uncertainty market participant long term persistence trend lag effect risk hunger also detectable construct indicator whole observation interval correlation monthly dax return change average width lag area band dax index scale first difference area band dax index return standardize conclusion pricing kernel important element understand investment behavior since reflect relative weight give investor state nature arrow debreu security pricing kernel may deduce either parametric nonparametric approach parametric approach like simple model restrictive account dynamic risk pattern induces well know epk paradox nonparametric approach allow flexibility reduce model bias simple tool like uniform confidence band help conduct test parametric assumption epks shape inspection consider numerical stability smooth iv surface via rookley method obtain spd estimator study systematically methodology construct uniform band semiparametric nonparametric estimator base confidence band explore two indicator measure risk aversion time connect dax index one coverage probability measure proportion fitting curve cover band another one area indicator measure dax index indicator lag effect smooth bootstrap study without significant improvement finite sample performance one interest extension would employ robust smoother improve bootstrap performance assumption way logn optimal band nq nq nq width guarantee undersmoothing order logn kernel function take value boundary likelihood function hold inf additionally third partial derivative respect exists continuous every fisher information continuous derivative inf exists neighborhood maxsup sup ck furthermore supe sup density underlie three time continuously differentiable let logn logn np np np nq nq nq lemma assume nq np nq proof lemma consider disturbed coefficient local polynomial nqj positive value sequence lead nqj modify system equation nq nqj hnq similarlytolemma ofh rdle janssenandserfling andusingassumptions obtain un nq loq gnnq sup sup hnq hj ec nq nq xnq hnq hj nq nq implies sup ea hj logn nqj nqj nq nq nqj particularly implies ea ap nqj nqj nqj propriate consider first order taylor expansion nq around true value parameter polynomial regression note obtain nq nqj hnq je nqj note sup pp uj du decompose hnq hnq expectation two part one contain second one contain pp let nqj jk du supc nq nq hnq nq first part bound constant second nq part bound choose max obtain nqj nqj nq nqj similarly show nqj nqj nqj nqj implies nqj nqj nqj nqj nqj nqj suchthatsup choice implies nqj nqj sup logn nq nq nq proof lemma recall lemma sup logn nq np np sup logn nq nq nq nq determine order epk linearize ratio decompose first factor second factor use first order taylor expansion put together obtain sup sup first two element order respectively last nq np element order summarize conclude np sup max np nq proof theorem basic idea proof approximate process vdar nq nq process non stochastic variance term approximate process treat tool claeskens van keilegom drop simplicity notation index nq first approximation define var give equation lemma ensures approximation uniformly order logn process equation approxi op mat claeskens van keilegom exp definition local fisher information matrix process refer section section define ni nh ni ni equation write exp hi ni please note function claeskens van keilegom erroneously write follow line thought replace uniformly ni dz ni order apply corollary bickel rosenblatt denote covari ance function gaussian process note nq cov nj nj constant since regularity condition satisfied result follow finally show sup vdar var op sup vdar var sup vdar var op nh logn accord corollary claeskens van keilegom sup vdar var op nhlogn implies sup vdar var op expression semiparametric estimator spd take derivative respect moneyness note depend obtain dc dd dd dm dm dm dd dm dm dm dd dd dm dm dm compute first second order differential use notation obtain dd log dm mv dd log dm mv log dm mv log mv log dm mv log mv list example inter temporal pricing kernel function money ness fix maturity day year respectively jan blue apr red may magenta june black see grith rdle park example inter temporal pricing kernel various maturity year day red day black jan confidence band example sheet pricing kernel plot confidence band black estimate value red blue spd simulated volatility smile nq np plot confidence band black estimate value red blue epk simulated volatility smile nq np optional caption list  list coverage probability area uniform confidence band annualized volatility spd coverage probability area uniform confidence band annualized volatility spd coverage probability area uniform confidence band epk volatility annualized coverage probability area uniform confidence band epk volatility annualized coverage probability area uniform confidence band epk coverage probability area uniform confidence band epk declaration authorship hereby confirm author master thesis independently without use others indicate resource passage literally general matter take publication resource marked bibliography sahalia duarte nonparametric option pricing shape restric tions journal econometrics sahalia lo nonparametric estimation state price density implicit financial asset price journal finance sahalia lo nonparametric risk management imply risk aversion journal econometrics bickel rosenblatt global measure deviation density function estimate annals statistic breeden litzenberger price state contingent claim implicit option price journal business brown jackwerth pricing kernel puzzle reconcile index option data economic theory manuscript carroll ruppert welsh local estimate equation journal american statistic association chabi yo garcia renault state dependence explain risk aversion puzzle review financial study claeskens van keilegom bootstrap confidence band regression curve derivative annals statistic cleveland robust locally weight regression smooth scatterplots journal american statistical association cochrane asset pricing princeton press fan design adaptive nonparametric regression journal american statistical association fan local linear regression smoother minimax efficiency annals statistic fengler semiparametric model imply volatility springer fengler option data model imply volatility handbook compu tational finance duan gentle rdle ed springer verlag golubev rdle andtimofeev journal apply econometrics invite resubmission grith rdle park shape invariant model pricing kernel risk aversion journal financial econometrics submit hall edgeworth expansion nonparametric density estimator appli cation vol new york academic press rdle asymptotic maximal deviation smoother journal multivari ate analysis rdle janssen serfling strong uniform consistency rate estimator conditional functionals annals statistic rdle marron bootstrap simultaneous error bar nonparametric regression annals statistic jackwerth recover risk aversion option price realize return review financial study jackwerth andrubinstein price journal finance kahneman tversky prospect theory analysis decision risk econometrica liero maximal deviation kernel regression function estimate mathematische operationsforschung und statistik serie statistic renault econometric model option pricing error kreps wallis ed proceeding seventh world congress econometric society econometric society monograph london cambridge press pp rookley fully exploit information content intra day option quote application option pricing risk management manuscript rosenberg engle empirical pricing kernel journal financial economics rubinstein imply binomial tree journal finance ruppert wand multivariate locally weight least square regression annals statistic zhao asymptotics kernal estimator base local maximum likelihood nonparametric statistic
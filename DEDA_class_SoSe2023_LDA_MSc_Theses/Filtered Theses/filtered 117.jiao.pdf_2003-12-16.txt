portfolio resampling efficiency issue master thesis present wei jiao prof dr wolfgang ardle institute statistic econometrics partial fulfillment requirement degree master science universita zu school business economics spandauer str december declaration authorship hereby confirm author master thesis independently indicate resource use content literally general matter take publica tions resource marked wei jiao th january thesis start review traditional portfolio theory discussion limitation new technique portfolio resampling introduce follow two different portfolio efficiency test method final part empirical study portfolio revision short conclusion make end thanks professer dr wolfgan ardle universita zu dr thorsten neumann deka investment gmbh ying chen universit zu kind advice help content introduction traditional portfolio construction define markowitz efficiency mathematical notation efficient frontier minimize variance approach maximize utility approach application mean variance optimization benchmark relative optimization definition track error optimization compare mean variance optimization criticism limitation mean variance efficiency criticism fundamental limitation mean variance efficiency data analysis descriptive statistic normal distribution test resampled efficient frontier estimation error estimation error definition visualise estimation error resampled efficient frontier pro con resampled frontier portfolio revision sample acceptance region confidence region resampled portfolio empirical study portfolio revision conclusion statistic analysis optimization estimation error simulation sample acceptance region resampling list data analysis descriptive statistic lilliefors goodness fit normal distribution test data set lilliefors goodness fit normal distribution test data set partial covariance matrix data set list efficient frontier efficient frontier asset point efficient frontier non negative weight constrain track error efficient frontier mean standard deviation comparison boxplot data set boxplot data set estimation error effect estimation error cause mean estimation error cause variance resampled frontier michaud resampled frontier data set resampled frontier data set resampling data set resampling data set sample acceptance region data set sample acceptance region data set traditional portfolio construction define markowitz efficiency markowitz mean variance efficiency cornerstone modern finance asset management give presumption rational investor make investment deci sion basedon risky asset expect return andrisk risk measure variance portfolio consider mean variance efficient minimum variance give level portfolio expect return maximum expect return give level portfolio variance mathematical notation istheweight asset portfolio portfolio expect return define variance portfolio double sum product order pair asset portfolio weight asset portfolio weight asset standard deviation asset standard deviation asset correlation asset mathematical notation express matrix format covariance matrix expect return portfolio weight expect return write nn portfolio risk measure variance portfolio return calculate nn efficient frontier two way find efficient frontier minimize portfolio variance portfolio range minimum return maximum return trace efficient frontier maximize investor utility function give risk tolerance parameter vary trace efficient frontier two method lead efficient frontier utility function quadratic asset return normal distribute minimize variance approach follow first approach include two constraint require portfolio return equal sum portfolio weight equal one problem express follow minw solve lagrangian dd wl dl dl first equation plug last two equation define follow term constant rewrite formula solve equation value two multiplier ac ac plug two multiplier back expression ac mean variance efficient frontier nruter egareva dezilaunna annualized return standard deviation efficient frontier notice optimal portfolio weight vector function absolute expect return portfolio variance thus ac ac ac therefore portfolio low risk co ordinate show mean variance efficient frontier use parameter data set explain data analysis chapter mean variance efficient frontier nruter egareva dezilaunna annualized return standard deviation efficient frontier asset point also add single asset point make optimization effect clearer reality asset weight negative short sell low show mean variance efficient frontier non negative weight constraint compare efficient frontier without non negative weight constraint show found efficient frontier non negative weight constraint much longer another word less efficient one without fact constraint add less efficient frontier mean variance efficient frontier nruter egareva dezilaunna annualized return standard deviation efficient frontier non negative weight constraint maximize utility approach give quadratic utility function rational investor utility later approach trade risk return maximize utility various risk tolerance parameter high risk tolerance less weight give variance penalty term aggressive portfolio become optimal solution found take first derivative respect port folio weight set term zero solve optimal weight vector dutility dw introduce general linear constraint aw denotes matrix row equal number equality constraint column equal number asset vector limit maximize utility subject aw form standard lagrangian aw vector lagrangian multiplier one constraint take first derivative respect optimal weight vector vector multiplier yield dl dw dl aw aw insert low equation solve result equation lagrange multiplier arrive substitute equation equation finally get optimal solution linear equality constraint accord scherer optimal solution split constrain minimum thisisknowas two fundseparation see equation first term depends neither expect return risk tolerance hence minimum risk solution whereas second term sensitive input application mean variance optimization two popular application mean variance optimization asset allo cation equity portfolio optimization case goal maximize expect portfolio return minimize risk asset allocation though candidate pool compose large asset cat egories domestic equity corporate government bond international equity bond real estate venture capital equity portfolio optimization large pool security include complicate constraint portfolio characteristic industry sector mem increase complexity optimization process input start point also different asset allocation optimization sample mean variance correlation base monthly quarterly annual historic data start point source equity optimization input different expect residual return equity derive version capital asset pricing model arbitrage pricing theory practice portfolio manager often use expect return net systematic risk expect return optimization input benchmark relative optimization markowitz model us absolute risk measure variance find efficient portfolio practice however benchmark relative portfolio optimization widely use due fact investor would like know kind risk portfolio carry relative benchmark give amount relative risk well portfolio perform thus benchmark become important standard evaluate portfolio manager performance time brings question portfolio construction process benchmark relative risk optimization bring result markowitz absolute risk optimization benchmark good performance measure answer question would like first introduce important concept track error definition relative risk measure track error define standard deviation port folio active return portfolio return minus benchmark return calculate eitherex antete wherew orex post te denotes active return denotes mean active return track error optimization procedure minimize variance approach use find low track error give level portfolio active return formulate minw wa solve lagrangian dd wl dl dl first equation plug last two equation use term rewrite formula solve equation value two multiplier ae ac ac plug two multiplier value expression ac optimum active weight vector give desire level relative return optimize track error te ac ac bi ac abi ab ac ab ac ae ac notice solution portfolio active return set zero active weight vector track error zero therefore optimum portfolio benchmark contrary track error efficient frontier straight line axis standard deviation instead variance another thing notice upper low bound active weight easy formulate besides one sum negative active weight sum positive active weight include constraint quadratic program optimization function compare mean variance optimization interest find track error efficiency compare markowitz mean variance efficiency mean variance space another word would like see whether track error efficient portfolio also mean variance efficient portfolio weight vector benchmark weight vector benchmark return portfolio active return track error efficient frontier nruter evitca dezilaunna annualized track error track error efficient frontier ac ac ac bi bi ac ac ac ac ac ac ac ac equation represent track error optimization portfolio locate expect return variance space compare equation notice two efficient frontier difference constant term ac distance zero benchmark lie markowitz ac efficient frontier also make clear track error optimization provide optimum solution absolute term unless benchmark mean variance optimum portfolio seldom case even include track error constraint instead objective func tion optimization result still track error efficient frontier show absolute efficient andrea nardon suggests important start optimization understand benchmark lie mean variance space conjunction performance risk target portfolio strategist choose help client choose appropriate level track error criticism limitation mean variance efficiency criticism mean variance efficiency first criticism concerned assumption mean variance efficiency common knowledge reality return multivariate normal distribute investor might exhibit different utility function quadratic form investor might multi periodic investment horizon contrast mean variance one period framework also risk measure variance use mean variance optimization might proper variance measure variability mean investor point view variance mean actually risk return mean specify level return much important investor downside risk measure variability semivariance semistandard deviation return mean xi absolute deviation range measure could good alternative traditional risk measure variance standard deviation serious indeed problem practical use mean variance base portfolio construction examine question well mean variance framework approximate reality vestors might different utility function return might mally distribute well one period solution approximate multiperiod optimality whether practice non variance risk measure lead significantly different efficient portfolio since markowitz mean variance efficiency consistent expect utility maximization either asset return normally distribute investor areallthetimetrue mean utility maximization second question divide problem two separate question mean variance frontier change investment horizon lengthens period efficient portfolio first question relative easy answer assume homoskedastic zero serial correlate normally distribute asset return portfolio return variance proportional time horizon mean curvature efficient portfolio irrespective time horizon answer second question accord scherer fairly strict sumptions repeatedly invest one period efficient portfolio also result multiperiod efficient portfolio investor constant relative risk aversion wealth level change optimal allocation posse financial wealth asset return autocorrelated investment opportunity time vary ie period return forecastable uncertainty estimate parameter portfolio return path dependent due intermediate cash flow cash infusion withdrawal transaction cost assumption especially last two unrealistic investment opportunity time vary transaction cost unavoidable would say reality repeatedly invest one period efficient portfolio result incom parable multiperiod inefficient portfolio problem appropriate risk measure point michaud return diversified equity portfolio equity index asset ten approximately symmetric period institutional interest efficiency base nonvariance risk measure may nearly equivalent mean variance efficiency symmetric return downside risk contains information variance bond return fix income index less symmetric equity class option return distribution approximately symmetric addition return distribution diversified equity portfolio becomes increasingly asymmetric overalong enoughperiod consequently risk appropriate many application institutional interest however variance base efficient frontier often little different even less often statis tically significantly different frontier use measure risk make variance still acceptable even case convenient measure risk fundamental limitation mean variance efficiency point michaud serious problem practical application mean mean small change input often lead large change optimize portfolio another problem mean variance optimize portfolio make investment sense investment value data analysis dow jones euro stoxx monthly return data february september download thomson financial datastream name data set include altogether month data constituent index list september one problem data set index constituent list back early stock whose historical data partially miss ing include aventis bnp paribas daimler chrysler deutsche telekom enel eni france telecom munch ruck telecom ital mobl make impossible calculate covariance matrix real number directly write matlab function call covariance use maximum available data get real number covariance matrix function work follow take two column two time series data matrix compare length available data use start point shorter one start point calculate covariance two time series code function attach even improve way calculate covariance data set still problem reliability integrity mean variance different time period thus comparable setup another data set monthly return start december end september month data available without miss value order decide data set suitable follow portfolio optimization portfolio resampling analysis first statistic analysis two data set respectively since data set cover whole bear market period past year also interest comparison descriptive statistic follow show mean measure location standard deviation measure dispersion two data set respectively represent monthly return data set february september monthly return data set december september data analysis descriptive statistic titel mean mean std std abn amro hold aegon ahold kon air liquide alcatel allianz xet generali aventis axa basf xet bayer xet continued next page continued previous page titel mean mean std std bbv argentaria santander ctl hispano bnp paribas carrefour daimlerchrysler xet deutsche bank xet deutsche telekom xet xet endesa enel eni fortis am france telecom danone societe generale iberdrola ing groep cert oreal lafarge lvmh munch ruck xet nokia philip eltn kon repsol ypf continued next page continued previous page titel mean mean std std royal dutch ptl rwe xet saint gobain san paolo imi sanofi synthelabo siemens xet suez telecom italia telefonica telecom ital mobl total sa unicredito italiano unilever cert vivendi universal volkswagen xet order make comparison two data set clearer make graphic mean standard deviation constituent see mean return data set date february september generally high data set date december september standard deviation data set generally low data set coherent fact start world capital market experienced volatile bear market since interquartile range robust outlier measure dispersion show two boxplots data set data set make comparison volatility among single title obvious see period nokia telecomitalia francetelecom alcatel philip eltn kon relatively wide dispersion broader interquar tile range enel air liquide total sa basf relatively low level dispersion narrow terquartiel range see period dex component alcatel extremely wide dispersion follow france telecom siemens deutsche telekom nokia unicredito italiano enel iberdrola bnp paribas repsol ypf relative low level dispersion result coherent fact telecommunication stock perform volatile last four year normal distribution test simulation asset return need know correspond distribution whether reasonable suppose return normal distribute chosen lilliefors goodness fit normal distribution test lilliefors test evaluates null hypothesis input data vector population normal distribution unspecified mean variance alternative population normal distribution test compare empirical distribution normal distribution mean variance parameter normal distribution estimate rather specify advance formulate mathematical way test sample distribution sample size theoretical distribution xxots xxots xxots xxots nosirapmoc nosirapmoc noitaived rebmun rebmun naem dradnats stes tessa tessa atad stes owt atad owt dts snruter naem mean standard deviation comparison maertsatad nruter ylhtnom laicnanif rebmun ot xxots nosmoht tessa rof morf ecruos stolpxob atad snruter boxplot data set maertsatad nruter ylhtnom laicnanif rebmun ot xxots nosmoht tessa rof morf ecruos stolpxob atad snruter boxplot data set estimate mean variance sample test statistic max max big absolute vertical distance empirical hypothetical distribution function null hypothesis distribution function depends determine test statistic consider empirical discrete distribution function stair function distance therefore calculate low also upper jump point show max xi max xi max coherent hypothetical distribution distance small randomly decide test statistic lillefors critical quantile value normal distribution null hypothesis reject significance level lillefors critical value significant level result hypothesis test reject hypothesis normal distribution reject hypothesis reject hypothesis test significant percent level parameter also include test result value test obtain linear interpolation set create lilliefors lstat value test statistic cv critical value determine whether reject null hypothesis value lstat outside range lilliefors return nan indicates whether reject hypothesis result show data set stock reject hypothesis normal distribution percent significant level stock lilliefors test reject normal distribution hypothesis percent significant level data set result even well show normal distribution hypothesis reject stock percent significant level base test result decide use normal distribution simulate stock return portfolio resampling part lilliefors goodness fit normal distribution test data set titel lstat cv abn amro hold aegon ahold kon nan air liquide nan alcatel allianz xet nan generali nan aventis axa basf xet nan bayer xet nan bbv argentaria nan santander ctl hispano nan bnp paribas carrefour nan continued next page continued previous page titel lstat cv daimlerchrysler xet nan deutsche bank xet deutsche telekom xet xet endesa nan enel eni nan fortis am nan france telecom nan danone nan societe generale iberdrola nan ing groep cert oreal lafarge nan lvmh munch ruck xet nokia nan philip eltn kon nan repsol ypf nan royal dutch ptl nan rwe xet nan saint gobain nan san paolo imi continued next page continued previous page titel lstat cv sanofi synthelabo nan siemens xet suez telecom italia nan telefonica telecom ital mobl nan total sa nan unicredito italiano nan unilever cert nan vivendi universal nan volkswagen xet nan sum lilliefors goodness fit normal distribution test data set titel lstat cv abn amro hold nan aegon nan ahold kon air liquide nan alcatel allianz xet generali aventis nan continued next page continued previous page titel lstat cv axa basf xet nan bayer xet nan bbv argentaria nan santander ctl hispano bnp paribas carrefour nan daimlerchrysler xet nan deutsche bank xet nan deutsche telekom xet xet nan endesa enel eni fortis am france telecom nan danone nan societe generale iberdrola nan ing groep cert oreal lafarge nan lvmh nan munch ruck xet continued next page continued previous page titel lstat cv nokia nan philip eltn kon nan repsol ypf nan royal dutch ptl nan rwe xet nan saint gobain nan san paolo imi nan sanofi synthelabo nan siemens xet nan suez telecom italia nan telefonica nan telecom ital mobl nan total sa nan unicredito italiano nan unilever cert nan vivendi universal nan volkswagen xet sum resampled efficient frontier estimation error estimation error definition estimation error define difference estimate distribution theimpact estimation error portfolio optimization could serious point scherer portfolio optimization suffers error maximization optimizer tends pick asset attractive feature high return low risk correlation tends short deselect bad feature exactly case estimation error likely high thequadratic whichtheyarenot return well within measurement error exactly reason mean variance optimize portfolio suffer instability ambiguity monte carlo measure call portfolio resampling use illustrate effect estimation error work like suppose get true distribution parameter covariance matrix mean return vector generate random sample base distribution observation original sample repeat procedure time time get new set optimization input go input calculate new efficient frontier represent efficient portfolio correspond allocation vector use set allocation vector back original variance covariance matrix mean return vector get new efficient frontier plot original efficient frontier weight vector optimal optimal result resampling procedure estimation error input parameter transform uncertainty optimal weight vector visualise estimation error variance mean variance alone mean alone input data portfolio resampling include partial covariance matrix mean return vector constituent stoxx partial covariance matrix data set titel mean abn amro hold aegon ahold kon ai liquide alcatel allianz xet generali aventis axa basf xet continued next page continued previous page titel mean bayer xet bbv argentaria santander ctl hispano bnp paribas carrefour daimlerchrysler xet deutsche bank xet deutsche telekom xet xet endesa enel eni fortis am france telecom danone societe generale iberdrola ing groep cert oreal lafarge lvmh munch ruck xet nokia philip eltn kon repsol ypf royal dutch ptl rwe xet saint gobain san paolo imi sanofi synthelabo continued next page continued previous page titel mean siemens xet suez telecom italia telefonica telecom ital mobl total sa unicredito italiano unilever cert vivendi universal volkswagen xet show estimation error effect variance mean discuss scherer problem get bad number asset rise crease chance outlier simulated mean variance efficient frontier necessarily consistent efficient frontier intuition may monotonically increase expect return increase risk case since weight vector optimal simulated input parameter optimal original input parameter also distinguish impact uncertainty due estimation error mean due estimation error variance measure estimation error mean resample still original covariance matrix mean vector optimize resampled mean original covariance matrix result show measure estimation error variance opposite optimize resampled covariance matrix original mean vector effect show notice dispersion risk return point considerably reduce timation error confine variance small estimation error mean visualize estimation error nruter egareva dezilaunna estimation error effect annualized return standard deviation visualize estimation error mean nruter egareva dezilaunna annualized return standard deviation estimation error cause mean cause efficient frontier shift considerably resampled efficient frontier michaud methodology point earlier section quadratic program optimization algo rithm sensitive quality input parameter result maximizes estimation error problem resampled efficiency new concept introduce visualize estimation error variance nruter egareva dezilaunna annualized return standard deviation estimation error cause variance asset management world michaud dealt estimation error problem portfolio resampled frontier compose asset weight vector level portfolio return procedure guaranty average weight vector still sum one procedure economic justification resampled efficient portfolio mean variance efficient definition procedure summarize follow first run standard mean variance optimization efficient frontier com pose portfolio vary minimum variance maximum return portfolio divide difference minimum maximum return rank resampled weight portfolio rank portfolio number along frontier give resampled im denotes weight vector mth portfolio along frontier im ith resampling step estimate variance covariance matrix mean vector histor ical input alternatively input prespecified step resample use input create step take draw input distribution number draw reflect degree uncertainty input calculate new variance covariance matrix sample series estimation error result different variance covariance matrix mean vector step mean variance efficient frontier resampled frontier mv efficient frontier resampled efficient frontier nruter egareva dezilaunna annualized return standard deviation resampled frontier michaud method step calculate efficient frontier input derive step record optimal portfolio weight equally distribute return point along frontier step repeat step many time calculate average portfolio weight return point evaluate frontier average portfolio variance covariance matrix step plot resampled frontier improve resampled frontier show mean variance efficient frontier resampled frontier base data set curve resampled frontier remarkably short compare mean variance efficient frontier especially high return area point resampled portfolio consider carefully see two explanation one due number asset case number asset increase timation error problem get bad show mean resampled frontier get less efficient even away mean variance ficient frontier second reason probably main reason due methodology want get return level comparable resampled frontier opinion take average resampled portfolio weight whose cor respond resampled return transpose weight vector multiply original mean return vector belongs return rank average resampled portfolio weight whose simulated portfolio return transpose weight vector mul tiply simulated mean return vector belongs rank actually michaud method get resampled frontier surprising see extremely shorten resampled frontier due average different level portfolio return redid resampled frontier method data set show resampled frontier much comparable mean variance efficient frontier interest compare two graphic base data set efficient frontier annualized return range annualized standard deviation range base data set efficient frontier annualized return range annualized standard deviation range clearly low return mean variance efficient frontier resampled frontier mv efficient frontier resampled frontier nruter egareva dezilaunna annualized return standard deviation resampled frontier data set improve method mean variance efficient frontier resampled frontier mv efficient frontier resampled frontier nruter egareva dezilaunna annualized return standard deviation resampled frontier data set improve method comparable risk coherent fact data set low mean return due bear market last three year resampled frontier base data set much closer efficient fron tier maximum standard deviation distance approximately contrary resampled frontier base data set away effi cient frontier maximum standard deviation distance approximately show estimation error problem serious data set due relatively short time series pro con resampled frontier foresee resampled portfolio show high diversification asset enter solution mean variance efficient portfolio exhibit less sudden shift allocation give smooth transition return requirement change thus make desirable practitioner one thing neglect lucky draw problem resampled portfolio due average procedure one two heavy allocation one asset could influence average allocation asset greatly portfolio revision portfolio revision practical problem investment management field revision revision maximize portfolio return give curtain level portfolio risk decision almost every portfolio manager make whetheritismean varianceor resampled efficiency next step decide whether portfolio need revision efficient since portfolio need revision close efficient frontier statistically indistinguishable efficiency show earlierinfigure frontier level variability high illustrates instability ambiguity traditional mean variance optimization investment management need statistical inference procedure transform statistical equivalence region sample acceptance region control type error sample acceptance region introduce michaud intuitive way approximate sample acceptance region statistical equivalence region find area efficient frontier include average resampled portfolio pro cedure work follow divide area efficient frontier mutually exclusive column rectangle include simulated portfolio de simulated portfolio rectangle curve connection midpoint base rectangle contains approximately simulated portfolio curve curve estimate low boundary sample acceptance region test mv efficiency ac ceptance level proceeds determine whether risk return candidate acceptance region revision may require candidate portfolio outside region probably require revision show graphic resampling point data set respectively data set resampling point closer efficient frontier data set resampling point away concentrate along efficient frontier data set show sample acceptance region mean variance efficient frontier resampling point data set mv efficient frontier nruter egareva dezilaunna annualized return standard deviation resampling data set mean variance efficient frontier resampling point data set mv efficient frontier nruter egareva dezilaunna annualized return standard deviation resampling data set efficient frontier base data set data set show broad acceptance region tell whether portfolio really efficient especially high return high variance area opinion due estimation error associate big number asset data set problem bad data set sample acceptance region line stay zero mean portfolio return zero efficient need revision difference two data set perhaps data set relatively low mean return high variance also time series short make reliable estimation covariance matrix confidence region resampled portfolio reality problem often arises whether give portfolio statistically equiv alent efficient portfolio satisfies client risk objective constraint even current portfolio consistent mean variance efficiency consistent target efficient portfolio may still need revision section resampled frontier represent portfolio efficiency choice base two reason first resampled efficient portfolio sample meanvector convenient second compare mean variance efficiency resampled efficiency practical investment value judgement efficiency portfolio base near target resampled efficient portfolio distance function require define confidence region suppose weight vector test portfolio weight vector target resampled efficient portfolio covariance matrix historic return test statistic distance portfolio define mean variance efficient frontier sample acceptance region mv efficient frontier sample acceptance region sample acceptance region sample acceptance region nruter egareva dezilaunna annualized return standard deviation sample acceptance region data set mean variance efficient frontier sample acceptance region mv efficient frontier sample acceptance region sample acceptance region sample acceptance region nruter egareva dezilaunna annualized return standard deviation sample acceptance region data set relative variance simulation procedure use find constant test statistic confidence level choose equal weight portfolio variance start point find portfolio weight resampled efficient frontier variance target portfolio weight calculate value one problem methodology risk level resampled efficient portfolio dramatically affect shape confidence region low risk level denser compacter confidence region foresee simulation graphic empirical study portfolio revision section would like empirical study portfolio revision give certain portfolio efficiency judgement rule base euro stoxx historical data would like calculate portfolio performance compare result among different rule study compose six part forecasting process simulation resampling process find sample acceptance region find resampled frontier portfolio revision performance calculation comparison periodically fund manager make forecast next period asset return make portfolio revision decision accordingly correlation forecast ex post result quite low around monthly basis use simple linear equation generate next period forecast forecast return normal distribute random number standard deviation mean equal correspond time series forecasting process course improve later data simulation process use generate normal distribute time series mean standard deviation length historical plus forecast next period data estimate parameter simulated data set mean variance optimization use optimal weight vector back original parameter resampled data set process repeat time resampled data set could find sample acceptance region michaud method mention also resampled frontier em pirical study use resampled frontier instead mean variance efficient frontier portfolio revision due desirable nature resampled frontier practical us mention portfolio outside sample acceptance region next step revision try find weight vector portfolio resampled frontier variance portfolio revise last step performance calculate multiply asset historical monthly return period asset weight get period portfolio return cost value deduct correspond return period finally add period return calculate cumulative product find month portfolio return procedure repeat time try find performance portfolio october september unfortunately even use sample acceptance region portfolio revise run five time use sample acceptance region result actually foresee revision rule make portfolio really need revision give sample acceptance region give comparison programm code anyway include frame work still usefully improve efficiency test rule conclusion although portfolio efficiency test procedure intuitive due large dispersion data difficult reject null hypothesis portfolio efficient whether portfolio statistically equivalent efficient portfolio portfolio equivalent target portfolio power test therefore low unfortunately use practice opinion matlab program code covariance matrix nan entry function covm covariance original data array include nan function utilize maximum available data caculate covariance matrix col size cova zero col col col col compare sum isnan sum isnan cov cov max compare end max compare end cova cov end end covm cova cova diag diag cova statistic analysis load return dat load return dat descriptive statistic meana nanmean meanb mean iqra iqr iqrb iqr stda nanstd stdb std output meana meanb stda stdb iqra iqb graphical description boxplot boxplot boxplot mean std plot subplot plot meana meanb legend stoxx stoxx title two data set mean comparison fontsize xlabel asset number ylabel mean return subplot plot stda stdb legend stoxx stoxx title two data set standard deviation comparison fontsize xlabel asset number ylabel std normality test lilifors normality test lillietest result end lillietest result end optimization load return dat meanb mean stdb std covb cov maxb max meanb minb min meanb option optimset largescale without none negative weight constraint minb maxb minb maxb fval quadprog covb zero meanb one result fval end find result min result result sqrt result result sqrt stdb meanb plot single asset point add graphic title mean variance efficient frontier fontsize xlabel annualized return standard deviation ylabel annualized average return none negative weight constraint minb maxb minb maxb fval quadprog covb zero meanb one zero one option result fval end find result min result result sqrt result result sqrt stdb meanb plot title mean variance efficient frontier fontsize xlabel annualized return standard deviation ylabel annualized average return track error optimization weight constraint formulized result minb maxb minb maxb fval quadprog covb zero meanb one weight result fval end find result min result result result result plot title track error efficient frontier fontsize xlabel annualized track error ylabel annualized active return estimation error load return dat meanb mean covb cov stdb std maxb max meanb minb min meanb option optimset largescale calculate efficient frontier minb maxb minb maxb fval quadprog covb zero meanb one zero one option result fval end find result min result result sqrt result result efb save efb estimation error data generate total sim one meanb randn one stdb mean mean sim covs cov sim max max mean min min mean result minb maxb minb maxb fval quadprog covs zero meanb one zero one option change covs covb mean meanb find estimation error effect mean variance respectively fval covb meanb result fval end find result min result result rowend size total total rowend rowend size result result end sqrt total total plot single asset point add graphic title visualize estimation error fontsize xlabel annualized return standard deviation ylabel annualized average return simulation load return dat meana nanmean stda nanstd cova covariance maxa max meana mina min meana option optimset largescale efficient frontier generate base parameter data set none negative weight constraint mina maxa mina maxa fval quadprog cova zero meana one zero one option fval end delete inefficient data point find min annualize data sqrt save efdataa simulation process sim one size meana randn size one size stda mean mean sim covs cov sim max max mean min min mean min max min max quadprog covs zero mean one zero one option weight return meana variance cova end delete inefficient data point find variance min variance variance return weight size return end save simulationa sample acceptance region load simulationa mat low high standard deviation efficient frontier minv sqrt min maxv sqrt max variance sqrt variance minv maxv minv maxv size variance variance variance maxv minv return end end isempty prctile prctile prctile end end minv maxv minv maxv minv maxv minv maxv minv maxv minv maxv add oringinal simulation point variance return draw graphic sample acceptance line plot legend mv efficient frontier sample acceptance region sample acceptance region sample acceptance region title mean variance efficient frontier sample acceptance region fontsize xlabel annualized return standard deviation ylabel annualized average return resampling michaud method load variable resampling michaud method total zero sim one meanb randn one stdb mean mean sim covs cov sim weight minb maxb minb maxb fval quadprog covs zero mean one zero one option weight end weight end fval covb meanb result fval end find result min result result sqrt result result draw graphic plot legend mv efficient frontier resampled efficient frontier title mean variance efficient frontier resampled efficient frontier fontsize xlabel annualized return standard deviation ylabel annualized average return improve method load simulationa resampling method minr min return maxr max return zero minr maxr minr maxr size return return return maxr minr weight end end take average fval cova meana result fval end delete inefficient data point find result min result result sqrt result result draw graphic plot legend mv efficient frontier resampled frontier title mean variance efficient frontier resampled frontier fontsize xlabel annualized return standard deviation ylabel annualized average return save resamplea revision load return dat wp one forecasting monthly return stdh nanstd forecast select randn stdh forecasting process improve later fore fore forecast meanf nanmean fore minf min meanf maxf max meanf covf covariance fore stdf nanstd fore location wp covf wp simulation process find sample acceptance region weight return variance sim one meanf randn one stdf mean mean sim covs cov sim max max mean min min mean min max min max quadprog covs zero mean one zero one weight simulated portfolio weight vector return meanf simulated portfolio return variance covf simulated portfolio variance end delete inefficient data point find variance min variance return variance weight size return end find sample acceptance region minv min variance maxv max variance size variance location maxv minv variance variance location maxv minv bandwidth change return end end isempty prctile else weighte wp delta weight ab weighte wp continue end decide whether portfolio outside sample acceptance region need revision meanf wp weighte wp delta weight ab weighte wp continue end find variance portfolio resampled frontier minr min return maxr max return weight minr maxr minr maxr zero size return return return maxr minr weight end end weight fval weight covf weight meanf weight fval end find min weight find correspond weight vector resampled portfolio size wp covf wp wp covf wp weighte weight end end size weighte weighte weight end delta weight ab weighte wp wp weighte end portfolio performance calculation rp cumprod diag weighte sum delta weight confidence region load resamplea wp one minr min return maxr max return location wp cova wp interp result result location zero size return return return maxr minr weight end end take average size weight constant weight cova weight end prctile constant bibliography fabozzi gupta markowitz legacy modern portfolio theory journal invest grinold kahn active portfolio management mcgraw hill markowitz portfolio selection journal finance vii michaud efficient asset management harvard business school press nardon absolute relative optimisation roll mean variance analysis track error journal portfolio management onz computergestu tzte statistik scherer portfolio construction risk budgeting risk book
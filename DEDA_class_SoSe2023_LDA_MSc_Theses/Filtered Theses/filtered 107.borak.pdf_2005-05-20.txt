implementation dynamic semiparametric factor model imply volatility abschlussarbeit zur erlangung de akademischen grade master science sc im masterstudiengang statistik der fakult universit zu von szymon borak geboren wroc law gutachter prof dr wolfgang ardle prof dr bernd onz eingereicht may implementation dynamic semiparametric factor model imply volatility master thesis present szymon borak prof dr wolfgang ardle case center apply statistic economics partial fulfillment requirement degree master science may declaration authorship hereby confirm author master thesis independently without use others indicate resource passage literally gen eral matter take publication resource marked szymon borak may dynamic semiparametric factor model dsfm convenient tool analysis imply volatility surfice iv offer dimension reduction iv dsfm parameter complex procedure since require huge number obser vation model master thesis discus implementation issue dsfm describe key fea xplore keywords impliedvolatility optionpricing content introduction imply volatility black scholes formula imply volatility alternative financial model merton model heston model bates model local volatility model model imply volatility dynamic pca moneyness pca term structure dynamic factor model dynamic semiparametric factor model model formulation estimation orthogonalization model selection local bandwidth initial parameter selection content implementation issue numerical algorithm lu decomposition eigensystems numerical difficulty dsfm xplore implementation efficiency algorithm application data estimation result bandwidth selection model selection initial parameter dependence simulated example hedge exotic option bibliography list iv tick january th data design january th iv string january th point january th cross imply volatility surface heston model imply volatility surface bates model left panel pool observation january th march th large point hypothetical grid point rightpanel panel neighborhood point marked rectangle time series loading time series loading invariant basis function dynamic basis function comparison fit obtain dsfm nadaraya watson timator january th left panel nw iv fit january th right panel dsfm fit january th overall density observation list local bandwidth use model estimation function time series loading left panel simulated time series right panel estimate time series leftpanels true function right panel estimate function second third basis function left panel true function right panel estimate function notation abbreviation strike price cko price call knock option price plain vanilla call option moneyness time maturity exploratory variable contain moneyness time maturity observe log imply volatility basis function bi load time series martingale measure market measure imply volatility cumulative distribution function standard normal variable asset price process wiener process compound poisson process black scholes dsfm dynamic semiparametric factor model iv imply volatility iv imply volatility surface lv local volatility lvs local volatility surface pde partial differential equation pca principal component analysis hp hedge portfolio introduction economic model problem tradeoff complex model simple one arises often one hand complex model analyze many aspect may lead infeasible model despite good fitting ability apply hand simple model miss important feature deviate much reality recently model complex due development computation technology one may handle great quantity high dimensional data analyze several aspect simultaneously however optimal implementation still key issue modern quantitative finance one handle great quantity dimen sional data simple model always explain stylize fact arise form analysis data therefore complex model approach still feasible constantly propose standard example imply volatility iv daily intra day level one may observe many option trade result rich structure neglect structure like black scholes model may lead pure forecasting performance hand detailed analysis induce complex model application thesis discus implementation dynamic semiparemetric factor model dsfm focus particular application support enough complexity easily tractable however tractability model one need still efficient estimation procedure thesis discus implementation issue also extend functionality statistical package xplore support convenient way handle model thesis organize follow chapter overview financial model iv present present popular model define iv concept chapter focus present dsfm formulate model present estimation sissues inchapter present part recall numerical algorithm discus implementation introduction problem chapter hedge present believe due optimal implementation application efficiently study future work imply volatility recently imply volatility iv become popular among practitioner quote option price due simplicity give easy way compare price option black scholes formula one recognizable result theivconcept however assumption model constant attempt try remove chapter focus different aspect iv model first present formula pricing european plain vanilla option introduce concept imply volatility discus empirical fact option market confirm assumption model section section model consistent non flat imply volatility surface present last section focus model try catch dynamic behavior iv black scholes formula work black scholes one recognize result quanti tative finance present model assumes continuous trading time horizon probability space filtration define wiener process price tradable asset stochastic process give stochastic differential equation dt dw constant drift volatility parameter describes trend price evolution intensity random deviation trend cause vibration price due eg temporary imbalance supply demand stock market transaction cost assume buying short sell possible quantity asset always possible exist imply volatility also money market equal rate borrowing lending continuous compound interest rate lead price zero coupon bond time pay one unit time give rt term structure interest rate flat constant time horizon ito formula one transform price process exp become feasible framework black scholes derive price european plain vanilla option option financial contract yield certain payment de pending price underlie asset specific time simplest option plain vanilla call option payment give max option pay unit price asset great certain level call strike price contract pay max thetime payment maturity time maturity current time point main result black scholes price option non arbitrage methodology apply two strategy give payment time value time formal mathematical language require discount price process rts martingale girsanov theorem say exists measure equivalent process imply volatility wq wiener process new arbitrage free probability measure discount price process rts becomes martingale de rts rts dwq dynamic asset give dt dwq use substitute density function give price calculate since log normal distribution since measure unique model give price call option ke lnst cumulative distribution function standard normal variable put option price calculate put call parity ke five parameter option price grouped three category firstly may directly obtain market data course plethora possible choice since constant time risk free interest rate reveals flat term structure exist practice secondly specify option contract fix number change deterministically finally isnot observable specify volatility parameter estimate historical price reflect variability asset price big uncertainty possible asset price change high call option price call option price increase function exist one one mapping option price volatility imply volatility imply volatility grow financial market derivative market establish plain vanilla option become regularly trade instrument one may trade parallel many contract different specification strike price time maturity mean many option price observe time since contains one quantity observe call option increase function volatility uniquely calculate invert formula value match observe option price call imply volatility iv although exists direct formula calculate iv marketdata surface day give mapping strike time maturity bt call imply volatility surface iv note although iv define positive strike maturity observe finite number point convenient way present iv rewrite function moneyness time maturity moneyness generally define increase function consider iv function moneyness time maturity bt follow fengler set moneyness forward future moneyness possible choice discuss hafner er st thisassumption would equivalent flat iv change time however empirical finding show iv reveals non flat profile across moneyness call smile smirk across time maturity present typical iv observe january th smile different maturity also visible iv observe limited number point due institutional convention option market one time several maturity trade iv form typical string common time maturity different strike moneyness string structure even well observe imply volatility iv tick iv tick january th dimensional data project time maturity moneyness plane one may observe near expiry exist string range great maturity tion expiry see move also change randomly shape effect make model iv iv complex challenge problem alternative financial model section present assumption model derives price eu ropean call option section show empirical fact contradict assumption imply volatility data design ytirutam ot emit moneyness data design january th ity inaccuracy standard example pricing exotic option take market different lead different price overcome problem non flat iv complex financial model consider assume differ ent stochastic behavior underlie among many model section present three particular model merton jump diffusion model heston stochastic volatility model bates stochastic volatility jump model merton model important piece information company becomes public may cause sudden change company stock price information usually come impactonthe variable discontinuous trajectory asset price model extends add jump imply volatility string shift ytirutam ot emit moneyness iv string january th point january th cross stock price dynamic rdt dw dz compound poisson process log normal distribution jump size jump follow homogeneous poisson process intensity independent log jump size random variable mean variance independent model becomes incomplete mean many possible way choose risk neutral measure discount price process martingale merton propose change drift wiener process leave ingredient unchanged asset price dynamic give imply volatility imply volatility surface merton model xnt exp mt exp return distribution increase add mass tail negative positive implies relatively mass left right tail generate non constant iv iv obtain model present imply volatility imply volatility surface heston model heston model stochastic process lead call stochastic volatility model price dynamic driven rdt dw another unobservable stochastic process many possible way choose variance process hull white propose use geometric brownian motion dv dt dw however geometric brownian motion tends increase exponentially un desirable property volatility volatility exhibit rather mean revert behavior imply volatility therefore model base ornstein uhlenbeck type process dv dt dw suggest stein stein process however admits negative value variance rdt dw dv dt dw two brownian component correlate rate cov dw dw dt term equation simply ensures positive volatility process touch zero bound stochastic part becomes zero non stochastic part push parameter measure speed mean reversion average level volatility thecorrelation istypicallynegative know leverage effect empirical study financial return confirm volatility negatively correlate return risk neutral dynamic give similar way model logarithm asset price process ln one obtains equation dx dt dw present non constant iv generate heston model arbitrary chosen parameter imply volatility imply volatility surface bates model bates model merton heston approach combine bates propose model stochastic volatility jump rdt dw dz dv dt dw cov dw dw dt compound poisson process intensity log normal distri andw ifj ln ln risk neutral probability one imply volatility obtains equation logarithm asset price dx dt dw wherez similarly merton heston model bates model also yield non constant iv theivsmostprecisely ofthe parameter model discuss borak local volatility model model previous section modify dynamic asset impose another degree freedom like jump stochastic process volatility sim ilarly model option price depend unknown parameter however number parameter great one allows reproduce non flat iv another possibility model non constant volatility surface give call local volatility model lv asset price follow equation dt dw andtimet thefunction lvs give mapping strength lv model ability yield smile consistent option price give dupire follow way ct rkct ct advantage fast pricing algorithm get price model generalize partial differential equation pde rk imply volatility however give solution fast simultaneously yield vanilla option price different strike different maturity model imply volatility dynamic drawback sophisticated model failure correctly describe dynamic iv infer frequent recalibration model therefore model study dynamic behavior iv propose model dynamic iv one face problem high complexity iv data one day simultaneously several maturity level moneyness areobserved dimensional pca whichisa system playacrucialrole surface section skim dynamic model iv offer low dimensional moneyness pca term structure model extract two dimensional functional factor pca moneyness string structure iv data result problem unification ob servations time maturity today specific option time maturity option tomorrow analysis iv moneyness time maturity characteristic lead even complex structure may result lack sufficient number data since option one month maturity appear next time one month time overcome problem skiadopoulos propose group iv bucket similar moneyness time maturity moneyness space divide subintervals similarly time maturity split subintervals observation belongs one class pca perform maturity bucket smile represent multivariate observation coordinate observe iv range imply volatility variance similar procedure may redone whole iv big maturity however observation miss drastic enlargement bucket may necessary may however influence explanatory power model since important feature iv dynamic could lose order obtain multivariate observation specific time maturity mon eyness one may smooth data grid approach prosed fengler maturity pca perform multivariate observation coordinate instead iv log return analyze well dynamic whole iv fengler propose common pca covariance matrix maturity decompose matrix eigenvectors diagonal matrix contain eigenvalue matrix assume constant maturity difference give pca term structure extract single observation term structure fix moneyness one need face problem move string standard approach consider fix maturity eg etc calculate iv linear interpolation observe iv string avellaneda zhu propose pca model term structure fx op tions term structure reconstruct specify maturity observation time covariance matrix pca construct data alsofromlog return avellanedaandzhu analyzethematrixs define log log log log bt bt bt bt log return exclude negative volatility show stationary behavior af ter obtain statistically uncorrelated principal component log return imply volatility model xn log log pc bt bt lead iv term structure model exp xn pc bt bt wherew isthei component fengler perform pca atm option similarly approach section common pca employ recover structure whole iv dynamic factor model iv dynamic dynamic whole iv described common pca since slice moneyness term structure exhibit similar behavior another approach lead two dimensional functional factor iv decompose small number surface operate moneyness time maturity plane functional pca approach present cont da fonseca first ivsestimates nw bt log return surface log nw nw nw calculate bt bt bt karhunen lo eve decomposition generalization pca high dimensional random field apply log nw result one obtains dynamic bt model iv exp bt time dependent loading two dimensional factor function initial iv denote imply volatility model present nonparametric estimation apply afterwards dimension reduction estimate give however one may proceed counter order hafner propose first reduce dimension small number factor function fit model function model purely parametric since function estimate give priori fit do least square minimization propose function log log log log log log log model iv dynamic regression form bt empirical analysis find stable strong relation also factor load substitute option dax hafner estimate linear regression thus model rewrite four factor model log log log log log bt dynamic semiparametric factor model iv disregard specific string structure non observable maturity fit particular day regardless observation day approach however may miss important feature iv dynamic design offer flexible model fitting dimension reduction explanation dynamic behavior chapter focus present dsfm first formulate model afterwards estimation procedure described detail section show final solution select many equivalent solution section present criterion select size model bandwidth section discus problem arise estimation procedure due degenerate data design model formulation dsfm belongs class model present section iv estimate factor function fit surface let log imply volatility observe particular day index number day total number day denote index represent intra day trade day number trade day let two dimensional variable contain moneyness maturity among many moneyness setting define ki fti strike underlie future price time dsfm regress ti dynamic semiparametric factor model invariant basis function dynamic basis func tions factor weight depend time estimation estimate bi obtain minimize follow least square bl criterion xi xji xl bi lm bl du wherek denotestwo dimension kernel product one dimension kernel bandwidth one dimensional kernel function minimization procedure search function bl time series bi procedure reduce nadaraya watson estimate base pool sample day would neglect dynamic structure yield one estimate day additionally sample length limited one day simply nadaraya watson estimate iv particular day obtain calculate estimate iterative procedure apply first introduce follow notation xji bi xji bi dynamic semiparametric factor model denote lr estimate basis function factor loading day iteration replace function arbitrary function take derivative bl bl respect one obtains xi xji xl bi lm bl bi du xi xji xl bi lm bl bi bi gk du since minimum obtain function integral xi xji xl bi lm bl bi rearrange term plug yield bi bi bi bi lp bi bl fact set equation define matrix vector element bi bi thus equivalent yield estimate th iteration dynamic semiparametric factor model similar idea apply update replace bi bi take derivative respect yield xji xl bi lm bl bl du lead bi bl du bi bi bl bl du formula system equation define matrix vector element du bi bl bl du du bi bl bi bl estimate thus give solve algorithm stop minor change occur lr bl du small obviously one need set initial value order start algorithm orthogonalization estimate basis function uniquely define bl replace function span affine space define dynamic semiparametric factor model pi matrix element bi du bl bl estimate replace new function mnew mnew mnew bl mnew mnew space bi bi bi need substitute inew bi vector du bl next step choose orthogonal basis achieve explanation partial sum pi maximal one proceed pca first define matrix bi bi eigenvectors replace bnew bi inew bi orthonormal basis chosen pi maximal give bl bi quantity pi maximal forth model selection choice model size residual sum square calculate ip pl bi lm bl rv overall mean observation one may increase parameter explain variance rv sufficiently high however model dynamic semiparametric factor model fit dynamic function new fit size require repeat almost entire procedure data driven choice bandwidth take like fengler weight aic weight function one need minimize bi lm bl respect bandwidth equivalent minimize xl bi lm bl exp du aic computationally easy criterion du bi lm bl exp aic du since distribution data unequal weight function give great weight region data sparse one possible selection two criterion pb xl bi lm bl exp aic du xl bi lm bl exp aic du measure design set dynamic semiparametric factor model data design ytirutam moneyness leftpanel th tomarch th large point hypothetical grid point basis func tions evaluate right panel magnification left panel neighborhood point marked rectangle local bandwidth derivative market one observe fairly many different type option contract day one may trade option several different time maturity many differentstrikes ber maturity result string structure moreover contract small maturity trade intensively tend exist contract small time maturity difference two successive ex piry day one month next maturity range increase three month since string move maturity moneyness plane towards expiry one need pool many day order fill plane observation however due unequal distribution data point one need even day fill range maturity range gap may obstruct estimation procedure point function obviously matrix contains singular mean one may estimate successfully value iv point problem gap illustrate left panel present pool obser vation january th march th large point hypothetical dynamic semiparametric factor model grid point clearly visible point equally surround data right panel magnification problematic grid point displayed particular grid point observation neighborhood singular natural solution problem increase bandwidth however may result large bias another possibility use near neighbor estimator range many data however one take consideration observation closest grid point hand range wepropose different approach cope degenerate design instead fix bandwidth one may take local bandwidth vary accord data density yield small smooth parameter range many data big one data sparse xji bi xji bi choice local bandwidth motivate motivate approach gijbels mammen first choose fix pilot bandwidth minimize plug local bandwidth accord density data minp minp maxp max minp maxp minimum maximum value desire estimationgrid obtain pilot estimation mode density data minp minp minp minp maxp maxp maxp local bandwidth equal pilot bandwidth local bandwidth increase inverse data density small density value reach minp minp minp minp maxp maxp dynamic semiparametric factor model theparameter itcould also control bound bandwidth impose max initial parameter selection problem gap data handle size band width course obligatory need non zero least one bi however sufficient condition ensure non singularity matrix initial estimate play also important role fengler piecewise constant initial time series propose sl subintervals pairwise disjoint subset strict subset initial estimate define complete set subset need exist least one day otherwise bi row zero appear small length interval big bandwidth need take deficiency remove take random initial time series need non zero one bi longer necessary non zero one bi implementation issue main aim model use dsfm approximate iv low dimensional representation one face problem high complexity data structure consider great quantity observation particular day even daily level approximately observation intra day level number observation rise per day additionally order reflect dynamic whole iv model need estimate sufficiently large time interval fact cause number observation increase even order cope efficiently huge amount data optimal implementation important speed algorithm may highly dependent proper order calculation double calculation quantity avoid may significantly slow estimation procedure forefficientdsfm simplementation insection section do part thesis section present efficiency study algorithm throughout chapter keep notation number observe day lengthofthe bl timeseries wealsosetm onwhich function evaluate bl numerical algorithm section present numerical algorithm use estimation ofthedsfm detailed description refer press implementation issue lu decomposition obviouslyforeach gridpointu solve separately similarly time point one need solve order bi dimensional iteration update one need solve linear system numerical challenge among many method solve linear system equation lu decomposition give fast accurate approximation solution matrix give product two matrix lu low triangular nonzero element diagonal upper triangular nonzero element diagonal lu decomposition element matrix give nn nn mn obtain decomposition solution linear set straightforward one may rearrange follow way ax lux ux ly unknown know vector first ly solve afterwards ux canbeeasily obtain forward backward substitution implementation issue estimation dsfm matrix vector unknown vector either estimate loading time estimate basis function particular point remain challenge calculate matrix element matrix give sum element kj kn nj kj result equation unknown nonzero element unknown specify arbitrarily natural choice would press specify diagonal let jj equation write follow note equation left side exist one number appear previous equation mean system solve sequen tially first set calculate since diagonal set value need kept memory lu decomposition remember one matrix nn implementation issue eigensystems calculation inverse symmetric matrix also calculation require power symmetric matrix obtain jordan decomposition diagonal matrix consist eigenvalue orthogonal matrix eigenvectors power matrix give power diagonal matrix define power matrix element wefollow order complex faster method like qr use since jacobi matrix order typically small believe choice method affect significantly speed whole estimation jacobi method base sequence orthogonal transformation rotation matrix form pq pq denote sine cosine rotation angle element diagonal element zero except element diagonal one except row column diagonal matrix obtain transformation sequence rotation matrix ap av implementation issue sequence rotation matrix since orthogonal product orthogonal matrix jordan decomposition give transformation change row similarly ap change pq pq column pp pq pn qp qq qn np nq sequence rotation matrix arrange new matrix ap pq pq zero column row column row order pq qp calculate element first set aqq app sg cosine apq sine respectively tc let element change give ta pp pp pq ta qq qq pq rp rp rp rp rq rq rp rq implementation issue note element annihilate orthogonal pq tion one apply rotationto allelements andthenrepeat whole procedure set rotation element matrix call sweep sweep need repeatedcouple oftimes untilthe diagonalmatrix sufficiently small numerical zero sweep sweep really important propose press proceed row etc numerical difficulty dsfm section consider algorithm solve numerically problem arise dsfm estimation problem appear elementary calculation day data elementary calculation arrange optimally order save appear dsfm estimation bi andl function bl obtain basis factor function represent finite grid obviously may cover whole desire estimation space grid set range interest begin estimation procedure one rememberl functionsonm obviously time series length bi kept constantly memory well denotedasx andy andq bi bi andy canbefreed numbersbutmostly significantly small amount memory necessary keep whole data calculate could use estimation different bi bi also reuse estimation another time period include part old one believe slide window type analysis feasible dsfm one simply remove memory replace rest stay unfortunately change bi bi bandwidth require recalculation bi bi except keep memory one may also remember bi bi ibi ibi iteration step quantity compute many time grid point time point implementation issue since product appear grid point landeachgridpoint bl bl optimize integral du bi bl bl calculate numerically approximate appropriate sum function value give grid sincethematricesb andm whole matrix enough compute low triangular upper triangular part matrix simply copy element finally state except keep memory actual estimate bl estimate one previous step iteration bl need remember order stop iteration give xplore implementation section considers xplore implementation dsfm new quantlets dsfm dsfm iv implement efficient estimation although part statistical program language xplore core algorithm do external dll library order improve speed solution allows well import algorithm environment supply dll communication beta mhat dsfm rmax tol startbeta beta mhat fit dsfm iv rmax tol startbeta estimate dynamic semiparametric factor model pl form dimensional bl invariant basis function grid scalar weight dependingontimet afterestimation ized empirical norm observe data point order accord maximal variance result dsfm quantlet two matrix beta mhat obtain mhat implementation issue function give grid column third column fourthandsoon betaisi second one third one etc since always contains one need remember however form kept way simplify calculation iv xplore code give simply iv mhat sum beta col beta mhat col mhat first day sample quantlet seven different input parameter data give four column matrix first two column contains coordinate grid third column observe function value last indictor day typically date scalar denotes number dynamic basis function factor loading parameter give bandwidth kernel function either vector global bandwidth vector local bandwidth local bandwidth apply dimension dimension namely regular grid estimation perform eters rmax stay maximum number iteration default value set tol minimal tolerance estimation criterion denote default value startbeta user may set start parameter initial factor loading give locally constant start time series propose fengler use believe dfsm apply also field supply two quantlets except estimate dsfm iv also give summary data model parameter explain variance criterion output matrix aic aic fit give additionally six column contain respectively date number meanof criterion varianceof criterion mean aic aic criterion variance criterion aic aic efficiency algorithm estimation procedure described chapter consists three consequent part first value calculate iteration bi bi may additionally compute implementation issue part time percentage calculation bi bi iteration orthogonalization order model characteristic calculation joint time second need inner part estimation algo rithm main part iteration orthogonalization computa tionally intensive like remain one due fact one need operate data already pre compute character istics data order make sound present time second necessary estimation part data set use chapter actual time second highly dependent use cpu percentage bring important information surprising iteration orthog onalization part together take joint computational time slid ingwindow typeofanalysis time interval one resign calculate model characteristic application algorithm algorithm numerical issue estimation procedure discuss previous chapter chapter discus possible application dsfm limit ourself application option dax application option index different field also possible first present data set use section discus estimation result selection bandwidth choice number basis function start time series section present model performance simulated data finally present hedge application dsfm give short overview area model use believe application whichare present whichare notdiscussed data analysis employ tick statistic dax index option january february invert formula one easily obtains iv regard outlier observation iv big small also remove observation maturity less day since behavior range ir regular due expiry effect data set contains day observation approximately million contract around per day call put option violation call put parity remove hafner wallmeier correction detail refer hafner wallmeier application beta time series loading estimation result apply algorithm equidistant grid cover moneyness point apply local bandwidth number dynamic factor function set start value take piecewise constant series disjoint time interval themagnitude variance much high two time series suggests first basis function big explanatory power iv variation actually surprising since basis function order respect big variance load factor display estimate basis function find similar interpre tations factor fengler cont da fonseca first dynamic factor relatively flat almost whole range negative grid point reflect shift entire log iv small maturity strong curvature see corresponds empirical fact near expiry smile effect becomes strong second function positive small maturity negative big maturity positive increase thenega tive iv last function reveals strong slope moneyness direction change money smile curvature application beta beta time series loading dsfm fit data january th present comparison also fit obtain nadaraya watson nw kernel estimator displayed bandwidth nw estimator moneyness direction andh use dsfm selection bandwidth described section reflect dynamic iv smooth do space also time weight sum factor however always case nw estimator theupperpanelsof illustrate problem although dsfm estimate smile whole rangeofmoneyness tomakeiteven sound present estimate whole iv left panel show estimate iv nw estimator surface well define near string surface obtain dsfm cover whole consider space order remove nw deficiency one need increase bandwidth result large bias present fengler bandwidth selection forthedata first apply estimation procedure several possible bandwidth result pilot estimation present application mhat mhat mhat mhat invariant basis function dynamic basis function application fit comparison day expiry fit comparison day expiry vivi vivi nw nw dsfm dsfm moneyness moneyness fit comparison day expiry fit comparison day expiry nw nw dsfm dsfm moneyness moneyness comparison fit obtain dsfm nadaraya watson esti mator january th application nw model fit dsfm model fit left panel nw iv fit january th right panel dsfm fit january th application aic aic rv pilot bandwidth selection via aic different choice refers moneyness time maturity application phat overall density observation accordingto however aic neighborhood criterion become flat order aic aic obtain local bandwidth apply arbitrary chosen max set estimation space overall density present clearly visible big density observation money small maturity chosenbandwidths presentedinfigure function theyare relatively flat small maturity increase rapidly big maturity bandwidth increase fast maturity moneyness close reflect fact near money one may observe trade range model selection model dynamic iv dynamic function motivation choice present recalculate model bandwidth start time series dynamic basis function add th function significant influence explain variance reason limit model dynamic basis function three function application rv rv explain variance model size also consider fengler dsfm model like cont da fonseca note model one dynamic basis function explain variance initial parameter dependence apart bandwidth selection choice initial start parameter another estimation issue recalculate estimate different start value denote pc pc pc different setting piecewise constant start value described section denote also bm bm bm setting algorithm start brownian motion wn wn wn white noise andar ar ar fromar process foreachofthe different estimate basis function weight correlation matrix obtain set give element matrix either mean solution indicate start since weight perfectly correlate course correlation time series estimate factor consider identifiable sign suggest start time series significant influence estimationresults initial estimate indicate borak small bandwidth data use stability estimate respect start time series seem big big bandwidth value estimate basis function great bandwidth depend observation initial time series application local bandwidth moneyness local bandwidth maturity local bandwidth use model estimation function application pc pc pc bm bm bm wn wn wn ar ar ar pc pc pc bm bm bm wn wn wn ar ar ar pc pc pc bm bm bm wn wn wn ar ar ar correlation matrix factor loading bi obtain different initial start time series application importance random see small data set one year observation estimation procedure dsfm yield result band widthsh thematrixb simply singular enlarge bandwidth solve problem local constant weight also lead singular matrix however keep band width employ white noise provide successfully estimate simulated example section apply dsfm option data section apply model artificial generate data order check well estimation procedure reproduce predefined structure apply algorithm simulated data one compare obtain estimate factor loading factor function real one data generate data simulated grid contain point moneyness daysandineachday simplicity impose classical iv string structure fill space uniformly data first uniformly distribute coordinate generate potential log iv set choose similarly data analysis section invariant basis function keep dynamic function orthogonal plane moneyness coordinate time maturity coordinate loadingtimeseries hassignificantly big magnitude two remain time series choice factor function application bi important quantity present load time series motivate result previous section try mimic behavior iv choose first function flat first time series much big others present estimate time series bl together original time series estimate first time series similar generate time series also confirm correlation time series show correlation bl however case factor second third time series different second estimate loading time series respectively although resemblance found one swap order factor could see perfectly correlate issue also illustrate original estimate functionsareplotted equivalent estimate function pair show resemblance magnitude function different however fit estimate model almost perfect since explain variance define close close aic aic although simulation study do one case generalize time series however study need largely extend beyond content work aim show feasible application beta betahat yyy yyy beta betahat beta betahat time series loading left panel simulated time series right panel estimate time series application mhat mhat invariant basis function first dynamic basis function left panel true function right panel estimate function application mhat mhat leftpanels truefunctionsm andm right panel estimate function application hedge exotic option regulate derivative market allow trade plain vanilla option thebarrier option path dependent option mean payoff depends asset price expiry time also asset price life time option payoff option define similar way like payoff plain vanilla option fact time expiry price hit cross pre specify level knock opposite barrier reach knock one may classify barrier option accord payoff type put call position long call condition payoff knock knock relation underlie barrier price barrier price barrier model section one may derive analytical price barrier option similarly price dependent unknown parameter natural question arise hedge short position barrier option particularly important put call price near barrier level option resembles way digital option yield nothing next feature option negative relation volatility opposite plain vanilla positive relation chance hit barrier increase price option decrease first approach hedge knock barrier option construct portfolio replicate payoff barrier reach value underling equal barrier one assume unrealistic trading condition like possibility buying fraction asset underlie possible vanilla example consider knock call option cko strike barrier assume additionally underlie drift iv market depends time strike hedge portfolio construct one position plain vanilla call strike short put strike barrier hit maturity payoff knock call like payoff plain vanilla call put worthless underlyingis independent however interest rate practice feasible approach dynamic hedge particular time barrier option replicate certain amount underlie call option amount calculate greek may easily compute since price give analytically practice however change barrier option value may fully hedge financial instrument application approximate level approximation give cko cko cko volatility hedge portfolio hp consist unit underlie call option sensitivity hedge portfolio hp respect equal sensitivity cko hedge coefficient give equation cko cko exotic hedgeportfolio delta hedge adjust present hedge strategy however disregard possible change iv know iv change shape throughout time problem approach single parameter explains volatility although price non observable plain vanilla option consistently market price enough interpolate iv trade option moneyness case barrier option price depends classical moneyness also relation barrier spot price order price barrier option consistently smile lv model employ one solve pde modify boundary condition barriercase cko gamma cko andtheta cko butwhataboutvega cko itisnolonger single number whole surface movement whole iv explain significant part iv variation still yield protection iv shape change extension classical vega bucket vega hedge one calculates sensitivity respect change particular maturity still smile risk remains hedge one may also try super bucket vega hedge calculate sensitivity respect parallel change small part iv one maturity even grid point possible smile change hedge yield infeasible many parameter practically impossible overcome problem many hedge parameter one assume model iv dynamic additionally reduce dimension option price application natural choice model dsfm whole dynamic describe factor thus one calculate sensitivity dynamic factor function first function reflect dynamic second term structure third onem smiledynamics one particular barrier option mean consider term structure effect take account portfolio contain option different maturity order achieve vega neutral joint portfolio cko hp consider hedge vega portfoliohp hp hp thehp shouldbesensitiveto andrelatively vega independentto change itmayconsistofat moneycalloption thehp need opposite sensitivity small relatively large may construct risk reversal risk reversal combination short put strike long call strike long put strike short call strike relatively independent parallel shift iv reflect significant dependence smile change coefficient give solution hp hp cko bibliography avellaneda zhu arch model term structure imply volatility fx option apply mathematical finance bates jump stochastic volatility exchange rate process implicit deutsche mark option review financial study black scholes pricing option corporate liability journal political economy borak detlefsen andh ardle inc zek ardle weron ed statistical tool finance insurance springer borak fengler andh ardle sfb discussion paper hu mboldt universit zu cont da fonseca dynamic imply volatility surface quan titative finance detlefsen hedge exotic option stochastic volatility jump dif fiusion model master thesis hu mboldt universit zu dupire pricing smile risk fengler semiparametric model imply volatility phd thesis hu mboldt universit zu fengler ardle schmidt analysis imply volatility inh ardle kleinow stahl ed springer fengler ardle villa dynamic imply volatility common principle component approach review derivative research bibliography fengler ardle andmammen sfb discussion paper hu mboldt universit zu gijbels mammen local adaptivity kernel estimate plug local bandwidth selector scandinavian journal statistic hafner stochastic imply volatility springer verlag heidelberg hafner wallmeier dynamic dax imply volatility international quarterly journal finance heston close form solution option stochastic volatility application bond currency option review financial study hull andwhite pricing onoptionon asset withstochastic volatil ities journal finance merton option pricing underlie stock return discontinuous financial economics press teukolsky vetterling flannery numerical recipe cambridge press skiadopoulos hodges clewlow dynamic imply volatility surface review derivative research stein stein stock price distribution stochastic volatility analytic approach review financial study
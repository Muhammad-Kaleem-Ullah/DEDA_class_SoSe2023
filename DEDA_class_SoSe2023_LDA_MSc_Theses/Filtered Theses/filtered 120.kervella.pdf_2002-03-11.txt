estimate state price density via local polynomial master thesis present pierre kervella prof dr wolfgang ha rdle institute statistic econometrics partial fulfillment requirement degree master statistic universita zu spandauer str march declaration authorship hereby confirm author diploma thesis independently without use others indicate resource passage literally general matter take publication resource marked pierre kervella march master thesis aim estimate state price density spd via nonpara metric fit imply volatility smile derivative achieve task use local polynomial estimator apply empirical bias bandwidth selector ebb algorithm determine global local optimal bandwidth accu racy nonparametric estimate study statistical financial point view afterwards result spd estimate present well bootstrap confidence band last part compare semiparametric method imply binomial tree thanks wolfgang ardle professor institute statistic econometrics universit zu matthias fengler torsten kleinow axel werwatz stitue statistic econometrics universit zu sebastien raspiller insee peter schmidt bankgesellschaft help advice content introduction extract spd use european option breeden litzenberger result black scholes spd semiparametric model nonparametric semiparametric model call pricing function semiparametric model spd possible framework use semiparametric model local polynomial estimation framework theory data driven bandwidth ebb algorithm estimate bias estimate variance select bandwidth data nonparametric estimate reliability local versus global bandwidth best estimate compare theoretical observe price spd estimate confidence band state price density delta gamma estimate bootstrap confidence band comparison imply binomial tree conclusion computation imply volatility imply volatility surface nonparametric estimate different maturity introduction since significant advance provide work black scholes con tingent claim price use replication principle mean price contingent claim cost perfect replication dynamic portfolio compose underlie asset bond effective calculation price rely model underlie price process geometric brownian motion imply return asset price normally distribute however widely document asset return exhibit skewness excess kurtosis unconditional distribution heteroskedasticity conditional distribution practice lack historical validity correct mean imply volatility volatility parameter equalize theoretical observe price thus option market participant go use statistical estimate underlie volatility proxy price contingent claim rather use option extract volatility also forward look feature recently point view extend determine distribution underlie price imply observe european call price approach meaningful since option become liquid asset price therefore determine interaction supply demand exist numerous method recover distribution also call state price density spd empirically separate two class method use option price identify condition method use second derivative call pricing function respect strike price first class include method consist estimate parameter mix ture log normal density match observe option price melick thomas another popular approach class imply binomial tree method seerubinstein dermanandkani andh ardle kleinowandstahl another technique base learn network suggest hutchinson lo poggio nonparametric approach use artificial neural network radial basis function projection pursuit second class method base seminal work breeden litzen berger call pricing function respect strike sahalia lo use result basis estimate semiparametrically spd work well paper rookley pave way study actually paper base rookley semiparametric technique us nonparametric regression imply volatility function derivative distribution also call state price density spd estimate may serve pricing new complex illiquid derivative security indeed price security time single liquidation date payoff rt state variable risk free rate time time maturity spd time date payoff moreover provide market participant rich source information assess market sent ment master thesis begin section explanation breeden litzenberger result along first application black scholes spd third part different non semiparametric model several framework ex pose section nonparametric estimator necessary get semiparametric spd expound discussion empirical bias banwidth selector gorithm ebb section data present next section comparison different nonparametric estimate conduct section present obtain spd estimate develop method compute confi dence band last section compare spd estimate obtain imply binomial tree extract spd use european option breeden litzenberger result breeden litzenberger show one replicate arrow debreu price use concept butterfly spread european call option one hand arrow debreu security theoretical contingent claim pay one currency unit certain state economy happens give future date state economy restrict possible value one asset hand butterfly spread exists practice linear combination call option indeed entail sell two call option exercise price buying one call option another stepsize adjacent call strike four option constitute butterfly spread center terminal underlie asset value equal payoff butterfly spread define st denotes price european call actual underlie price timetomaturity andastrikepricek isthecorresponding price security butterfly spread time tends zero security becomes arrow debreu security pay asitisassumedthats function probability give level zero thus case price arrow debreu security zero however divide one time one obtains price butterfly spread tends rt price tends indeed rt lim st prove set payoff new security st let tend one also notice one construct financial instrument continuum state strike price infinitely small complete state pricing function define moreover tends zero price tend second derivative call pricing function respect strike price evaluate lim lim equate across state yield kt rt st denotes risk free interest rate time time maturity denotes risk neutral pdf spd therefore spd define ert kt st method constitutes arbitrage approach recover spd assumption theonly requirement method market perfect sale restriction transaction cost tax agent able borrow risk free interest rate andthatc tiating twicew aftersettingforz remark call state price density since represent price dk occurs time since methodology base european call may apply option market typically method advocate index option whose sincein money call price determine use money put put call parity rela tion moreover result also assumes continuum strike price found stock exchange indeed strike price always discretely space finite range around actual underlie price hence pro cedures rely result include one present try handle problem interpolate call pricing function inside range extrapolate outside section semiparametric model use nonparametric regression imply volatility introduce provide interpolation task however first application result determine spd imply black scholes model black scholes spd black scholes call option pricing formula due black scholes merton model assumption regard preference rather relies arbitrage condition assumes evolution underlie asset price follow geometric brownian motion define dt dw denotes drift volatility assume constant analytical formula price call option terminal date strike price underlie price risk free rate continuous dividend yield volatility rt max ke rt standard normal cumulative distribution function log consequence assumption underlie asset price process black scholes spd log normal density mean variance log ert st log exp risk measure delta gamma define def black scholes spd calculate xplore use follow quantlet bsspd spdbs div sigma tau computes black scholes spd underlyingprice risk freeinterestrate dividendyields div sigma tau output consist black scholes spd bsspd fbs bsspd delta bsspd gamma call option please note spdbs apply put option calculate correspond call price use put call parity however widely know black scholes call option formula valid empirically one problem imply volatility black scholes orequiv alently moneyness visual inspection option data show volatility smile skew present moneyness direction imply volatility also change maturity correspond option see ardle detail feature imply volatility surface consequence crash result increase demand protective put mainly fund manager since black scholes model contains empirical irregularity spd consistent data consequently technique estimate spd without assumption underlie diffusion process developed last year semiparametric model nonparametric semiparametric model call pricing function use nonparametric regression recover spd first investigate sahalia lo propose use nadaraya watson estimator timate historical call price function follow state variable kernelregressions areadvocatedbecause thereisnoneedtospec ify functional form require assumption function smooth differentiable ardle nevertheless regressor dimension estimator inaccurate practice owe call curse dimensionality problem refers fact local neighborhood high dimension always local since neighborhood fix percentage sample point big far local hence need reduce dimension equivalently number regressors one method appeal arbitrage te rt argument collapse forward price order express call pricing function alternative specification assumes call option function homogeneous degree one black scholes formula kc combine assumption call pricing function duced function three variable first variable generally ft ft calledmoneyness indeed option whose intrinsic value positive money option strike nearly equal underlie spot price say money last case money nevertheless literature term refers different ratio involve underlie price spot forward strike price option therefore interchangeably use term moneyness st ft another approach use semiparametric model base black scholes formula scholesmodel imply volatility model nonparametric function one need estimate imply volatility follow nonparametric function consequently widely know empirically imply volatility function mostly depends two parameter time maturity moneyness almost equivalently onecansetm wheres andd dividend paid expiration actually case dividend yield tie rt wehaved thend ti dividend payment date ith dividend maturity therefore dimension imply volatility function reduce case call option function estimate ert one choose nonparamet ric method nadaraya watson local polynomial kernel function smooth parameter case nadaraya watson estimator order sahaliaandlo however method present survey base different semiparametric model present follow section semiparametric model spd previous section propose semiparametric estimator call pricing func tion correspond approach recover spd section dimension fix maturity allows eliminate specification imply volatility function follow part convenience definition money ness denote imply volatility notation xn xi df denotes partial derivative total derivative dx respect moreover follow rescale call option function use price ith option time rescale call option function express log standard risk measure follow partial derivative notational convenience subscript drop dc dc dm dm dm spd second derivative call option function respect strike price er er conversion need estimate analytical expression depends dc dm dm functional form dc dm dc dd dd dm dm dm dm dd dm dm dm dd dd dm dm dm quantity function follow first derivative dd dm dd dm log log quantity also rely follow second derivative function log dm log log dm log follow quantity require complete computation spd estimation base last semiparametric model calculate follow quantlet fstar delta gamma spdbl sigma sigma sigma tau computes spd use breeden litzenberger result derivation pre sented argument quantlet moneyness sigma sigma sigma underlie price correct future dividend risk free interest rate time maturity tau output consist local polynomial spd fstar delta gamma call option possible framework use semiparametric mod el even two semiparametric model present section base parametric model black scholes rely nonparametric estimate first one need fit imply volatility smile surface second one us also two first derivative respect strike price spd estimate also depend nonparametric method indeed use nadaraya watson estimator local polynomial may yield different result sahalia duarte provide example local polynomial different order return different result case first semiparametric model furthermore another key issue type data serve basis study indeed one may use settlement price intra day price intra day bid ask spread moreover depend purpose study number trading day use estimate one spd may also vary sahalia lo many day serve basis recover one spd otherwise rookley us one day tick data one cross section series option framework slightly different one day settlement data use purpose estimate spd even correspond maturity series option task achieve nonparametric regression whole imply volatility surface derivative framework allows survey dynamic spds stability one compare spds theoretical maturity different date moreover choose get spd moneyness metric one would also avoid effect underlie price movement mean distribution discuss result spd estimation nonparametric approach chosen study present local polynomial estimation since derivative imply volatility curve must fit local polynomial adviseable introduce multivariate case discus choice smooth parameter framework theory assume heteroscedastic model dimensional vector independent variable id response smooth function specify conditional mean standard deviation give mean variance furthermore scanbefixedorrandom however latter case consider present study regressors deterministic goal method estimate derivative suppose th derivative point exist possible approximate unknown function local polynomial order indeed approximation base taylor expansion give neighborhood pm ip ip different notation sj observe dd see polynomial coefficient thelocalpolynomial least square regression problem whose solution define min number observation dimensional vector bandwidth con troll neighborhood direction hd result kernel function weight observation point kernel function may product univariate kernel function multivariate kernel moreover define sj vector polyno mial coefficient compare one remark dd estimate convenience use follow matrix definition nd nd nj diag matrix matrix vector whose dimension denotes combinatorial coefficient hence weight least square problem may write follow way min whose solution provide weight least square theory give wx wy stage easy observe local polynomial provide powerful tool estimate nonparametrically unknown function derivative moreover lo cal polynomial procedure provide estimate function derivative small degree polynomial one step conditional bias variance estimator derive directly wx wm wx wr var wx wx wx contains value true function obser vation point vector residual local polynomial approx imation diag however possible calculate value directly since unknown one issue regard estimation method dependence band width governs much weight kernel function place ob serve point estimation target point moreover call option always symmetrically equally distribute around money point choice bandwidth key issue especially estimation border imply volatility smile surface typically bandwidth chosen global locally dependent case method provide optimal band inrulesanddata basedselectors analgorithm call empirical bias bandwidth selector ebb find local bandwidth sug gested ruppert algorithm explain follow part test imply volatility data section concern local polynomial fitting choice local polyno mial order kernel function use indeed imply bound since possible estimate derivative order thus one interested function one may use polynomial order also call nadaraya watson estimator nevertheless fan gijbels prove polynomial order take limit variability estimate recommend set since model complexity driven mainly bandwidth comment implies nadaraya watson estimator optimal even estimate function kernel advise epanechnikov one restrict choice nonnegative kernel however choice kernel function less crucial bandwidth one quantlet lplocband developed study provide easy way estimate one derivative xplore via local polynomial variance lplocband xgrid orderder ridgecoef kernel fit unknown function one derivative via local polynomial argument matrix regressors dependent variable bandwidth local global xgrid grid target point orderder order derivative estimate order polynomial ridgecoef parameter ridge regression desire kernel string contain kernel function use output consists estimate derivative target point xgrid variance estimate variance estimate base assumption data driven bandwidth ebb algorithm since option data distribution feature see section imply careful choice bandwidth ebb algorithm implement xplore de termine optimal bandwidth basic idea algorithm estimate mean square error mse function bandwidth minimize target point hence target point one bandwidth select grid max mse min mse hmax mse define mse bias var particularity algorithm use asymptotic result indeed ebb follow feature variance term use exact asymptotic require estimate conditional variance dependent variable give regressors bias estimate empirically calculate grid value ashvaries thus ebbsreplaces asymptotic approximation computation remember denotes derivative order unknown function one need fit polynomial degree high degree derivative contrary write last part method easily accommodates odd even bandwidth selection estimation derivative multivariate simple denote standardize regressors serve algorithm standardization do order search one dimensional grid even indeed target point bandwidth equal direction scale denotes grid target point rd index set integer remember difference data point target point expectation meant conditional otherwise note hence bias variance conditional expectation estimate bias assume bias estimate target point bandwidth letj beanintegerandleth hj itispossible calculate hj use coordinate hj hj one estimate ordinary least square follow polynomial hj bc bc hp bc hp must small notation bc mean bias coefficient term intercept represent bias thus bias estimate bc hp bc hp nature bias function suggest asymptotics see ruppert wand case asymptotics serve estimation suggest model ruppert advises choose order prevent problem even moreover estimate bias asymptotics suggest use value great estimate variance variance estimation base expression let denote matrix matrix apply target point assume continuous approximation increasingly accurate tends assume column corresponds derivative order combine one obtains var qq remember also depend therefore candidate bandwidth yield different variance estimation ruppert wand holst ossjer propose estimation method quantity base smooth square residual via ebb first step compute vector residual use local polynomial global bandwidth assume bias first smooth negligible constant neighborhood estimate hebbs hebbs diag denotes smooth matrix use esti hm hm hm hm mate ith row corresponds xwx hm ith observation target point moreover denotes smooth hebbs trix use smooth square residual bandwidth chosen via ebb however apply ebb square residual need get variance function residual rather assume ruppert variance function proportional square mean function hence variance square residual point estimate var var remember var obtain smooth contain use automatically driven bandwidth however compute estimate one need apply ebb observation expensive compute time large therefore follow example ruppert smooth square residual correct divide hebbs ebb quantlet rather variance estimate obtain directly smooth square residual note degree freedom type correction sizeable increase variance select bandwidth use estimate mse obtain use relation estimate bias require fit target point bandwidth fit reuse calculate mse nearby bandwidth give grid bandwidth bias estimate use max bandwidth thus last value select ebb algorithm estimate bias mse calculate moreover since estimate mean square error quite rough function smooth version mse introduce study compute smse binomial weight apply closest point optimal bandwidth chosen target point correspond first local minimum smooth mse propose local bandwidth first local min mse hmax jb local minimum prefer global one since large value tend greatly underestimate bias term morover increase variance estimate decrease thus global minimum smse would obtain tend infinity finally obtain bandwidth smooth use binomial weight apply closest point band observe also sample size small preferable use global however theebbs algorithm able handle problem achieve one smooth mse allocate equal weight target point minimization perform ebb algorithm implement xplore regressors last comment implies derivative first second order estimate band ebb xgrid hgrid orderder msespan nterms bandspan varest kernel estimate unknown function one derivative via local polynomial automatically select bandwidth argument matrix regressors dependent variable xgrid grid target point hgrid grid bandwidth orderder order derivative estimate order polynomial msespan number point use smooth mse furthermore nterms corresponds bandspan number point smooth bandwidth varest band estimate variance target point kernel string contain type kernel function corresponds must large nterms set since estimate bias large bandwidth use output consists estimate derivative target point xgrid band locally select bandwidth standardize data data dataset take financial database md base locate case cen ter apply statistic economics universit zu since md base proprietary database limited dataset provide demon stration purpose database fill option data provide eurex daily series month dm libor rate take thomson financial datastream serve riskless interest rate dax future option settlement data january trading day use study daily settlement price option contract extract along contract type maturity strike available rate perform dax performance index mean dividend reinvested ever usingtheblack volatility put call contrary arbitrage assumption contain put call parity remark explain fact january domestic investor advantage may receive portion divi dend tax back depend tax status dividend tax mean corporate income tax distribute gain gross dividend moreover observe algorithm extract imply volatility option price developed since dividend rebate domestic investor dax fall amount contain dividend tax indeed value drop depends level tax may equal zero weight domestic foreign investor trading dax dividend tax effect ordinary dividend therefore use compute imply volatility future price implicit black scholes formula hafner wallmeier suggest method order get around prob lem consists compute dividend imply put call parity indeed combine future pricing formula tert put call parity ke rt obtain fe rt ke rt maturity option maturity near forward whose volume positive difference present value dividend tick data recommend use directly underlie price however since settlement price available underlie necessary use settlement forward price use imply dividend compute pair put call strike theoretically give time maturity must one value imply dividend therefore maturity average imply dividend use compute correct price use method imply volatil ities reliable systematic gap exist put rate maturity information moneyness maturity option displayed january reveals distribution maturity strike price uniform maturity available ytirutam ytirutam moneyness moneyness moneyness maturity option january also small number strike price order assure liquidity correspond option furthermore series range strike circumstance series whose range large may provide useful information next series mainly boundary example first third series left display much wider second therefore may help estimate spd tail second cross section option dataset consists one file xfgdata column data read xplore load quantlib finance issue follow command data read xfgdata dat day month year type option call put time maturity calendar day strike price option price correct spot price imply dividend take account risk free interest rate imply volatility non correct spot price nonparametric estimate relia bility estimate spd correspond maturity series option one may use either series whole sample option available hence first case univariate regression perform sample whose size strictly small dataset second case bivariate regression apply sample whose size lie depend date matrix apply target point either equal goal estimate spd theoretical maturity second framework allow observe moneyness employ section local versus global bandwidth toselectthe optimal global bandwidth use modify version ebb algorithm mse smooth use equal weight target point parameter serve input ebb algorithm follow grid contains band width independently derivative order estimate number term set follow advise ruppert number bandwidth use fit bias thus difference number observation number parameter fit bias model number point use smooth mse set parameter also set band grid value chosen rough inspection quality band estimate bandwidth select locally first remark concern behavior bandwidth esti mate present part purpose determine type data use volatility smile volatility surface well type bandwidth large andv besides itisofinter present estimate optimal bandwidth obtain january maturity calendar day estimation range limited sample range grid target moneyness go step size show result wider range thus imply extrapolation grid go step size one hand reveals extrapolation perform four different estimate quiet even bandwidth differ type value hand use either whole surface concerned series yield different sample estimate accord though one series framework seem allow well extrapolation observe smile estimate base surface framework may meaningful since include information near widerseries moreover fit observe data well anymore approach use ebb data driven bandwiths still return accurate estimate sample range comment lead implementation follow quantlet dedicate fit imply volatility surface use ebb local bandwidth ivsurf ivpoints volsurfebbs stepwidth firstxf lastxf firstmat lastmat metric bandwidthgrid global ivmethod estimate imply volatility surface via local polynomial order bandwidth automatically select via ebb argument rawdata matrix contain forward strike price interest rate maturity option price type option call put next five input parameter serve build grid maturity moneyness stepwidth vector contain step size direction xf mean moneyness furthermore metric allows choose strike price moneyness metric bandwidthgrid grid ebb selects bandwidth standardize data global equal bandwidth select ebb global else determines local bandwidth finally ivmethod volatility see would also possible apply ebb tick data second regressor shouldbetheintra daytimet therefore onlyoneoptionseries onematurity serve input example volsurfebbs quantlet plot well example intra day volatility surface regard behavior bandwidth ebb local bandwidth select indeed global bandwidth pas less maximum reachable value whereas maximum difference local bandwidth last increase happens mainly near sample border therefore must due smooth bandwidth present graph first second derivative imply volatility moneyness first derivative conclusion apply second derivative somewhat different fact univariate case ebb algorithm seem yield unstable estimate particularly however unknown unclear whether estimate correspond data solution would reduce step size grid target point grid bandwidth get smoother estimate practice advocate first set large step size determine range local bandwidth select decrease step size well range possible bandwidth accord first stage another main concern difference estimate obtain one series framework base available option assure one series framework yield well estimate almost linearity first derivative confirm estimate may serve proxy indeed approximate global level second derivative compute equal since estimate base large sample always lie conclude global ebb estimate global ebb bandwidth htdiwdnabhtdiwdnab moneyness moneyness ity smile ebb driven bandwidth red optimal global bandwidth blue dash line represent estimate compute use whole surface plain line obtain use concerned series option black line surround sample range xfgspdglobalvsebbs xpl global ebb estimate global ebb bandwidth moneyness moneyness ebb driven bandwidth optimal global bandwidth range estimate wider sample range surround black line xfgspdglobalvsebbs xpl global ebb estimate global ebb bandwidth evitavired htdiwdnabhtdiwdnab tsrifevitavired moneyness moneyness bandwidth local polynomial estimate first derivative imply volatility smile ebb driven bandwidth red optimal global bandwidth blue dash line represent estimate compute use whole surface plain line obtain use concerned series option black line surround sample range xfgspdglobalvsebbs xpl global ebb estimate global ebb bandwidth tsrif moneyness moneyness bandwidth local polynomial estimate first derivative volatility smile ebb driven bandwidth optimal global bandwidth range estimate wider sample range surround black line xfgspdglobalvsebbs xpl global ebb estimate global ebb bandwidth evitavired htdiwdnabhtdiwdnab dnocesevitavired moneyness moneyness bandwidth local polynomial estimate second deriva tive imply volatility smile ebb driven bandwidth red optimal global bandwidth blue dash line represent estimate compute use whole surface plain line ob tained use concerned series option black line surround sample range xfgspdglobalvsebbs xpl global ebb estimate global ebb bandwidth dnoces moneyness moneyness bandwidth local polynomial estimate first derivative volatility smile ebb driven bandwidth optimal global bandwidth range estimate wider sample range surround black line xfgspdglobalvsebbs xpl estimate second derivative finally since ebb expensive compute time important concern behavior global local bandwidth towards order derivative actually would worthwhile term compute time apply ebb fit reuse bandwidth estimate test weestimatev andv usingthebandwidthsh select quantity substract estimate hv hv already displayed difference visible case use bandwidth estimate first derivative seem problem since value small comparison niveau hand use fit return estimate significantly different obtain apply directly ebb however happen univariate case global indeed last case differ ence always equal link observation seem best solution use optimal global bandwidth within smile framework indeed solution yield stable meaningful estimate second derivative ebb algorithm may apply onlyonce nevertheless thesurface framework require recommend use local bandwidth since global bandwidth produce strong underestimate second derivative simply fails extrapolate sample range conclusion hold different maturity see statistical point view suggest one optimal method framework theoretical exist maturity however also possible test reliability estimate financial criterion difference st derivative difference nd derivative moneyness moneyness left display difference hv andv rightdisplay hv restrict sample range line meaning previous display xfgspdglobalvsebbs xpl difference st derivative difference nd derivative moneyness moneyness left display difference hv andv rightdisplay hv go constraint monotonicity convexity op tion pricing function sahalia duarte introduce local polynomial estimation shape restriction avoid violation constraint impose arbitrage theory indeed theno ing convex function option strike price sentence summarize follow inequality st rt st rt moreover set call payoff max equation take first derivative result rt asf isadensity wegetabounded interval first derivative call pricing function strike price rt addition constraint consider integral density large method fails thus verify reliability method present experiment aim test constraint lead follow way get option feature one day build strike moneyness grid common day case grid go eiter estimate imply volatility first two derivative grid use extract option ebb algorithm use derivation section compute spd first second derivative call pricing function respect compute integral spd via riemann sum test constraint violate repeat maturity day test perform two different grid one inside sample border one large second case do evaluate possible problem come extrapolation besides task do global local bandwidth use either whole surface concerned smile result test expose respectively smile framework surface framework option series global ebb global ebb first maturity second maturity third maturity series number day january constraint violate value obtain grid go num bers bracket represent respectively number day follow constraint violate low bound upper bound second inequality constraint integral spd notice non parametric estimate present january strangely never violate constraint smile framework surface framework option series global ebb global ebb first maturity second maturity third maturity fourth maturity series number day january constraint ful fill value obtain grid go bracket meaning respect depend second derivative see section since constraint involve first derivative often violate possible accuse secondly large influence since passing first grid large one always increase number day constraint violate moreover failure observe third series happen third friday january violation due extrapolation since third series date narrow see width concerned series right display observation confirm approach developped sahalia duarte estimate spd small maturity extrapolation desire furthermore choice use global bandwidth univariate case con however use whole sample implies less violate constraint therefore trade quality nonparametric estimate fulfillment arbitrage constraint stage show necessary keep critical eye nonparametric spd estimate particularly maturity small accuracy different spd estimate replicate observe price best estimate compare theoretical observe price quality different nonparametric estimate compare price result spds yield since show extrapolate outside range may cause violation arbitrage constraint inadequate de termine price contingent claim whose payoff positive ouside available strike range therefore use butterfly spread define section preferable simply compute call put price theoretical price present base equation butterfly payoff method perform rely cross validation procedure thus remove sample three call use calculate observe butterfly price estimate spd butterfly spread center width set hence move moneyness always inside sample range calculate integral riemann sum built grid contain target point grid space equal point first available maturity result term relative pricing error observe spd observe observe price butterfly spread price observe spd compute use spd estimate mean absolute value pricing error confirm univariate regression advocate consider exist ing maturity result also reveal locally select bandwidth yield often well estimate observe price however difference uni variate case sufficiant change previous decision use locally driven bandwidth therefore follow univariate regression always perform ebb global bandwidth bivariate locally driven bandwidth moreover violate constraint observe first maturity last section may due estimation method rather may already present settlement data thus confirm statement would interest redo constraint test use tick data follow section present spds delta gamma estimate smile surface date global ebb global ebb january january january january january january january january january january january january january january january january january january january january january mean mean absolute value pricing error percent butterfly spread central strike observe price compute use series option whose maturity decrease period theoretical price compute correspond maturity spd estimate confidence band state price density delta gamma estimate quantlet estimate spd via local polynomial implement xplore allows possibility expose last section instance one may use one series option moreover possible choose locally globally driven bandwidth input bandwidth fstar delta gamma band spdlp rawdata xgrid locband metric spdmaturity ir forwardprice orthewholevolatiliy surface argument rawdata matrix contain forward strike price interest rate maturity option price type option call put xgrid grid target point depend metric chosen deed possible get spd strike price metric moneyness metric locband vector bandwiths locband set ebb algorithm determines local bandwidth predefined grid set determines optimal global bandwidth three last parameter require input data include one series option necessary give maturity spdmaturity spd compute corre sponding interest rate ir forward price forwardprice output consists spd fstar hedge parameter delta gamma bandwiths target point first feature spd present estimate uni variate case base optimal global bandwidth bivariate locally driven bandwidth first graphical comparison semiparametric black scholes spds present fact main purpose see whether spds really differ compute black scholes spd volatility parameter equal observe atm imply volatility two optimal semiparametric spds plot one univariate one bivariate case compute use two near call put three spds respectively plot maturity day result black scholes spd semiparametric spds ytisned ytisned stock price expiry black scholesspd black semiparametricspd red blue correspond maturity day january color style semiparametric spds meaning section black scholes spd semiparametric spds stock price expiry black scholesspd black semiparametricspd red blue correspond maturity day january color style semiparametric spds meaning section xfgspdbsvssp xpl sahalia lo concern difference semiparametric black scholes spds illustrate example semiparametric spds exhibit negative skewness high kurtosis parametric one thus use local polynomial estimator one capture effect volatility smile effect high moment skewness kurtosis however second graph reveals visible difference estimate indeed spd base whole sample blue dash seem high kurtosis may explain influence first option series estimate second spd since found univariate case allows well track observe price situate near atm point assume red line nearer true value blue one interest illustrate pattern follow spds matu rity increase xfgspdoneday xpl calculates plot local polynomial spds january different theoretical time maturity hence bivariate framework use spds finally displayed fig ure show expect effect time maturity spd semi parametric spd ytisned stock price expiry local polynomial spd blue fill black dash red dot xfgspdoneday xpl increase variance loss kurtosis effect kurtosis confirm computation show delta gamma full range strike three theoretical maturity method allows user get one step spd greek strike maturity natural question may arise spds evolve time january xfgspdonemonth xpl estimate spd trading day january plot three dimensional space axis moneyness semi parametric delta atled ammag strike price local polynomial delta blue fill black dash red dot semi parametric gamma strike price local polynomial gamma blue fill black dash red dot xfgspdoneday xpl axis trading day axis spd bootstrap confidence band method use derivation section serf estimate spd compute via local polynomial ebb global bandwidth method base univariate regression polynomial order bandwidth show local polynomial spd tau three week state price density moneyness scale xfgspdonemonth xpl example fan gijbels bound condition satisfied asymptotic approximation complicate fact non linear function analytical confidence interval obtain use delta method propose sahalia however alternative method band approximate distribution sup follow procedure illustrates construct bootstrap confidence band local polynomial spd estimation collect daily option price md base choose option expiration date example time maturity day jan use local polynomial estimation method obtain empirical spd notice thatwhen isalsofixed function consider fix design situation strike price thewildbootstrap method entail choose bandwidth large optimal order oversmoothing estimate imply volatility function nonpara metrically calculate residual error replicate time series wild bootstrap obtain ardle build new bootstrapped sample fi estimate spd use bootstrap sample rookley method bandwidth build statistic sup form band denotes empirical quantile two spds jan jan whose time maturity day estimate plot bootstrap confidence band correspond first spd jan also visible chart spds plot moneyness metric seem difference spds eliminate switch moneyness metric indeed extract spds lie within percent confidence band number bootstrap sample set local polynomial estimation do standardize data set plot equal bandwidth value maximum optimal global bandwidth indeed bandwidth different notice great value try conclusion confidence band stable increase spds bootstrap cb tau day ytisnedytisned stock price expiry spd estimation bootstrap confidence band blue line represent spd january red line spd january xfgspdcb xpl spds bootstrap cb tau day moneynessmetric xfgspdcb xpl comparison imply binomial tree chapter ardle imply binomial tree ibt discuss relationship option price imply volatility rookely method ardle black scholes formula use barle cakici ibt procedure crr binomial tree method use derman kani large difference nature however ibt nonparametric regression method difference cause different model strategy ibt method might less data intensive nonparametric regression method construction require one cross section price earlier application dax data option price use different time maturity one day estimate imply volatility surface first order construct tree use relation formula option price risk neutral probability precision spd estimation use ibt heavily affected quality imply volatility surface choice level imply tree ibt method risk neutral probability obtain consider discrete estimation spd however ibt method useful estimate spd also give discrete approximation underlie process great difference ibts nonparametric regression require mentofsmoothness select bandwidth even limited option price give part spd estimation still obtain use nonparametric regression ibt con struction give structure invoked volatility surface rookley method first sight obvious difference sahalia method theoretically sahalia lo investigate convergence rate spd estimation use sahalia method allows one conduct statistical inference test stability spd test risk neutrality quantlet xfgspdcom xpl show comparison spd estimate ibt rookley method difference two spd estimate may due selection bandwidth rookley method choice step construction ibt use dax imply dividend rookley method show imply binomial tree local polynomial spds jan spd estimation tau day ytisned stock price comparison different spd estimation rookley method blue ibt black thin xfgspdcom xpl uary local polynomial spd determine use optimal global bandwith univariate regression indeed tail rookley one rookley spd show large kurtosis cross validation procedure present serf however since large difference spds observe atm point see test nolonger apply butterfly spread fix center rather build two butterfly spread whose center surround atm point hence center butterfly spread follow forward price movement width chosen equal procedure do day january show result term relative pricing error define section seem spds small kurtosis since observe price butterfly spread large spds case however rookley spd mean nearer observe price ibt one pricing error butterfly spread ni rorre gnicirp date relative pricing error butterfly spread center near est strike left side atm point black line represent ibt pricing error blue rookley error pricing error butterfly spread ni rorre gnicirp date relative pricing error butterfly spread center near est strike right side atm point conclusion study semiparametric approach estimate state price density present investigate semiparametric model require estimation imply volatility smile two first derivative therefore local polynomial method introduce since able provide nonparametric estimate unknown func tion derivative however method mainly driven smooth parameter also call bandwidth may determine either plug rule data base selector since data sample cover discretely strike maturity dimension within limited range bandwidth selection key issue study hence implement empirical bias bandwidth selector rup pert nice feature select automatically either global local bandwidth optimal sense mean square error normally local selection prefer show global bandwidth method advantage stability example compare method use local bandwidth sample size small nonparametric estimate obtain possible compute spds hedge parameter whole range strike price one hand method able estimate spds theoretical exist maturity local polynomial imply volatility surface hand non therefore one keep critical eye estimate settlement price may already contain arbitrage violation method sahalia duarte able handle problem moreover method prove accurate imply binomial tree estimate spds computation imply volatility option right obligation price increase function thus duetothismonotony volatility therefore instead calculate option price function volatility possible compute volatility imply theoretical price option study base european option theoretical price compute use black scholes model briefly present section case american option price base call binomial tree however analytical formula determine imply volatility accord option price thus algorithm find nonlinear equation root necessary price increase function algorithm simplify two main algorithm purpose bisection method newton raphson algorithm newton raphson algorithm advocate rate convergence quadratic apply computation imply volatility iteration newton raphson algorithm follow form observe denotes black scholes option price option price observe observe market nth iteration choice first value essential assure convergence algorithm manaster koehler propose choose maxi vega mizes option vega european option put call equal call put second derivative respect volatility define section therefore critical point obtain implies ln ln value second derivative vega respect volatility negative assure thus raphsonalgorithm set equal ln manaster koehler show case series monotonic bound therefore converges true value quantlet implvola computes xplore imply volatility european option give choice algorithm imply volatility surface example volsurfebbs quantlet dedicate imply volatility surface one display present imply volatility surface demonstration purpose intra day surface volatility surface vola maturity moneyness imply volatility surface moneyness maturity regressors january red point represent settlement imply volatility bandwidth select locally volatility surface vola intra day time moneyness imply volatility surface moneyness intra day time second regressors january surface corresponds first series option time maturity calendar day red point represent observe option imply volatility ebb algorithm selects case global bandwidth nonparametric estimate different matu rities allow conclude effect maturity quality nonparametric estimate imply volatility smile derivative particularly nonparametric estimate second derivative base local bandwidth still exhibit high unstability moreover optimal global bandwidth use within surface framework confirm bad case global ebb tau global ebb tau ytilitalov ytilitalov moneyness moneyness local polynomial estimate volatility smile ebb driven bandwidth red optimal global bandwidth blue use either one plain maturity dash left plot correspond series whose time maturity calendar day right january global ebb tau global ebb tau evitavired evitavired tsrifevitavired tsrifevitavired moneyness moneyness local polynomial estimate first derivative volatility smile ebb driven bandwidth red optimal global band width blue use either one plain maturity dash left plot correspond series whose time maturity calendar day right january global ebb tau global ebb tau dnoces dnoces moneyness moneyness local polynomial estimate second derivative volatil ity smile ebb driven bandwidth red optimal global bandwidth blue use either one plain maturity dash left plot correspond series whose time maturity calendar day right january sahalia delta method nonparametric kernel functionals journal finance mimeo sahalia duarte nonparametric option pricing shape restriction mimeo sahalia lo nonparametric estimation state price density implicit financial asset price journal finance black scholes pricing option corporate liability journal political economy breeden litzenberger price state contingent claim implicit option price journal business derman kani rid smile risk fan gijbels local polynomial model application vol monograph statistic apply probability chapman hall new york hafner wallmeier dynamic dax imply volatility quarterly international journal finance ardle apply nonparametric regression cambridge press new york ardle kleinow stahl apply quantitative finance springer verlag hutchinson lo poggio nonparametric approach pricing hedge derivative security via learn network journal finance manaster koehler calculation imply variance black scholes model note journal finance melick thomas recover asset imply pdf option price application crude oil gulf crisis journal financial quantitative analysis merton rational theory option pricing bell journal eco nomics management science rookley fully exploit information content intra day option quote appliations option pricing risk management mimeo rubinstein imply binomial tree journal finance ruppert empirical bias bandwidth local polynomial nonpara journal american statistical association ruppert wand multivariate locally weight least square regression annals statistic ruppert wand holst ossjer local polynomial variance function estimation technometrics